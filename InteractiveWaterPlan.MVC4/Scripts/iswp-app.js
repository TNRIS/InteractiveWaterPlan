
// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/StrategyTypeCollection',[], function() {
  var StrategyTypeCollection;
  return StrategyTypeCollection = (function(_super) {

    __extends(StrategyTypeCollection, _super);

    function StrategyTypeCollection() {
      return StrategyTypeCollection.__super__.constructor.apply(this, arguments);
    }

    StrategyTypeCollection.prototype.url = "" + BASE_PATH + "api/strategy/types";

    return StrategyTypeCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/CountyNamesCollection',[], function() {
  var CountyNamesCollection;
  return CountyNamesCollection = (function(_super) {

    __extends(CountyNamesCollection, _super);

    function CountyNamesCollection() {
      return CountyNamesCollection.__super__.constructor.apply(this, arguments);
    }

    CountyNamesCollection.prototype.url = "" + BASE_PATH + "api/boundary/counties/names";

    return CountyNamesCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/RegionNamesCollection',[], function() {
  var RegionNamesCollection;
  return RegionNamesCollection = (function(_super) {

    __extends(RegionNamesCollection, _super);

    function RegionNamesCollection() {
      return RegionNamesCollection.__super__.constructor.apply(this, arguments);
    }

    RegionNamesCollection.prototype.url = "" + BASE_PATH + "api/boundary/regions/names";

    RegionNamesCollection.prototype.model = Backbone.Model.extend({
      idAttribute: 'letter'
    });

    return RegionNamesCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/HouseNamesCollection',[], function() {
  var HouseNamesCollection;
  return HouseNamesCollection = (function(_super) {

    __extends(HouseNamesCollection, _super);

    function HouseNamesCollection() {
      return HouseNamesCollection.__super__.constructor.apply(this, arguments);
    }

    HouseNamesCollection.prototype.url = "" + BASE_PATH + "api/boundary/districts/house/names";

    return HouseNamesCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/SenateNamesCollection',[], function() {
  var SenateNamesCollection;
  return SenateNamesCollection = (function(_super) {

    __extends(SenateNamesCollection, _super);

    function SenateNamesCollection() {
      return SenateNamesCollection.__super__.constructor.apply(this, arguments);
    }

    SenateNamesCollection.prototype.url = "" + BASE_PATH + "api/boundary/districts/senate/names";

    return SenateNamesCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/RegionFeatureCollection',[], function() {
  var RegionFeatureCollection;
  return RegionFeatureCollection = (function(_super) {

    __extends(RegionFeatureCollection, _super);

    function RegionFeatureCollection() {
      return RegionFeatureCollection.__super__.constructor.apply(this, arguments);
    }

    RegionFeatureCollection.prototype.url = "" + BASE_PATH + "api/boundary/regions/all";

    return RegionFeatureCollection;

  })(Backbone.Collection);
});

// Generated by CoffeeScript 1.3.3

define('namespace',['collections/StrategyTypeCollection', 'collections/CountyNamesCollection', 'collections/RegionNamesCollection', 'collections/HouseNamesCollection', 'collections/SenateNamesCollection', 'collections/RegionFeatureCollection'], function(StrategyTypeCollection, CountyNamesCollection, RegionNamesCollection, HouseNamesCollection, SenateNamesCollection, RegionFeatureCollection) {
  var namespace;
  namespace = {};
  namespace.VALID_YEARS = ["2010", "2020", "2030", "2040", "2050", "2060"];
  namespace.currYear = "2010";
  namespace.bootstrapData = function() {
    this.strategyTypes = new StrategyTypeCollection();
    this.countyNames = new CountyNamesCollection();
    this.regionNames = new RegionNamesCollection();
    this.houseNames = new HouseNamesCollection();
    this.senateNames = new SenateNamesCollection();
    this.regionFeatures = new RegionFeatureCollection();
    return $.when(this.strategyTypes.fetch(), this.countyNames.fetch(), this.regionNames.fetch(), this.houseNames.fetch(), this.senateNames.fetch(), this.regionFeatures.fetch());
  };
  return namespace;
});

// Generated by CoffeeScript 1.3.3

ï»¿define('config/WmsThemeConfig',[], function() {
  var WmsThemeConfig;
  WmsThemeConfig = {
    SourceStyles: [
      {
        id: "default",
        name: "DEFAULT",
        strokeColor: "blue",
        fillColor: "blue",
        strokeWidth: 1
      }, {
        id: 0,
        name: "SURFACE WATER",
        strokeColor: "white",
        fillColor: "#1E90FF",
        strokeWidth: 1
      }, {
        id: 1,
        name: "GROUNDWATER",
        strokeColor: "white",
        fillColor: "#4682B4",
        strokeWidth: 1
      }
    ],
    Layers: [
      {
        name: "Regional Water Planning Areas",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",
        viewType: "Regions",
        service_params: {
          layers: "4,7",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: true,
          opacity: 0.6
        }
      }, {
        name: "Texas Counties",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",
        viewType: "Counties",
        service_params: {
          layers: "1,13",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: false,
          opacity: 0.6
        }
      }, {
        name: "Texas County Names",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",
        viewType: "CountyNames",
        service_params: {
          layers: "13",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: false,
          opacity: 0.6
        }
      }, {
        name: "Texas Senate Districts (2011)",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",
        viewType: "SenateDistricts",
        service_params: {
          layers: "3,9",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: false,
          opacity: 0.6
        }
      }, {
        name: "Texas House Districts (2011)",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",
        viewType: "HouseDistricts",
        service_params: {
          layers: "2,11",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: false,
          opacity: 0.6
        }
      }, {
        name: "Water System Service Areas",
        type: "WMS",
        url: "http://services.tnris.org/arcgis/services/swp/SWP_Boundaries/MapServer/WMSServer",
        service_params: {
          layers: "0",
          transparent: true
        },
        layer_params: {
          isBaseLayer: false,
          visibility: false,
          opacity: 0.6
        }
      }
    ]
  };
  return WmsThemeConfig;
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/MapView',['namespace', 'config/WmsThemeConfig'], function(namespace, WmsThemeConfig) {
  var MapView;
  return MapView = (function(_super) {

    __extends(MapView, _super);

    function MapView() {
      return MapView.__super__.constructor.apply(this, arguments);
    }

    MapView.prototype.origCenter = new OpenLayers.LonLat(-99.294317, 31.348335).transform(new OpenLayers.Projection("EPSG:4326"), new OpenLayers.Projection("EPSG:3857"));

    MapView.prototype.origZoom = 5;

    MapView.prototype.map = null;

    MapView.prototype.bingApiKey = '';

    MapView.prototype.baseLayers = ['esri_gray', 'mapquest_open', 'mapquest_aerial', 'bing_road', 'bing_hybrid', 'bing_aerial'];

    MapView.prototype.isMapLocked = false;

    MapView.prototype.MAX_ZOOM = 13;

    MapView.prototype.initialize = function(config) {
      this.$el = $("#" + config.mapContainerId);
      this.el = this.$el[0];
      this.bingApiKey = config.bingApiKey;
      _.bindAll(this, 'render', 'unrender', 'resetExtent', 'showPlaceFeature', 'transformToWebMerc', '_setupOverlayLayers', 'showWmsOverlayByViewType', 'hideWmsOverlays', 'showMapLoading', 'hideMapLoading', 'zoomToExtent', 'getMouseLonLat');
      return null;
    };

    MapView.prototype.render = function() {
      var _this = this;
      this.$el.empty();
      this.map = new OpenLayers.Map({
        div: this.$el[0],
        projection: new OpenLayers.Projection("EPSG:3857"),
        displayProjection: new OpenLayers.Projection("EPSG:4326"),
        layers: this._setupBaseLayers(this.baseLayers),
        center: this.origCenter,
        zoom: this.origZoom,
        eventListeners: {
          zoomend: function(obj, el) {
            var currZoom;
            currZoom = _this.map.getZoom();
            if (_this.map.baseLayer instanceof OpenLayers.Layer.Bing) {
              currZoom = currZoom + 1;
            }
            if (currZoom > _this.MAX_ZOOM) {
              _this.map.zoomTo(_this.MAX_ZOOM);
            }
          }
        }
      });
      this._setupOverlayLayers();
      this.map.addControl(new OpenLayers.Control.LayerSwitcher());
      this.map.addControl(new OpenLayers.Control.MousePosition({
        emptyString: ""
      }));
      return this;
    };

    MapView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    MapView.prototype.hideWmsOverlays = function() {
      var layer, _i, _len, _ref;
      _ref = this.map.layers;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        layer = _ref[_i];
        if (!layer.isBaseLayer) {
          layer.setVisibility(false);
        }
      }
    };

    MapView.prototype.showWmsOverlayByViewType = function(viewType) {
      var layer, _i, _len, _ref;
      _ref = this.map.layers;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        layer = _ref[_i];
        if (layer.viewType === viewType) {
          layer.setVisibility(true);
        } else if (!layer.isBaseLayer) {
          layer.setVisibility(false);
        }
      }
    };

    MapView.prototype._setupOverlayLayers = function() {
      var layerConfig, overlay, _i, _len, _ref;
      _ref = WmsThemeConfig.Layers;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        layerConfig = _ref[_i];
        switch (layerConfig.type) {
          case "WMS":
            overlay = new OpenLayers.Layer.WMS(layerConfig.name, layerConfig.url, layerConfig.service_params, layerConfig.layer_params);
            overlay.viewType = layerConfig.viewType;
            this.map.addLayer(overlay);
            break;
          default:
            throw "Unsupported Layer Type";
        }
      }
    };

    MapView.prototype.resetExtent = function() {
      var zoom;
      zoom = this.origZoom;
      if (this.map.baseLayer instanceof OpenLayers.Layer.Bing) {
        zoom = this.origZoom - 1;
      }
      this.map.setCenter(this.origCenter, zoom);
    };

    MapView.prototype.zoomToExtent = function(bounds) {
      if (!this.isMapLocked) {
        this.map.zoomToExtent(bounds);
      }
    };

    MapView.prototype.showPlaceFeature = function(placeFeature) {
      var bounds, feature, wktFormat;
      wktFormat = new OpenLayers.Format.WKT();
      feature = wktFormat.read(placeFeature.get('wktGeog'));
      this.transformToWebMerc(feature.geometry);
      bounds = feature.geometry.getBounds();
      this.zoomToExtent(bounds);
    };

    MapView.prototype.getMouseLonLat = function() {
      return this.map.getLonLatFromPixel((this.map.getControlsByClass("OpenLayers.Control.MousePosition")[0]).lastXy);
    };

    MapView.prototype.transformToWebMerc = function(geometry) {
      return geometry.transform(this.map.displayProjection, this.map.projection);
    };

    MapView.prototype.showMapLoading = function() {
      if (!(this.$loadingOverlay != null)) {
        this.$loadingOverlay = $('<div></div>');
        this.$loadingOverlay.height(this.$el.height()).width(this.$el.width());
        this.$loadingOverlay.addClass('mapLoadingOverlay');
        this.$el.prepend(this.$loadingOverlay);
      }
    };

    MapView.prototype.hideMapLoading = function() {
      if (this.$loadingOverlay != null) {
        this.$loadingOverlay.remove();
        this.$loadingOverlay = null;
      }
    };

    MapView.prototype._setupBaseLayers = function(baseLayers) {
      var layer_name, layers, _i, _len;
      layers = [];
      if (!(baseLayers != null) || baseLayers.length === 0) {
        throw new Error("Must specify baseLayers.");
      }
      for (_i = 0, _len = baseLayers.length; _i < _len; _i++) {
        layer_name = baseLayers[_i];
        switch (layer_name) {
          case 'mapquest_open':
            layers.push(new OpenLayers.Layer.XYZ("MapQuest Open Street", ["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png", "http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png", "http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png", "http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png"], {
              attribution: "Data, imagery, and map information provided by \n<a href='http://www.mapquest.com' target='_blank'>MapQuest</a>, \n<a href='http://www.openstreetmap.org' target='_blank'>Open Street Map</a> \nand contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/' \ntarget='_blank'>CC-BY-SA</a>",
              transitionEffect: "resize",
              isBaseLayer: true
            }));
            break;
          case 'mapquest_aerial':
            layers.push(new OpenLayers.Layer.XYZ("MapQuest Open Aerial", ["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png", "http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png", "http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png", "http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png"], {
              attribution: "Tiles Courtesy of <a href='http://www.mapquest.com/'' target='_blank'>MapQuest</a>.\nPortions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency",
              transitionEffect: "resize",
              isBaseLayer: true
            }));
            break;
          case 'bing_road':
            layers.push(new OpenLayers.Layer.Bing({
              name: "Bing Road",
              key: this.bingApiKey,
              type: "Road",
              transitionEffect: "resize",
              isBaseLayer: true
            }));
            break;
          case 'bing_hybrid':
            layers.push(new OpenLayers.Layer.Bing({
              name: "Bing Hybrid",
              key: this.bingApiKey,
              type: "AerialWithLabels",
              transitionEffect: "resize",
              isBaseLayer: true
            }));
            break;
          case 'bing_aerial':
            layers.push(new OpenLayers.Layer.Bing({
              name: "Bing Aerial",
              key: this.bingApiKey,
              type: "Aerial",
              transitionEffect: "resize",
              isBaseLayer: true
            }));
            break;
          case 'esri_gray':
            layers.push(new OpenLayers.Layer.XYZ('ESRI Gray', ['http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/${z}/${y}/${x}'], {
              attribution: "Tiles Courtesy of <a href='http://www.esri.com' target='_blank'>esri</a>",
              isBaseLayer: true
            }));
            break;
          case 'stamen_toner':
            layers.push(new OpenLayers.Layer.Stamen("toner-lite", "Stamen Toner"));
            break;
          case 'stamen_watercolor':
            layers.push(new OpenLayers.Layer.Stamen("watercolor", "Stamen Watercolor"));
        }
      }
      return layers;
    };

    return MapView;

  })(Backbone.View);
});

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */
/*jslint regexp: true */
/*global require: false, XMLHttpRequest: false, ActiveXObject: false,
  define: false, window: false, process: false, Packages: false,
  java: false, location: false */

define('scripts/text',['module'], function (module) {
    

    var text, fs,
        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],
        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
        hasLocation = typeof location !== 'undefined' && location.href,
        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ''),
        defaultHostName = hasLocation && location.hostname,
        defaultPort = hasLocation && (location.port || undefined),
        buildMap = [],
        masterConfig = (module.config && module.config()) || {};

    text = {
        version: '2.0.3',

        strip: function (content) {
            //Strips <?xml ...?> declarations so that external SVG and XML
            //documents can be added to a document without worry. Also, if the string
            //is an HTML document, only the part inside the body tag is returned.
            if (content) {
                content = content.replace(xmlRegExp, "");
                var matches = content.match(bodyRegExp);
                if (matches) {
                    content = matches[1];
                }
            } else {
                content = "";
            }
            return content;
        },

        jsEscape: function (content) {
            return content.replace(/(['\\])/g, '\\$1')
                .replace(/[\f]/g, "\\f")
                .replace(/[\b]/g, "\\b")
                .replace(/[\n]/g, "\\n")
                .replace(/[\t]/g, "\\t")
                .replace(/[\r]/g, "\\r")
                .replace(/[\u2028]/g, "\\u2028")
                .replace(/[\u2029]/g, "\\u2029");
        },

        createXhr: masterConfig.createXhr || function () {
            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
            var xhr, i, progId;
            if (typeof XMLHttpRequest !== "undefined") {
                return new XMLHttpRequest();
            } else if (typeof ActiveXObject !== "undefined") {
                for (i = 0; i < 3; i += 1) {
                    progId = progIds[i];
                    try {
                        xhr = new ActiveXObject(progId);
                    } catch (e) {}

                    if (xhr) {
                        progIds = [progId];  // so faster next time
                        break;
                    }
                }
            }

            return xhr;
        },

        /**
         * Parses a resource name into its component parts. Resource names
         * look like: module/name.ext!strip, where the !strip part is
         * optional.
         * @param {String} name the resource name
         * @returns {Object} with properties "moduleName", "ext" and "strip"
         * where strip is a boolean.
         */
        parseName: function (name) {
            var strip = false, index = name.indexOf("."),
                modName = name.substring(0, index),
                ext = name.substring(index + 1, name.length);

            index = ext.indexOf("!");
            if (index !== -1) {
                //Pull off the strip arg.
                strip = ext.substring(index + 1, ext.length);
                strip = strip === "strip";
                ext = ext.substring(0, index);
            }

            return {
                moduleName: modName,
                ext: ext,
                strip: strip
            };
        },

        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,

        /**
         * Is an URL on another domain. Only works for browser use, returns
         * false in non-browser environments. Only used to know if an
         * optimized .js version of a text resource should be loaded
         * instead.
         * @param {String} url
         * @returns Boolean
         */
        useXhr: function (url, protocol, hostname, port) {
            var uProtocol, uHostName, uPort,
                match = text.xdRegExp.exec(url);
            if (!match) {
                return true;
            }
            uProtocol = match[2];
            uHostName = match[3];

            uHostName = uHostName.split(':');
            uPort = uHostName[1];
            uHostName = uHostName[0];

            return (!uProtocol || uProtocol === protocol) &&
                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
                   ((!uPort && !uHostName) || uPort === port);
        },

        finishLoad: function (name, strip, content, onLoad) {
            content = strip ? text.strip(content) : content;
            if (masterConfig.isBuild) {
                buildMap[name] = content;
            }
            onLoad(content);
        },

        load: function (name, req, onLoad, config) {
            //Name has format: some.module.filext!strip
            //The strip part is optional.
            //if strip is present, then that means only get the string contents
            //inside a body tag in an HTML string. For XML/SVG content it means
            //removing the <?xml ...?> declarations so the content can be inserted
            //into the current doc without problems.

            // Do not bother with the work if a build and text will
            // not be inlined.
            if (config.isBuild && !config.inlineText) {
                onLoad();
                return;
            }

            masterConfig.isBuild = config.isBuild;

            var parsed = text.parseName(name),
                nonStripName = parsed.moduleName + '.' + parsed.ext,
                url = req.toUrl(nonStripName),
                useXhr = (masterConfig.useXhr) ||
                         text.useXhr;

            //Load the text. Use XHR if possible and in a browser.
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
                text.get(url, function (content) {
                    text.finishLoad(name, parsed.strip, content, onLoad);
                }, function (err) {
                    if (onLoad.error) {
                        onLoad.error(err);
                    }
                });
            } else {
                //Need to fetch the resource across domains. Assume
                //the resource has been optimized into a JS module. Fetch
                //by the module name + extension, but do not include the
                //!strip part to avoid file system issues.
                req([nonStripName], function (content) {
                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
                                    parsed.strip, content, onLoad);
                });
            }
        },

        write: function (pluginName, moduleName, write, config) {
            if (buildMap.hasOwnProperty(moduleName)) {
                var content = text.jsEscape(buildMap[moduleName]);
                write.asModule(pluginName + "!" + moduleName,
                               "define(function () { return '" +
                                   content +
                               "';});\n");
            }
        },

        writeFile: function (pluginName, moduleName, req, write, config) {
            var parsed = text.parseName(moduleName),
                nonStripName = parsed.moduleName + '.' + parsed.ext,
                //Use a '.js' file name so that it indicates it is a
                //script that can be loaded across domains.
                fileName = req.toUrl(parsed.moduleName + '.' +
                                     parsed.ext) + '.js';

            //Leverage own load() method to load plugin value, but only
            //write out values that do not have the strip argument,
            //to avoid any potential issues with ! in file names.
            text.load(nonStripName, req, function (value) {
                //Use own write() method to construct full module value.
                //But need to create shell that translates writeFile's
                //write() to the right interface.
                var textWrite = function (contents) {
                    return write(fileName, contents);
                };
                textWrite.asModule = function (moduleName, contents) {
                    return write.asModule(moduleName, fileName, contents);
                };

                text.write(pluginName, nonStripName, textWrite, config);
            }, config);
        }
    };

    if (masterConfig.env === 'node' || (!masterConfig.env &&
            typeof process !== "undefined" &&
            process.versions &&
            !!process.versions.node)) {
        //Using special require.nodeRequire, something added by r.js.
        fs = require.nodeRequire('fs');

        text.get = function (url, callback) {
            var file = fs.readFileSync(url, 'utf8');
            //Remove BOM (Byte Mark Order) from utf8 files if it is there.
            if (file.indexOf('\uFEFF') === 0) {
                file = file.substring(1);
            }
            callback(file);
        };
    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&
            text.createXhr())) {
        text.get = function (url, callback, errback) {
            var xhr = text.createXhr();
            xhr.open('GET', url, true);

            //Allow overrides specified in config
            if (masterConfig.onXhr) {
                masterConfig.onXhr(xhr, url);
            }

            xhr.onreadystatechange = function (evt) {
                var status, err;
                //Do not explicitly handle errors, those should be
                //visible via console output in the browser.
                if (xhr.readyState === 4) {
                    status = xhr.status;
                    if (status > 399 && status < 600) {
                        //An http 4xx or 5xx error. Signal an error.
                        err = new Error(url + ' HTTP status: ' + status);
                        err.xhr = xhr;
                        errback(err);
                    } else {
                        callback(xhr.responseText);
                    }
                }
            };
            xhr.send(null);
        };
    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&
            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {
        //Why Java, why is this so awkward?
        text.get = function (url, callback) {
            var stringBuffer, line,
                encoding = "utf-8",
                file = new java.io.File(url),
                lineSeparator = java.lang.System.getProperty("line.separator"),
                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
                content = '';
            try {
                stringBuffer = new java.lang.StringBuffer();
                line = input.readLine();

                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
                // http://www.unicode.org/faq/utf_bom.html

                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
                if (line && line.length() && line.charAt(0) === 0xfeff) {
                    // Eat the BOM, since we've already found the encoding on this file,
                    // and we plan to concatenating this buffer with others; the BOM should
                    // only appear at the top of a file.
                    line = line.substring(1);
                }

                stringBuffer.append(line);

                while ((line = input.readLine()) !== null) {
                    stringBuffer.append(lineSeparator);
                    stringBuffer.append(line);
                }
                //Make sure we return a JavaScript string and not a Java string.
                content = String(stringBuffer.toString()); //String
            } finally {
                input.close();
            }
            callback(content);
        };
    }

    return text;
});

define('scripts/text!templates/strategyTypeListItem.html',[],function () { return '<li>\r\n    <a href="#/{{currYear}}/wms/type/{{m.id}}">\r\n        {{m.name}}\r\n    </a>\r\n</li>';});

define('scripts/text!templates/themeNav.html',[],function () { return '<ul class="nav nav-pills" id="themeNav">\r\n    <li class="nav-label">THEME:</li>\r\n    <li class="dropdown">\r\n        <a class="dropdown-toggle" data-toggle="dropdown" href="#">\r\n            <span>Water Management Strategies</span>\r\n            <b class="caret"></b>\r\n        </a>\r\n        <ul class="dropdown-menu" id="strategyTypeList">\r\n            <li>\r\n                <a href="#/{{currYear}}/wms">\r\n                    NET COUNTY SUPPLIES\r\n                </a>\r\n            </li>\r\n            <li class="nav-category">\r\n                Strategies by Type:\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li class="disabled"><a href="#">Water Use</a></li>\r\n    <li class="disabled"><a href="#">Sources</a></li>\r\n</ul>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/ThemeNavToolbarView',['namespace', 'collections/StrategyTypeCollection', 'scripts/text!templates/strategyTypeListItem.html', 'scripts/text!templates/themeNav.html'], function(namespace, StrategyTypeCollection, strategyTypeListItemTpl, tpl) {
  var ThemeNavToolbarView;
  return ThemeNavToolbarView = (function(_super) {

    __extends(ThemeNavToolbarView, _super);

    function ThemeNavToolbarView() {
      return ThemeNavToolbarView.__super__.constructor.apply(this, arguments);
    }

    ThemeNavToolbarView.prototype.template = _.template(tpl);

    ThemeNavToolbarView.prototype.initialize = function(options) {
      _.bindAll(this, 'render', 'unrender', 'renderStrategyTypeList', 'enableStrategyTypeList', 'disableStrategyTypeList');
      return null;
    };

    ThemeNavToolbarView.prototype.render = function() {
      this.$el.empty();
      this.$el.html(this.template({
        currYear: namespace.currYear
      }));
      ko.applyBindings(this, this.el);
      this.renderStrategyTypeList();
      return this;
    };

    ThemeNavToolbarView.prototype.renderStrategyTypeList = function() {
      var stratTypeLiTemplate, typeCollection,
        _this = this;
      stratTypeLiTemplate = _.template(strategyTypeListItemTpl);
      typeCollection = new StrategyTypeCollection();
      typeCollection.fetch({
        success: function(collection) {
          var res, strategyType, _i, _len, _ref;
          _ref = collection.models;
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            strategyType = _ref[_i];
            res = _this.$('#strategyTypeList').append(stratTypeLiTemplate({
              m: strategyType.toJSON(),
              currYear: namespace.currYear
            }));
          }
        }
      });
    };

    ThemeNavToolbarView.prototype.disableStrategyTypeList = function() {
      this.$('.dropdown-toggle').attr('data-toggle', null).parent('li').addClass('disabled').on('click.me', function(event) {
        event.preventDefault();
      });
    };

    ThemeNavToolbarView.prototype.enableStrategyTypeList = function() {
      this.$('.dropdown-toggle').attr('data-toggle', 'dropdown').parent('li').removeClass('disabled').off('click.me');
    };

    ThemeNavToolbarView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    return ThemeNavToolbarView;

  })(Backbone.View);
});

define('scripts/text!templates/yearNav.html',[],function () { return '<ul class="nav nav-pills" id="yearNav">\r\n    <li class="nav-label">DECADE:</li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2010">2010</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2020">2020</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2030">2030</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2040">2040</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2050">2050</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2060">2060</a></li>\r\n</ul>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/YearNavView',['namespace', 'scripts/text!templates/yearNav.html'], function(namespace, tpl) {
  var YearNavView;
  return YearNavView = (function(_super) {

    __extends(YearNavView, _super);

    function YearNavView() {
      return YearNavView.__super__.constructor.apply(this, arguments);
    }

    YearNavView.prototype.template = _.template(tpl);

    YearNavView.prototype.initialize = function(options) {
      _.bindAll(this, 'render', 'unrender', 'changeYear', 'disableYearButtons', 'enableYearButtons');
      return null;
    };

    YearNavView.prototype.render = function() {
      this.$el.empty();
      this.currentYear = ko.observable(namespace.currYear);
      this.$el.html(this.template());
      ko.applyBindings(this, this.el);
      this.$("a[data-value='" + namespace.currYear + "']").parent().addClass('active');
      return this;
    };

    YearNavView.prototype.disableYearButtons = function() {
      this.$('a').parents('li').addClass('disabled');
    };

    YearNavView.prototype.enableYearButtons = function() {
      this.$('a').parents('li').removeClass('disabled');
    };

    YearNavView.prototype.unrender = function() {
      kb.release(this);
      this.$el.remove();
      return null;
    };

    YearNavView.prototype.changeYear = function(data, event) {
      var $target, newYear;
      $target = $(event.target);
      newYear = $target.attr('data-value');
      this.trigger("changeyear", newYear);
      $target.parent().siblings().removeClass('active');
      $target.parent().addClass('active');
      return null;
    };

    return YearNavView;

  })(Backbone.View);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('models/PlaceFeatureModel',[], function() {
  var PlaceFeature;
  return PlaceFeature = (function(_super) {

    __extends(PlaceFeature, _super);

    function PlaceFeature() {
      return PlaceFeature.__super__.constructor.apply(this, arguments);
    }

    PlaceFeature.prototype.url = "" + BASE_PATH + "api/place/feature/hull";

    return PlaceFeature;

  })(Backbone.Model);
});

define('scripts/text!templates/mapBottomRightTools.html',[],function () { return '<div class="pull-right">\r\n\r\n    <div class="input-append map-stuff">\r\n        <input id="goToPlaceInput" type="text" placeholder="Go to Location" />\r\n        <button class="btn btn-primary" type="button" data-loading-text="...">Go</button>\r\n    </div>\r\n\r\n</div>\r\n\r\n<div class="pull-right">\r\n    <button class="btn" type="button" data-bind="click: toggleAreaSelects" data-toggle="#areaSelectContainer" data-title-orig="Select Strategies by Area">\r\n        <span class="title">Hide Area Selection</span> <i class="icon-caret-up"></i>\r\n    </button>\r\n    &nbsp;\r\n</div>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/MapBottomToolbarView',['namespace', 'models/PlaceFeatureModel', 'scripts/text!templates/mapBottomRightTools.html'], function(namespace, PlaceFeature, tpl) {
  var MapBottomToolbarView;
  return MapBottomToolbarView = (function(_super) {

    __extends(MapBottomToolbarView, _super);

    function MapBottomToolbarView() {
      return MapBottomToolbarView.__super__.constructor.apply(this, arguments);
    }

    MapBottomToolbarView.prototype.template = _.template(tpl);

    MapBottomToolbarView.prototype.initialize = function(options) {
      _.bindAll(this, 'render', 'unrender', 'showPlaceFeature');
      this.mapView = namespace.mapView;
    };

    MapBottomToolbarView.prototype.render = function() {
      this.$el.html(this.template());
      ko.applyBindings(this, this.el);
      this.$('#goToPlaceInput').place_typeahead({
        minLength: 2,
        source: function(query, process) {
          this.$element.data('selected-place-id', null);
          return $.get("" + BASE_PATH + "api/place", {
            name: query
          }, function(places) {
            return process(places);
          });
        },
        buttonClick: this.showPlaceFeature
      });
      return this;
    };

    MapBottomToolbarView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    MapBottomToolbarView.prototype.toggleAreaSelects = function(data, event) {
      var $target, toggleSelector;
      $target = $(event.delegateTarget);
      toggleSelector = $target.data('toggle');
      $(toggleSelector).slideToggle(300, function() {
        var $i, oldTitle;
        $i = $('i', $target);
        if ($i.hasClass('icon-caret-up')) {
          $i.removeClass('icon-caret-up');
          $i.addClass('icon-caret-down');
        } else {
          $i.addClass('icon-caret-up');
          $i.removeClass('icon-caret-down');
        }
        oldTitle = $('.title', $target).html();
        $('.title', $target).html($target.attr('data-title-orig'));
        return $target.attr('data-title-orig', oldTitle);
      });
    };

    MapBottomToolbarView.prototype.showPlaceFeature = function() {
      var placeFeature, selectedPlaceId,
        _this = this;
      selectedPlaceId = this.$('#goToPlaceInput').data('selected-place-id');
      placeFeature = new PlaceFeature();
      placeFeature.fetch({
        data: {
          placeId: selectedPlaceId
        },
        success: function(model) {
          return _this.mapView.showPlaceFeature(model);
        }
      });
    };

    return MapBottomToolbarView;

  })(Backbone.View);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/BaseStrategyCollectionView',['namespace'], function(namespace) {
  var BaseStrategyCollectionView;
  return BaseStrategyCollectionView = (function(_super) {

    __extends(BaseStrategyCollectionView, _super);

    function BaseStrategyCollectionView() {
      return BaseStrategyCollectionView.__super__.constructor.apply(this, arguments);
    }

    BaseStrategyCollectionView.prototype.MAX_WUG_RADIUS = 18;

    BaseStrategyCollectionView.prototype.MIN_WUG_RADIUS = 6;

    BaseStrategyCollectionView.prototype.initialize = function(ModelView, StrategyCollection, tpl, options) {
      _.bindAll(this, 'render', 'unrender', 'fetchData', 'appendModel', 'hideLoading', 'showLoading', 'onFetchDataSuccess', 'fetchCallback', '_setupDataTable', '_connectTableRowsToWugFeatures', 'showNothingFound', 'hideNothingFound', '_setupClickFeatureControl', 'showWugFeatures', '_clearWugFeaturesAndControls', '_setupWugClickControl', 'selectWugFeature', 'unselectWugFeatures', '_setupWugHighlightContol', 'highlightStratTypeWugs', 'unhighlightStratTypeWugs', '_setupHighlightFeatureControl', '_clickFeature');
      options = options || {};
      this.fetchParams = options.fetchParams || {};
      this.mapView = namespace.mapView;
      this.currYear = ko.observable(namespace.currYear);
      this.template = _.template(tpl);
      this.strategyCollection = new StrategyCollection();
      this.wugCollection = new Backbone.Collection();
      this.ModelView = ModelView;
      return null;
    };

    BaseStrategyCollectionView.prototype.render = function() {
      this.$el.html(this.template());
      this.fetchData();
      ko.applyBindings(this, this.el);
      this.$('.has-popover').popover({
        trigger: 'hover',
        placement: 'top'
      });
      return this;
    };

    BaseStrategyCollectionView.prototype.unrender = function() {
      this._clearWugFeaturesAndControls();
      this.$el.html();
      return null;
    };

    BaseStrategyCollectionView.prototype._clearWugFeaturesAndControls = function() {
      this.unselectWugFeatures();
      if (this.highlightFeatureControl != null) {
        this.highlightFeatureControl.destroy();
        this.highlightFeatureControl = null;
      }
      if (this.clickFeatureControl != null) {
        this.clickFeatureControl.destroy();
        this.clickFeatureControl = null;
      }
      if (this.wugLayer != null) {
        this.wugLayer.destroy();
      }
    };

    BaseStrategyCollectionView.prototype.fetchData = function() {
      var params,
        _this = this;
      this.$('tbody').empty();
      params = _.extend({
        year: namespace.currYear
      }, this.fetchParams);
      this.trigger("table:startload");
      this.strategyCollection.fetch({
        data: params,
        success: this.onFetchDataSuccess,
        error: function() {
          _this.trigger("table:fetcherror");
        }
      });
    };

    BaseStrategyCollectionView.prototype.onFetchDataSuccess = function(strategyCollection) {
      var m, _i, _len, _ref;
      if (strategyCollection.models.length === 0) {
        this.trigger("table:nothingfound");
        return false;
      }
      _ref = strategyCollection.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        m = _ref[_i];
        this.appendModel(m);
        if (m.attributes.isRedundantSupply === 'Y') {
          this.$(".note-marker-container").show();
        }
      }
      this.$('.has-popover').popover({
        trigger: 'hover'
      });
      this._setupDataTable();
      this._connectTableRowsToWugFeatures();
      if ((this.fetchCallback != null) && _.isFunction(this.fetchCallback)) {
        this.fetchCallback(strategyCollection.models);
      }
      this.trigger("table:endload");
      return true;
    };

    BaseStrategyCollectionView.prototype.fetchCallback = function(strategyModels) {
      var groupedById, newWugList;
      strategyModels = _.reject(strategyModels, function(m) {
        return m.get('recipientEntityType') === "WWP";
      });
      groupedById = _.groupBy(strategyModels, function(m) {
        return m.get("recipientEntityId");
      });
      newWugList = _.map(groupedById, function(group) {
        var entity;
        entity = _.reduce(group, function(memo, m) {
          memo.entityId = m.get("recipientEntityId");
          memo.name = m.get("recipientEntityName");
          memo.wktGeog = m.get("recipientEntityWktGeog");
          memo.type = m.get("recipientEntityType");
          memo.strategyTypes.push(m.get("typeId"));
          memo.totalSupply += m.get("supply" + namespace.currYear);
          return memo;
        }, {
          totalSupply: 0,
          strategyTypes: []
        });
        entity.strategyTypes = _.uniq(entity.strategyTypes);
        return entity;
      });
      newWugList.sort(function(a, b) {
        if (a.type === "WWP") {
          return -1;
        }
        if (b.type === "WWP") {
          return 1;
        }
        return b.totalSupply - a.totalSupply;
      });
      this.wugCollection.reset(newWugList);
      this.showWugFeatures();
    };

    BaseStrategyCollectionView.prototype._setupDataTable = function() {
      var $table, dtColConfig,
        _this = this;
      $table = this.$('table');
      dtColConfig = [];
      $('th', $table).each(function(i, th) {
        var $th;
        $th = $(th);
        if ($th.attr('data-sort') != null) {
          return dtColConfig.push({
            sType: $(th).attr('data-sort')
          });
        } else {
          return dtColConfig.push(null);
        }
      });
      $table.dataTable({
        bDestroy: true,
        sPaginationType: "bootstrap",
        aLengthMenu: [[10, 25, 50, 100, 99999], [10, 25, 50, 100, "All"]],
        aoColumns: dtColConfig,
        iDisplayLength: namespace.selectedDisplayLength || 10,
        fnDrawCallback: function(settings) {
          namespace.selectedDisplayLength = settings._iDisplayLength;
        }
      });
    };

    BaseStrategyCollectionView.prototype._connectTableRowsToWugFeatures = function() {
      var me;
      me = this;
      this.$('table tbody').delegate('td.strategyType', 'hover', function(event) {
        var typeId;
        if (event.type === 'mouseenter') {
          typeId = parseInt($(this).attr('data-type-id'));
          me.trigger("table:hovertype", typeId);
        } else {
          me.trigger("table:hovertype", null);
        }
      });
      this.$('table tbody').delegate('tr', 'hover', function(event) {
        var $target, wugId;
        if (event.type === 'mouseenter') {
          $target = $(this);
          wugId = parseInt($target.attr('data-entity-id'));
          me.trigger("table:hoverwug", wugId);
        } else {
          me.trigger("table:hoverwug", null);
        }
      });
    };

    BaseStrategyCollectionView.prototype.appendModel = function(model) {
      var modelView;
      modelView = new this.ModelView({
        model: model,
        currYear: namespace.currYear
      });
      this.$('tbody').append(modelView.render().el);
    };

    BaseStrategyCollectionView.prototype.showNothingFound = function() {
      $('#nothingFoundMessage').fadeIn();
      this.$el.hide();
    };

    BaseStrategyCollectionView.prototype.hideNothingFound = function() {
      $('#nothingFoundMessage').hide();
    };

    BaseStrategyCollectionView.prototype.showLoading = function() {
      this.$el.hide();
      this.hideNothingFound();
      $('.tableLoading').show();
    };

    BaseStrategyCollectionView.prototype.hideLoading = function() {
      $('.tableLoading').hide();
      this.$el.fadeIn();
    };

    BaseStrategyCollectionView.prototype.showWugFeatures = function() {
      var bounds, max_supply, min_supply, newFeature, wktFormat, wug, wugFeatures, _i, _len, _ref;
      if (this.wugLayer != null) {
        this.wugLayer.destroy();
      }
      if (this.wugCollection.models.length < 1) {
        return;
      }
      this.wugLayer = new OpenLayers.Layer.Vector("Water User Groups", {
        styleMap: this._wugStyleMap,
        displayInLayerSwitcher: false
      });
      wktFormat = new OpenLayers.Format.WKT();
      max_supply = this.wugCollection.max(function(m) {
        return m.get("totalSupply");
      }).get("totalSupply");
      min_supply = this.wugCollection.min(function(m) {
        return m.get("totalSupply");
      }).get("totalSupply");
      bounds = null;
      wugFeatures = [];
      _ref = this.wugCollection.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        wug = _ref[_i];
        newFeature = wktFormat.read(wug.get("wktGeog"));
        newFeature.attributes = _.clone(wug.attributes);
        newFeature.size = this._calculateScaledValue(max_supply, min_supply, this.MAX_WUG_RADIUS, this.MIN_WUG_RADIUS, wug.get("totalSupply"));
        delete newFeature.attributes.wktGeog;
        this.mapView.transformToWebMerc(newFeature.geometry);
        if (!(bounds != null)) {
          bounds = newFeature.geometry.getBounds().clone();
        } else {
          bounds.extend(newFeature.geometry.getBounds());
        }
        wugFeatures.push(newFeature);
      }
      this.wugLayer.addFeatures(wugFeatures);
      this.mapView.map.addLayer(this.wugLayer);
      this._setupWugHighlightContol();
      this._setupWugClickControl();
      this.mapView.zoomToExtent(bounds);
    };

    BaseStrategyCollectionView.prototype.selectWugFeature = function(wugId, projId) {
      var wugFeature, _i, _len, _ref;
      if (!(this.highlightFeatureControl != null)) {
        return;
      }
      _ref = this.wugLayer.features;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        wugFeature = _ref[_i];
        if (wugFeature.attributes.entityId === wugId) {
          this.highlightFeatureControl.select(wugFeature);
          return;
        }
      }
    };

    BaseStrategyCollectionView.prototype.unselectWugFeatures = function() {
      if (!(this.highlightFeatureControl != null) || !(this.highlightFeatureControl.layer != null) || !(this.highlightFeatureControl.layer.selectedFeatures != null)) {
        return;
      }
      this.highlightFeatureControl.unselectAll();
    };

    BaseStrategyCollectionView.prototype.highlightStratTypeWugs = function(stratTypeId) {
      var wugFeature, _i, _len, _ref;
      if (!this.wugLayer) {
        return;
      }
      _ref = this.wugLayer.features;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        wugFeature = _ref[_i];
        if ((wugFeature.attributes.strategyTypes != null) && _.contains(wugFeature.attributes.strategyTypes, stratTypeId)) {
          wugFeature.renderIntent = "typehighlight";
        } else {
          wugFeature.renderIntent = "transparent";
        }
      }
      this.wugLayer.redraw();
    };

    BaseStrategyCollectionView.prototype.unhighlightStratTypeWugs = function() {
      var wugFeature, _i, _len, _ref;
      if (!this.wugLayer) {
        return;
      }
      _ref = this.wugLayer.features;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        wugFeature = _ref[_i];
        wugFeature.renderIntent = "default";
      }
      this.wugLayer.redraw();
    };

    BaseStrategyCollectionView.prototype._setupWugClickControl = function() {
      if (!(this.clickFeatureControl != null)) {
        this._setupClickFeatureControl(this.wugLayer);
      } else {
        this._addLayerToControl(this.clickFeatureControl, this.wugLayer);
      }
    };

    BaseStrategyCollectionView.prototype._setupWugHighlightContol = function() {
      var _this = this;
      if (!(this.highlightFeatureControl != null)) {
        this._setupHighlightFeatureControl(this.wugLayer);
      } else {
        this._addLayerToControl(this.highlightFeatureControl, this.wugLayer);
      }
      this.highlightFeatureControl.events.register('featurehighlighted', null, function(event) {
        var popup, wugFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.wugLayer.id) {
          return;
        }
        wugFeature = event.feature;
        popup = new OpenLayers.Popup.FramedCloud("wugpopup", wugFeature.geometry.getBounds().getCenterLonLat(), null, "                        <b>" + wugFeature.attributes.name + "</b><br/>                        Total " + namespace.currYear + " Supply: " + ($.number(wugFeature.attributes.totalSupply)) + " ac-ft/yr                    ", null, false);
        popup.autoSize = true;
        wugFeature.popup = popup;
        _this.mapView.map.addPopup(popup);
      });
      this.highlightFeatureControl.events.register('featureunhighlighted', null, function(event) {
        var wugFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.wugLayer.id) {
          return;
        }
        wugFeature = event.feature;
        if (wugFeature.popup != null) {
          _this.mapView.map.removePopup(wugFeature.popup);
          wugFeature.popup.destroy();
          wugFeature.popup = null;
        }
      });
    };

    BaseStrategyCollectionView.prototype._addLayerToControl = function(control, newLayer) {
      if (!(control != null) || !(newLayer != null)) {
        return;
      }
      control.setLayer((control.layers || [control.layer]).concat(newLayer));
    };

    BaseStrategyCollectionView.prototype._setupClickFeatureControl = function(layer) {
      this.clickFeatureControl = new OpenLayers.Control.SelectFeature(layer, {
        autoActivate: true,
        clickFeature: this._clickFeature
      });
      this.clickFeatureControl.events.register("featurehighlighted", null, function(event) {
        this.events.triggerEvent("clickfeature", {
          feature: event.feature
        });
        return true;
      });
      this.mapView.map.addControl(this.clickFeatureControl);
    };

    BaseStrategyCollectionView.prototype._clickFeature = function(feature) {
      var wugId;
      if (feature.layer.id !== this.wugLayer.id) {
        return;
      }
      if ((feature.attributes.type != null) && feature.attributes.type === "WWP") {
        return;
      }
      wugId = feature.attributes.entityId;
      Backbone.history.navigate("#/" + namespace.currYear + "/wms/entity/" + wugId, {
        trigger: true
      });
    };

    BaseStrategyCollectionView.prototype._setupHighlightFeatureControl = function(layer) {
      this.highlightFeatureControl = new OpenLayers.Control.SelectFeature(layer, {
        multiple: false,
        hover: true,
        autoActivate: true,
        select: function(feature) {
          if (!(feature != null) || !(feature.layer != null)) {
            return;
          }
          OpenLayers.Control.SelectFeature.prototype.select.apply(this, arguments);
        },
        overFeature: function(feature) {
          var _this = this;
          layer = feature.layer;
          if (this.hover) {
            if (this.highlightOnly) {
              this.highlight(feature);
            } else if (OpenLayers.Util.indexOf(layer.selectedFeatures, feature) === -1) {
              this.highlightTimer = _.delay(function() {
                return _this.select(feature);
              }, 400);
            }
          }
        },
        outFeature: function(feature) {
          var control;
          if (this.hover) {
            if (this.highlightOnly) {
              if (feature._lastHighlighter === this.id) {
                if (feature._prevHighlighter && feature._prevHighlighter !== this.id) {
                  delete feature._lastHighlighter;
                  control = this.map.getControl(feature._prevHighlighter);
                  if (control) {
                    return control.highlight(feature);
                  }
                } else {
                  return this.unhighlight(feature);
                }
              }
            } else {
              clearTimeout(this.highlightTimer);
              return this.unselect(feature);
            }
          }
        }
      });
      this.mapView.map.addControl(this.highlightFeatureControl);
    };

    BaseStrategyCollectionView.prototype._calculateScaledValue = function(max, min, scale_max, scale_min, val) {
      var scaled_val;
      if (max === min) {
        return scale_min;
      }
      scaled_val = (scale_max - scale_min) * (val - min) / (max - min) + scale_min;
      return scaled_val;
    };

    BaseStrategyCollectionView.prototype._wugStyleMap = new OpenLayers.StyleMap({
      "default": new OpenLayers.Style({
        pointRadius: '${getPointRadius}',
        strokeColor: "yellow",
        strokeWidth: 1,
        fillColor: "${getFillColor}",
        fillOpacity: 0.8
      }, {
        context: {
          getPointRadius: function(feature) {
            if (feature.size != null) {
              return feature.size;
            }
            return 6;
          },
          getFillColor: function(feature) {
            if ((feature.attributes.type != null) && feature.attributes.type === "WWP") {
              return 'gray';
            }
            return 'green';
          }
        },
        rules: [
          new OpenLayers.Rule({
            maxScaleDenominator: 866688,
            symbolizer: {
              fontSize: "11px",
              labelAlign: 'cb',
              labelOutlineColor: "yellow",
              labelOutlineWidth: 2,
              labelYOffset: 8,
              label: "${name}"
            }
          }), new OpenLayers.Rule({
            minScaleDenominator: 866688,
            symbolizer: {}
          })
        ]
      }),
      "select": new OpenLayers.Style({
        fillColor: "yellow",
        strokeColor: "green",
        fillOpacity: 1
      }),
      "typehighlight": new OpenLayers.Style({
        fillColor: "blue",
        fillOpacity: 0.8,
        strokeColor: "yellow"
      }),
      "transparent": new OpenLayers.Style({
        fillOpacity: 0,
        strokeOpacity: 0
      })
    });

    return BaseStrategyCollectionView;

  })(Backbone.View);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/BaseSelectableRegionStrategyView',['namespace', 'collections/RegionFeatureCollection', 'views/BaseStrategyCollectionView'], function(namespace, RegionFeatureCollection, BaseStrategyCollectionView) {
  var BaseSelectableRegionStrategyView;
  return BaseSelectableRegionStrategyView = (function(_super) {

    __extends(BaseSelectableRegionStrategyView, _super);

    function BaseSelectableRegionStrategyView() {
      return BaseSelectableRegionStrategyView.__super__.constructor.apply(this, arguments);
    }

    BaseSelectableRegionStrategyView.prototype.initialize = function(ModelView, Collection, tpl, mapView, options) {
      BaseSelectableRegionStrategyView.__super__.initialize.call(this, ModelView, Collection, tpl, options);
      _.bindAll(this, 'showRegionFeatures', 'onStrategyCollectionSuccess');
      this.mapView = mapView;
      this.regionCollection = null;
    };

    BaseSelectableRegionStrategyView.prototype.unrender = function() {
      BaseSelectableRegionStrategyView.__super__.unrender.apply(this, arguments);
      if (this.regionHighlightControl != null) {
        this.regionHighlightControl.destroy();
      }
      if (this.regionClickControl != null) {
        this.regionClickControl.destroy();
      }
      if (this.regionLayer != null) {
        this.regionLayer.destroy();
      }
      return null;
    };

    BaseSelectableRegionStrategyView.prototype.fetchData = function() {
      var deferred, params,
        _this = this;
      this.$('tbody').empty();
      params = _.extend({
        year: namespace.currYear
      }, this.fetchParams);
      this.trigger("table:startload");
      deferred = this.strategyCollection.fetch({
        data: params,
        success: this.onStrategyCollectionSuccess
      });
      deferred.then(function() {
        _this.trigger("table:endload");
      }).fail(function() {
        _this.trigger("table:fetcherror");
      });
    };

    BaseSelectableRegionStrategyView.prototype.onStrategyCollectionSuccess = function(collection) {
      var m, _i, _len, _ref;
      if (collection.models.length === 0) {
        this.trigger("table:nothingfound");
      } else {
        _ref = collection.models;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          m = _ref[_i];
          this.appendModel(m);
        }
        this.$('.has-popover').popover({
          trigger: 'hover'
        });
        this._setupDataTable();
        this.regionCollection = namespace.regionFeatures;
        this.showRegionFeatures();
      }
    };

    BaseSelectableRegionStrategyView.prototype.showRegionFeatures = function() {
      var newFeature, region, regionFeatures, wktFormat, _i, _len, _ref;
      wktFormat = new OpenLayers.Format.WKT();
      regionFeatures = [];
      _ref = this.regionCollection.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        region = _ref[_i];
        newFeature = wktFormat.read(region.get('wktGeog'));
        newFeature.attributes = _.clone(region.attributes);
        delete newFeature.attributes.wktGeog;
        this.mapView.transformToWebMerc(newFeature.geometry);
        regionFeatures.push(newFeature);
      }
      this.regionLayer = new OpenLayers.Layer.Vector("Region Feature Layer", {
        displayInLayerSwitcher: false,
        styleMap: new OpenLayers.StyleMap({
          "default": new OpenLayers.Style({
            strokeColor: "gray",
            strokeWidth: 0,
            fillColor: "white",
            fillOpacity: 0
          }),
          "select": new OpenLayers.Style({
            fillColor: "yellow",
            strokeColor: "orange",
            strokeWidth: 2,
            fillOpacity: 0.2
          })
        })
      });
      this.regionLayer.addFeatures(regionFeatures);
      this.mapView.map.addLayer(this.regionLayer);
      this.regionHighlightControl = new OpenLayers.Control.SelectFeature(this.regionLayer, {
        autoActivate: true,
        hover: true
      });
      this.mapView.map.addControl(this.regionHighlightControl);
      this.regionHighlightControl.handlers.feature.stopDown = false;
      this.regionClickControl = new OpenLayers.Control.SelectFeature(this.regionLayer, {
        autoActivate: true,
        clickFeature: function(regionFeature) {
          var regionLetter;
          regionLetter = regionFeature.attributes.letter;
          Backbone.history.navigate("#/" + namespace.currYear + "/wms/region/" + regionLetter, {
            trigger: true
          });
        }
      });
      this.mapView.map.addControl(this.regionClickControl);
      this.regionClickControl.handlers.feature.stopDown = false;
    };

    return BaseSelectableRegionStrategyView;

  })(BaseStrategyCollectionView);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/BaseStrategyView',['namespace'], function(namespace) {
  var BaseStrategyView;
  return BaseStrategyView = (function(_super) {

    __extends(BaseStrategyView, _super);

    function BaseStrategyView() {
      return BaseStrategyView.__super__.constructor.apply(this, arguments);
    }

    BaseStrategyView.prototype.tagName = 'tr';

    BaseStrategyView.prototype.initialize = function(options) {
      if (!(this.template != null) && !(options.template != null)) {
        throw "Must specify template";
      }
      if (options.template != null) {
        this.template = options.template;
      }
      BaseStrategyView.__super__.initialize.call(this, options);
      _.bindAll(this, 'render', 'unrender');
      this.template = _.template(this.template);
      return null;
    };

    BaseStrategyView.prototype.render = function() {
      this.$el.html(this.template({
        m: this.model.toJSON(),
        currYear: namespace.currYear
      }));
      this.$el.attr('data-entity-id', this.model.get("recipientEntityId"));
      return this;
    };

    BaseStrategyView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    return BaseStrategyView;

  })(Backbone.View);
});

define('scripts/text!templates/countyNetSupplyRow.html',[],function () { return '\r\n<td>\r\n    <a href="#/{{currYear}}/wms/county/{{m.countyId}}" title="Click for Strategies in {{m.countyName}} County">\r\n        {{m.countyName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m.netMunicipal) }}</td>\r\n<td>{{ $.number(m.netIrrigation) }}</td>\r\n<td>{{ $.number(m.netManufacturing) }}</td>\r\n<td>{{ $.number(m.netLivestock) }}</td>\r\n<td>{{ $.number(m.netSteamElectric) }}</td>\r\n<td>{{ $.number(m.netMining) }}</td>\r\n<td><b>{{ $.number(m.netSupplyTotal) }}</b></td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/CountyNetSupplyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/countyNetSupplyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var CountyNetSupplyView;
  return CountyNetSupplyView = (function(_super) {

    __extends(CountyNetSupplyView, _super);

    function CountyNetSupplyView() {
      return CountyNetSupplyView.__super__.constructor.apply(this, arguments);
    }

    CountyNetSupplyView.prototype.template = tpl;

    return CountyNetSupplyView;

  })(BaseStrategyView);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('collections/CountyNetSupplyCollection',[], function() {
  var CountyNetSupplyCollection;
  return CountyNetSupplyCollection = (function(_super) {

    __extends(CountyNetSupplyCollection, _super);

    function CountyNetSupplyCollection() {
      return CountyNetSupplyCollection.__super__.constructor.apply(this, arguments);
    }

    CountyNetSupplyCollection.prototype.url = "" + BASE_PATH + "api/supply/county-net";

    return CountyNetSupplyCollection;

  })(Backbone.Collection);
});

define('scripts/text!templates/countyNetSupplyTable.html',[],function () { return '\r\n<p>Map shows Regional Water Planning Areas that may be selected using cursor.</p>\r\n\r\n<p>Table lists net water supplies to water user groups, by county and use type, from all recommended water management strategies in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                County\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Municipal supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Municipal\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Irrigation supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Irrigation\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Manufacturing supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Manufacturing\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Livestock supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Livestock\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Steam-Electric Power supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Steam-Electric Power\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Mining supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Mining\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    TOTAL\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/CountyNetSupplyCollectionView',['namespace', 'views/BaseSelectableRegionStrategyView', 'views/CountyNetSupplyView', 'collections/CountyNetSupplyCollection', 'scripts/text!templates/countyNetSupplyTable.html'], function(namespace, BaseSelectableRegionStrategyView, CountyNetSupplyView, CountyNetSupplyCollection, tpl) {
  var CountyNetSupplyCollectionView;
  return CountyNetSupplyCollectionView = (function(_super) {

    __extends(CountyNetSupplyCollectionView, _super);

    function CountyNetSupplyCollectionView() {
      return CountyNetSupplyCollectionView.__super__.constructor.apply(this, arguments);
    }

    CountyNetSupplyCollectionView.prototype.initialize = function(options) {
      CountyNetSupplyCollectionView.__super__.initialize.call(this, CountyNetSupplyView, CountyNetSupplyCollection, tpl, namespace.mapView);
    };

    return CountyNetSupplyCollectionView;

  })(BaseSelectableRegionStrategyView);
});

define('scripts/text!templates/regionStrategyRow.html',[],function () { return '\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}} \r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    \r\n    {{ \'$\' + $.number(m.capitalCost) }}\r\n        \r\n</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/RegionStrategyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/regionStrategyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var RegionStrategyView;
  return RegionStrategyView = (function(_super) {

    __extends(RegionStrategyView, _super);

    function RegionStrategyView() {
      return RegionStrategyView.__super__.constructor.apply(this, arguments);
    }

    RegionStrategyView.prototype.template = tpl;

    return RegionStrategyView;

  })(BaseStrategyView);
});

define('scripts/text!templates/regionStrategyTable.html',[],function () { return '\r\n<p>Map shows Regional Water Planning Area boundaries.</p>\r\n\r\n<p>\r\n    Table lists recommended water management strategies in <b><span data-bind="text: viewName"></span></b> - <span data-bind="text: currYear"></span> based on Appendix A.2 of the 2012 State Water Plan.\r\n</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/RegionStrategyCollectionView',['namespace', 'views/BaseSelectableRegionStrategyView', 'views/RegionStrategyView', 'scripts/text!templates/regionStrategyTable.html'], function(namespace, BaseSelectableRegionStrategyView, RegionStrategyView, tpl) {
  var RegionStrategyCollectionView;
  return RegionStrategyCollectionView = (function(_super) {

    __extends(RegionStrategyCollectionView, _super);

    function RegionStrategyCollectionView() {
      return RegionStrategyCollectionView.__super__.constructor.apply(this, arguments);
    }

    RegionStrategyCollectionView.prototype.initialize = function(options) {
      var StrategyCollection, fetchParams;
      this.regionLetter = options.id;
      this.viewName = ko.observable("Region " + this.regionLetter);
      fetchParams = {
        regionLetter: this.regionLetter
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/region"
      });
      RegionStrategyCollectionView.__super__.initialize.call(this, RegionStrategyView, StrategyCollection, tpl, namespace.mapView, {
        fetchParams: fetchParams
      });
      return null;
    };

    RegionStrategyCollectionView.prototype.showRegionFeatures = function() {
      var bounds, matchedRegion,
        _this = this;
      RegionStrategyCollectionView.__super__.showRegionFeatures.apply(this, arguments);
      matchedRegion = _.find(this.regionLayer.features, function(regionFeature) {
        return regionFeature.attributes.letter === _this.regionLetter;
      });
      this.regionHighlightControl.select(matchedRegion);
      bounds = matchedRegion.geometry.getBounds();
      this.mapView.zoomToExtent(bounds);
    };

    return RegionStrategyCollectionView;

  })(BaseSelectableRegionStrategyView);
});

define('scripts/text!templates/countyStrategyRow.html',[],function () { return '\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/CountyStrategyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/countyStrategyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var CountyStrategyView;
  return CountyStrategyView = (function(_super) {

    __extends(CountyStrategyView, _super);

    function CountyStrategyView() {
      return CountyStrategyView.__super__.constructor.apply(this, arguments);
    }

    CountyStrategyView.prototype.template = tpl;

    return CountyStrategyView;

  })(BaseStrategyView);
});

define('scripts/text!templates/countyStrategyTable.html',[],function () { return '<p>Map shows geographic center of entities using recommended water management strategies within <b><span data-bind="text: viewName"></span></b> (water system service area boundaries may extend outside of county).</p>\r\n\r\n<p>Table lists recommended water management strategies and the entities that would use them in <span data-bind="text: viewName"></span> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/CountyStrategyCollectionView',['namespace', 'views/BaseStrategyCollectionView', 'views/CountyStrategyView', 'scripts/text!templates/countyStrategyTable.html'], function(namespace, BaseStrategyCollectionView, CountyStrategyView, tpl) {
  var CountyStrategyCollectionView;
  return CountyStrategyCollectionView = (function(_super) {

    __extends(CountyStrategyCollectionView, _super);

    function CountyStrategyCollectionView() {
      return CountyStrategyCollectionView.__super__.constructor.apply(this, arguments);
    }

    CountyStrategyCollectionView.prototype.initialize = function(options) {
      var StrategyCollection, fetchParams;
      this.countyId = options.id;
      this.countyName = options.name;
      this.viewName = ko.observable("" + this.countyName + " County");
      fetchParams = {
        countyId: this.countyId
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/county"
      });
      CountyStrategyCollectionView.__super__.initialize.call(this, CountyStrategyView, StrategyCollection, tpl, {
        fetchParams: fetchParams
      });
      return null;
    };

    return CountyStrategyCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/strategyRow.html',[],function () { return '\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/StrategyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/strategyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var StrategyView;
  return StrategyView = (function(_super) {

    __extends(StrategyView, _super);

    function StrategyView() {
      return StrategyView.__super__.constructor.apply(this, arguments);
    }

    StrategyView.prototype.template = tpl;

    return StrategyView;

  })(BaseStrategyView);
});

define('scripts/text!templates/districtStrategyTable.html',[],function () { return '\r\n<p>Map shows geographic center of all entities using recommended water management strategies within <b><span data-bind="text: viewName"></span></b> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists all recommended water management strategies that serve an entity within <b><span data-bind="text: viewName"></span></b> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/LegeDistrictCollectionView',['namespace', 'views/BaseStrategyCollectionView', 'views/StrategyView', 'scripts/text!templates/districtStrategyTable.html'], function(namespace, BaseStrategyCollectionView, StrategyView, tpl) {
  var LegeDistrictCollectionView;
  return LegeDistrictCollectionView = (function(_super) {

    __extends(LegeDistrictCollectionView, _super);

    function LegeDistrictCollectionView() {
      return LegeDistrictCollectionView.__super__.constructor.apply(this, arguments);
    }

    LegeDistrictCollectionView.prototype.initialize = function(options) {
      var StrategyCollection, fetchParams;
      if (!(options.type != null) || !options.type === "house" || !options.type === "senate") {
        throw "Options.type myst be 'house' or 'senate'.";
      }
      this.districtType = options.type;
      this.districtId = options.id;
      this.districtName = options.name;
      this.viewName = ko.observable("" + this.districtName);
      fetchParams = {
        districtId: this.districtId
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/district/" + this.districtType
      });
      LegeDistrictCollectionView.__super__.initialize.call(this, StrategyView, StrategyCollection, tpl, {
        fetchParams: fetchParams
      });
      return null;
    };

    return LegeDistrictCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/strategyTypeRow.html',[],function () { return '\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/StrategyTypeView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/strategyTypeRow.html'], function(namespace, BaseStrategyView, tpl) {
  var StrategyTypeView;
  return StrategyTypeView = (function(_super) {

    __extends(StrategyTypeView, _super);

    function StrategyTypeView() {
      return StrategyTypeView.__super__.constructor.apply(this, arguments);
    }

    StrategyTypeView.prototype.template = tpl;

    return StrategyTypeView;

  })(BaseStrategyView);
});

define('scripts/text!templates/strategyTypeTable.html',[],function () { return '\r\n<p>Map shows geographic center of entities using recommended <b><span data-bind="text: viewName"></span></b> strategies in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists recommended <span data-bind="text: viewName"></span> strategies and entities that would use them in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/StrategyTypeCollectionView',['namespace', 'views/BaseStrategyCollectionView', 'views/StrategyTypeView', 'scripts/text!templates/strategyTypeTable.html'], function(namespace, BaseStrategyCollectionView, StrategyTypeView, tpl) {
  var StrategyTypeCollectionView;
  return StrategyTypeCollectionView = (function(_super) {

    __extends(StrategyTypeCollectionView, _super);

    function StrategyTypeCollectionView() {
      return StrategyTypeCollectionView.__super__.constructor.apply(this, arguments);
    }

    StrategyTypeCollectionView.prototype.initialize = function(options) {
      var StrategyCollection, fetchParams;
      this.typeId = options.id;
      this.typeName = options.name;
      this.viewName = ko.observable("" + this.typeName);
      fetchParams = {
        typeId: this.typeId
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/type"
      });
      StrategyTypeCollectionView.__super__.initialize.call(this, StrategyTypeView, StrategyCollection, tpl, {
        fetchParams: fetchParams
      });
      return null;
    };

    return StrategyTypeCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/entityStrategyRow.html',[],function () { return '\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/EntityStrategyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/entityStrategyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var EntityStrategyView;
  return EntityStrategyView = (function(_super) {

    __extends(EntityStrategyView, _super);

    function EntityStrategyView() {
      return EntityStrategyView.__super__.constructor.apply(this, arguments);
    }

    EntityStrategyView.prototype.template = tpl;

    return EntityStrategyView;

  })(BaseStrategyView);
});

define('scripts/text!templates/entityStrategyTable.html',[],function () { return '\r\n<p>Map includes a schematic representation of water sources for water management strategies supplying <b><span data-bind="text: viewName"></span></b> <i class="wugIcon icon-circle"></i> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Conservation and other local strategy water sources are not mapped.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/EntityStrategyCollectionView',['namespace', 'config/WmsThemeConfig', 'views/BaseStrategyCollectionView', 'views/EntityStrategyView', 'scripts/text!templates/entityStrategyTable.html'], function(namespace, WmsThemeConfig, BaseStrategyCollectionView, EntityStrategyView, tpl) {
  var EntityStrategyCollectionView;
  return EntityStrategyCollectionView = (function(_super) {

    __extends(EntityStrategyCollectionView, _super);

    function EntityStrategyCollectionView() {
      return EntityStrategyCollectionView.__super__.constructor.apply(this, arguments);
    }

    EntityStrategyCollectionView.prototype.initialize = function(options) {
      var SourceCollection, StrategyCollection, fetchParams;
      _.bindAll(this, 'fetchCallback', 'onFetchBothCollectionSuccess', 'showSourceFeatures', '_registerHighlightEvents');
      this.entityId = options.id;
      this.viewName = ko.observable();
      this.mapView = namespace.mapView;
      fetchParams = {
        entityId: this.entityId
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/entity"
      });
      SourceCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/entity/" + this.entityId + "/sources"
      });
      this.sourceCollection = new SourceCollection();
      EntityStrategyCollectionView.__super__.initialize.call(this, EntityStrategyView, StrategyCollection, tpl, {
        fetchParams: fetchParams
      });
      return null;
    };

    EntityStrategyCollectionView.prototype.fetchData = function() {
      var params,
        _this = this;
      this.$('tbody').empty();
      params = _.extend({
        year: namespace.currYear
      }, this.fetchParams);
      this.trigger("table:startload");
      $.when(this.strategyCollection.fetch({
        data: params
      }), this.sourceCollection.fetch({
        data: {
          year: namespace.currYear
        }
      })).then(this.onFetchBothCollectionSuccess).fail(function() {
        _this.trigger("table:fetcherror");
      });
    };

    EntityStrategyCollectionView.prototype.unrender = function() {
      EntityStrategyCollectionView.__super__.unrender.apply(this, arguments);
      if (this.sourceLayer != null) {
        this.sourceLayer.destroy();
      }
    };

    EntityStrategyCollectionView.prototype.onFetchBothCollectionSuccess = function() {
      if (this.onFetchDataSuccess(this.strategyCollection) === false) {
        return;
      }
      this.showSourceFeatures();
      this.trigger("table:endload");
    };

    EntityStrategyCollectionView.prototype.fetchCallback = function(strategyModels) {
      this.viewName(strategyModels[0].get("recipientEntityName"));
      EntityStrategyCollectionView.__super__.fetchCallback.call(this, strategyModels);
    };

    EntityStrategyCollectionView.prototype.showSourceFeatures = function() {
      var bounds, lineFeatures, newFeature, source, sourceFeatures, sourcePoint, wktFormat, wugFeat, wugFeature, _i, _len, _ref;
      wktFormat = new OpenLayers.Format.WKT();
      bounds = null;
      sourceFeatures = [];
      lineFeatures = [];
      wugFeature = this.wugLayer.features[0];
      _ref = this.sourceCollection.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        source = _ref[_i];
        if (!(source.get('wktGeog') != null)) {
          continue;
        }
        newFeature = wktFormat.read(source.get('wktGeog'));
        if (!(newFeature != null)) {
          continue;
        }
        newFeature.attributes = _.clone(source.attributes);
        if (source.attributes.wktMappingPoint != null) {
          sourcePoint = wktFormat.read(source.attributes.wktMappingPoint);
          this.mapView.transformToWebMerc(sourcePoint.geometry);
          lineFeatures.push(new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([sourcePoint.geometry, wugFeature.geometry]), {
            featureType: "connector"
          }));
        }
        delete newFeature.attributes.wktGeog;
        delete newFeature.attributes.wktMappingPoint;
        this.mapView.transformToWebMerc(newFeature.geometry);
        if (!(bounds != null)) {
          bounds = newFeature.geometry.getBounds().clone();
        } else {
          bounds.extend(newFeature.geometry.getBounds());
        }
        sourceFeatures.push(newFeature);
      }
      sourceFeatures.sort(function(a, b) {
        if (a.attributes.sourceType === "SURFACE WATER") {
          return 1;
        }
        if (b.attributes.sourceType === "SURFACE WATER") {
          return -1;
        }
        return a.attributes.sourceTypeId - b.attributes.sourceTypeId;
      });
      this.sourceLayer = new OpenLayers.Layer.Vector("Source Feature Layer", {
        displayInLayerSwitcher: false,
        styleMap: this._sourceStyleMap
      });
      this.sourceLayer.addFeatures(sourceFeatures);
      this.sourceLayer.addFeatures(lineFeatures);
      this.mapView.map.addLayer(this.sourceLayer);
      this.mapView.map.setLayerIndex(this.wugLayer, +this.mapView.map.getLayerIndex(this.sourceLayer) + 1);
      this._registerHighlightEvents();
      this._addLayerToControl(this.clickFeatureControl, this.sourceLayer);
      if (bounds != null) {
        wugFeat = this.wugLayer.features[0];
        bounds.extend(wugFeat.geometry.getBounds());
        this.mapView.zoomToExtent(bounds);
      }
    };

    EntityStrategyCollectionView.prototype._clickFeature = function(feature) {
      var sourceId;
      EntityStrategyCollectionView.__super__._clickFeature.call(this, feature);
      if (!(feature.layer != null) || feature.layer.id !== this.sourceLayer.id) {
        return;
      }
      if ((feature.attributes.featureType != null) && feature.attributes.featureType === "connector") {
        return;
      }
      sourceId = feature.attributes.sourceId;
      Backbone.history.navigate("#/" + namespace.currYear + "/wms/source/" + sourceId, {
        trigger: true
      });
    };

    EntityStrategyCollectionView.prototype._registerHighlightEvents = function() {
      var _this = this;
      this._addLayerToControl(this.highlightFeatureControl, this.sourceLayer);
      this.highlightFeatureControl.events.register('beforefeaturehighlighted', null, function(event) {
        var feature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.sourceLayer.id) {
          return true;
        }
        feature = event.feature;
        if ((feature.attributes.featureType != null) && feature.attributes.featureType === "connector") {
          return false;
        }
        return true;
      });
      this.highlightFeatureControl.events.register('featurehighlighted', null, function(event) {
        var popup, sourceFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.sourceLayer.id) {
          return;
        }
        sourceFeature = event.feature;
        popup = new OpenLayers.Popup.FramedCloud("sourcepopup", _this.mapView.getMouseLonLat(), null, "                        <b>" + sourceFeature.attributes.name + "</b><br/>                        " + namespace.currYear + " Supply to Water User Group:                         " + ($.number(sourceFeature.attributes.supplyInYear)) + " ac-ft/yr                    ", null, false);
        popup.autoSize = true;
        sourceFeature.popup = popup;
        _this.mapView.map.addPopup(popup);
      });
      this.highlightFeatureControl.events.register('featureunhighlighted', null, function(event) {
        var sourceFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.sourceLayer.id) {
          return;
        }
        sourceFeature = event.feature;
        if (sourceFeature.popup != null) {
          _this.mapView.map.removePopup(sourceFeature.popup);
          sourceFeature.popup.destroy();
          sourceFeature.popup = null;
        }
      });
    };

    EntityStrategyCollectionView.prototype._sourceStyleMap = new OpenLayers.StyleMap({
      "default": new OpenLayers.Style({
        strokeColor: "${getStrokeColor}",
        strokeWidth: "${getStrokeWidth}",
        fillColor: "${getFillColor}",
        fillOpacity: 0.8
      }, {
        context: {
          getStrokeColor: function(feature) {
            var style;
            if ((feature.attributes.featureType != null) && feature.attributes.featureType === "connector") {
              return "#ee9900";
            }
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.strokeColor;
            }
            return WmsThemeConfig.SourceStyles[0].strokeColor;
          },
          getStrokeWidth: function(feature) {
            var style;
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.strokeWidth;
            }
            return WmsThemeConfig.SourceStyles[0].strokeWidth;
          },
          getFillColor: function(feature) {
            var style;
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.fillColor;
            }
            return WmsThemeConfig.SourceStyles[0].fillColor;
          }
        }
      }),
      "select": new OpenLayers.Style({
        fillColor: "cyan",
        strokeColor: "blue"
      })
    });

    return EntityStrategyCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/strategyDetailRow.html',[],function () { return '<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/StrategyDetailView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/strategyDetailRow.html'], function(namespace, BaseStrategyView, tpl) {
  var StrategyDetailView;
  return StrategyDetailView = (function(_super) {

    __extends(StrategyDetailView, _super);

    function StrategyDetailView() {
      return StrategyDetailView.__super__.constructor.apply(this, arguments);
    }

    StrategyDetailView.prototype.template = tpl;

    return StrategyDetailView;

  })(BaseStrategyView);
});

define('scripts/text!templates/strategyDetailTable.html',[],function () { return '\r\n<p>Map shows geographic center of entities that would use the <b><span data-bind="text: viewName"></span></b> strategy in <span data-bind="text: currYear"></span>.\r\n\r\n<p>County-based water use categories (e.g., manufacturing) are shown in the center of counties.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n             <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/StrategyDetailCollectionView',['namespace', 'views/BaseStrategyCollectionView', 'views/StrategyDetailView', 'scripts/text!templates/strategyDetailTable.html'], function(namespace, BaseStrategyCollectionView, StrategyDetailView, tpl) {
  var StrategyDetailCollectionView;
  return StrategyDetailCollectionView = (function(_super) {

    __extends(StrategyDetailCollectionView, _super);

    function StrategyDetailCollectionView() {
      return StrategyDetailCollectionView.__super__.constructor.apply(this, arguments);
    }

    StrategyDetailCollectionView.prototype.initialize = function(options) {
      var StrategyDetailCollection, fetchParams;
      _.bindAll(this, 'fetchCallback');
      this.projectId = options.id;
      this.viewName = ko.observable();
      fetchParams = {
        projectId: this.projectId
      };
      StrategyDetailCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/project"
      });
      StrategyDetailCollectionView.__super__.initialize.call(this, StrategyDetailView, StrategyDetailCollection, tpl, {
        fetchParams: fetchParams
      });
      return null;
    };

    StrategyDetailCollectionView.prototype.fetchCallback = function(strategyModels) {
      if (strategyModels.length < (1 != null)) {
        alert("Invalid projectId specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
      }
      this.viewName(strategyModels[0].get("description"));
      StrategyDetailCollectionView.__super__.fetchCallback.call(this, strategyModels);
    };

    return StrategyDetailCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/sourceStrategyRow.html',[],function () { return '<td>{{m.sourceType}}</td>\r\n<td>{{m.sourceBasin}}</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">\r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/SourceStrategyView',['namespace', 'views/BaseStrategyView', 'scripts/text!templates/sourceStrategyRow.html'], function(namespace, BaseStrategyView, tpl) {
  var SourceStrategyView;
  return SourceStrategyView = (function(_super) {

    __extends(SourceStrategyView, _super);

    function SourceStrategyView() {
      return SourceStrategyView.__super__.constructor.apply(this, arguments);
    }

    SourceStrategyView.prototype.template = tpl;

    return SourceStrategyView;

  })(BaseStrategyView);
});

define('scripts/text!templates/sourceStrategyTable.html',[],function () { return '\r\n\r\n<p>Map includes a schematic representation of all entities with recommended water management strategies that rely on <b><span data-bind="text: viewName"></span></b> <i class="wugIcon icon-circle"></i> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists water management strategies along with entities using water from <span data-bind="text: viewName"></span> <i class="wugIcon icon-circle"></i> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                Source Type    \r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="River basin of the selected source.  Only for Surface Water sources.">\r\n                    River Basin\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/SourceStrategyCollectionView',['namespace', 'config/WmsThemeConfig', 'views/BaseStrategyCollectionView', 'views/SourceStrategyView', 'scripts/text!templates/sourceStrategyTable.html'], function(namespace, WmsThemeConfig, BaseStrategyCollectionView, SourceStrategyView, tpl) {
  var SourceStrategyCollectionView;
  return SourceStrategyCollectionView = (function(_super) {

    __extends(SourceStrategyCollectionView, _super);

    function SourceStrategyCollectionView() {
      return SourceStrategyCollectionView.__super__.constructor.apply(this, arguments);
    }

    SourceStrategyCollectionView.prototype.initialize = function(options) {
      var SourceModel, StrategyCollection, fetchParams;
      _.bindAll(this, 'onFetchBothCollectionSuccess', 'showSourceFeature', '_registerHighlightEvents');
      this.sourceId = options.id;
      this.viewName = ko.observable();
      this.mapView = namespace.mapView;
      fetchParams = {
        sourceId: this.sourceId
      };
      StrategyCollection = Backbone.Collection.extend({
        url: "" + BASE_PATH + "api/strategies/source"
      });
      SourceModel = Backbone.Model.extend({
        url: "" + BASE_PATH + "api/source/feature/" + this.sourceId
      });
      this.sourceModel = new SourceModel();
      SourceStrategyCollectionView.__super__.initialize.call(this, SourceStrategyView, StrategyCollection, tpl, {
        fetchParams: fetchParams
      });
    };

    SourceStrategyCollectionView.prototype.fetchData = function() {
      var params,
        _this = this;
      this.$('tbody').empty();
      params = _.extend({
        year: namespace.currYear
      }, this.fetchParams);
      this.trigger("table:startload");
      $.when(this.strategyCollection.fetch({
        data: params
      }), this.sourceModel.fetch()).then(this.onFetchBothCollectionSuccess).fail(function() {
        _this.trigger("table:fetcherror");
      });
    };

    SourceStrategyCollectionView.prototype.unrender = function() {
      SourceStrategyCollectionView.__super__.unrender.apply(this, arguments);
      if (this.sourceLayer != null) {
        this.sourceLayer.destroy();
      }
    };

    SourceStrategyCollectionView.prototype.onFetchBothCollectionSuccess = function() {
      if (this.onFetchDataSuccess(this.strategyCollection) === false) {
        return;
      }
      this.viewName(this.sourceModel.attributes.name);
      this.showSourceFeature();
      this.trigger("table:endload");
    };

    SourceStrategyCollectionView.prototype.showSourceFeature = function() {
      var bounds, lineFeatures, sourceFeature, sourcePoint, sourcePointText, stratModel, wktFormat, wugFeat, wugFeature, wugFeatures, wugPoint, wugPointText, _i, _j, _len, _len1, _ref, _ref1;
      wktFormat = new OpenLayers.Format.WKT();
      bounds = null;
      lineFeatures = [];
      wugFeatures = this.wugLayer.features;
      if (!(this.sourceModel.get('wktGeog') != null)) {
        return;
      }
      sourceFeature = wktFormat.read(this.sourceModel.get('wktGeog'));
      if (!(sourceFeature != null)) {
        return;
      }
      sourceFeature.attributes = _.clone(this.sourceModel.attributes);
      delete sourceFeature.attributes.wktGeog;
      delete sourceFeature.attributes.wktMappingPoint;
      this.mapView.transformToWebMerc(sourceFeature.geometry);
      bounds = sourceFeature.geometry.getBounds().clone();
      _ref = this.wugLayer.features;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        wugFeature = _ref[_i];
        bounds.extend(wugFeature.geometry.getBounds());
      }
      _ref1 = this.strategyCollection.models;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        stratModel = _ref1[_j];
        if (stratModel.get("recipientEntityType") === "WWP") {
          continue;
        }
        sourcePointText = stratModel.get("sourceMappingPoint");
        wugPointText = stratModel.get("recipientEntityWktGeog");
        if ((sourcePointText != null) && (wugPointText != null)) {
          sourcePoint = wktFormat.read(sourcePointText);
          wugPoint = wktFormat.read(wugPointText);
          this.mapView.transformToWebMerc(sourcePoint.geometry);
          this.mapView.transformToWebMerc(wugPoint.geometry);
          lineFeatures.push(new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([sourcePoint.geometry, wugPoint.geometry]), {
            featureType: "connector"
          }));
        }
      }
      this.sourceLayer = new OpenLayers.Layer.Vector("Source Feature Layer", {
        displayInLayerSwitcher: false,
        styleMap: this._sourceStyleMap
      });
      this.sourceLayer.addFeatures(sourceFeature);
      this.sourceLayer.addFeatures(lineFeatures);
      this.mapView.map.addLayer(this.sourceLayer);
      this.mapView.map.setLayerIndex(this.wugLayer, +this.mapView.map.getLayerIndex(this.sourceLayer) + 1);
      this._registerHighlightEvents();
      this._addLayerToControl(this.clickFeatureControl, this.sourceLayer);
      if (bounds != null) {
        wugFeat = this.wugLayer.features[0];
        bounds.extend(wugFeat.geometry.getBounds());
        this.mapView.zoomToExtent(bounds);
      }
    };

    SourceStrategyCollectionView.prototype._registerHighlightEvents = function() {
      var _this = this;
      this._addLayerToControl(this.highlightFeatureControl, this.sourceLayer);
      this.highlightFeatureControl.events.register('beforefeaturehighlighted', null, function(event) {
        var feature;
        feature = event.feature;
        if ((feature.attributes.featureType != null) && feature.attributes.featureType === "connector") {
          return false;
        }
        return true;
      });
      this.highlightFeatureControl.events.register('featurehighlighted', null, function(event) {
        var popup, sourceFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.sourceLayer.id) {
          return false;
        }
        sourceFeature = event.feature;
        popup = new OpenLayers.Popup.FramedCloud("sourcepopup", _this.mapView.getMouseLonLat(), null, "                        <b>" + sourceFeature.attributes.name + "</b><br/>                        " + namespace.currYear + " Supply to Water User Group:                         " + ($.number(sourceFeature.attributes.supplyInYear)) + " ac-ft/yr                    ", null, false);
        popup.autoSize = true;
        sourceFeature.popup = popup;
        _this.mapView.map.addPopup(popup);
      });
      this.highlightFeatureControl.events.register('featureunhighlighted', null, function(event) {
        var sourceFeature;
        if (!(event.feature.layer != null) || event.feature.layer.id !== _this.sourceLayer.id) {
          return false;
        }
        sourceFeature = event.feature;
        if (sourceFeature.popup != null) {
          _this.mapView.map.removePopup(sourceFeature.popup);
          sourceFeature.popup.destroy();
          sourceFeature.popup = null;
        }
      });
    };

    SourceStrategyCollectionView.prototype._sourceStyleMap = new OpenLayers.StyleMap({
      "default": new OpenLayers.Style({
        strokeColor: "${getStrokeColor}",
        strokeWidth: "${getStrokeWidth}",
        fillColor: "${getFillColor}",
        fillOpacity: 0.8
      }, {
        context: {
          getStrokeColor: function(feature) {
            var style;
            if ((feature.attributes.featureType != null) && feature.attributes.featureType === "connector") {
              return "#ee9900";
            }
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.strokeColor;
            }
            return WmsThemeConfig.SourceStyles[0].strokeColor;
          },
          getStrokeWidth: function(feature) {
            var style;
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.strokeWidth;
            }
            return WmsThemeConfig.SourceStyles[0].strokeWidth;
          },
          getFillColor: function(feature) {
            var style;
            style = _.find(WmsThemeConfig.SourceStyles, function(style) {
              return style.id === feature.attributes.sourceTypeId;
            });
            if (style != null) {
              return style.fillColor;
            }
            return WmsThemeConfig.SourceStyles[0].fillColor;
          }
        }
      }),
      "select": new OpenLayers.Style({
        fillColor: "cyan",
        strokeColor: "blue"
      })
    });

    return SourceStrategyCollectionView;

  })(BaseStrategyCollectionView);
});

define('scripts/text!templates/wmsAreaSelect.html',[],function () { return '<div class="span12">\r\n    <div class="row">\r\n        <div class="span12">\r\n            <p>Select an area from the following dropdowns to view all recommended strategies for that area.</p>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="span3" id="regionSelectContainer"></div>\r\n        <div class="span3" id="countySelectContainer"></div>\r\n        <div class="span3" id="districtSelectContainer"></div>\r\n        <div class="span3" id="wugSelectContainer"></div>\r\n    </div>\r\n    <hr class="space"/>\r\n</div>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/WmsAreaSelectView',['namespace', 'scripts/text!templates/wmsAreaSelect.html'], function(namespace, tpl) {
  var WmsAreaSelectView;
  return WmsAreaSelectView = (function(_super) {

    __extends(WmsAreaSelectView, _super);

    function WmsAreaSelectView() {
      return WmsAreaSelectView.__super__.constructor.apply(this, arguments);
    }

    WmsAreaSelectView.prototype.template = _.template(tpl);

    WmsAreaSelectView.prototype.initialize = function(options) {
      _.bindAll(this, 'render', 'unrender', '_createRegionSelect', '_createCountySelect', '_createHouseSenateSelect', '_createWugSelect', 'enableSelects', 'disableSelects', 'resetSelects');
      if (!(namespace.countyNames != null) || !(namespace.regionNames != null) || !(namespace.houseNames != null) || !(namespace.senateNames != null)) {
        throw "Must specify namespace.counties, namespace.regions, namespace.house,and namespace.senate";
      }
    };

    WmsAreaSelectView.prototype.render = function() {
      this.$el.empty();
      this.$el.html(this.template());
      this.selects = {};
      this.selects["region"] = this._createRegionSelect().chosen();
      this.selects["county"] = this._createCountySelect().chosen();
      this.selects["district"] = this._createHouseSenateSelect().chosen();
      this.selects["wug"] = this._createWugSelect().ajaxChosen({
        type: 'GET',
        url: "" + BASE_PATH + "api/entities/auto",
        jsonTermKey: "namePart"
      }, function(data) {
        var kvp, results, _i, _len;
        results = [];
        for (_i = 0, _len = data.length; _i < _len; _i++) {
          kvp = data[_i];
          results.push({
            value: kvp.id,
            text: kvp.name
          });
        }
        return results;
      });
      return this;
    };

    WmsAreaSelectView.prototype.resetSelects = function(exceptName) {
      var select;
      for (select in this.selects) {
        if (select !== exceptName) {
          this.selects[select].val("-1").trigger("liszt:updated");
        }
      }
    };

    WmsAreaSelectView.prototype.disableSelects = function() {
      var select;
      for (select in this.selects) {
        this.selects[select].attr('disabled', true).trigger("liszt:updated");
      }
    };

    WmsAreaSelectView.prototype.enableSelects = function() {
      var select;
      for (select in this.selects) {
        this.selects[select].attr('disabled', null).trigger("liszt:updated");
      }
    };

    WmsAreaSelectView.prototype._createRegionSelect = function() {
      var $regionSelect, me, opt, region, _i, _len, _ref;
      $regionSelect = $("<select></select>");
      $regionSelect.append($("<option value='-1'>Select a Region</option>"));
      _ref = namespace.regionNames.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        region = _ref[_i];
        opt = $("<option value='" + (region.get("letter")) + "'>Region " + (region.get("letter")) + "</option>");
        $regionSelect.append(opt);
      }
      this.$("#regionSelectContainer").append($regionSelect);
      me = this;
      $regionSelect.on("change", function() {
        var $this;
        $this = $(this);
        if ($this.val() === "-1") {
          return;
        }
        Backbone.history.navigate("#/" + namespace.currYear + "/wms/region/" + ($this.val()), {
          trigger: true
        });
        me.resetSelects("region");
      });
      return $regionSelect;
    };

    WmsAreaSelectView.prototype._createCountySelect = function() {
      var $countySelect, county, me, opt, _i, _len, _ref;
      $countySelect = $("<select></select>");
      $countySelect.append($("<option value='-1'>Select a County</option>"));
      _ref = namespace.countyNames.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        county = _ref[_i];
        opt = $("<option value='" + (county.get("id")) + "'>" + (county.get("name")) + "</option>");
        $countySelect.append(opt);
      }
      this.$("#countySelectContainer").append($countySelect);
      me = this;
      $countySelect.on("change", function() {
        var $this;
        $this = $(this);
        if ($this.val() === "-1") {
          return;
        }
        Backbone.history.navigate("#/" + namespace.currYear + "/wms/county/" + ($this.val()), {
          trigger: true
        });
        me.resetSelects("county");
      });
      return $countySelect;
    };

    WmsAreaSelectView.prototype._createHouseSenateSelect = function() {
      var $houseSenateSelect, district, me, opt, _i, _j, _len, _len1, _ref, _ref1;
      $houseSenateSelect = $("<select></select>");
      $houseSenateSelect.append($("<option value='-1'>Select a Legislative District</option>"));
      _ref = namespace.senateNames.models;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        district = _ref[_i];
        opt = $("<option data-type='senate' value='" + (district.get("id")) + "'>" + (district.get("name")) + "</option>");
        $houseSenateSelect.append(opt);
      }
      _ref1 = namespace.houseNames.models;
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        district = _ref1[_j];
        opt = $("<option data-type='house' value='" + (district.get("id")) + "'>" + (district.get("name")) + "</option>");
        $houseSenateSelect.append(opt);
      }
      this.$("#districtSelectContainer").append($houseSenateSelect);
      me = this;
      $houseSenateSelect.on("change", function() {
        var $this, districtType;
        $this = $(this);
        if ($this.val() === "-1") {
          return;
        }
        districtType = $this.attr('data-type');
        if (districtType === 'senate') {
          Backbone.history.navigate("#/" + namespace.currYear + "/wms/senate/" + ($this.val()), {
            trigger: true
          });
        } else {
          Backbone.history.navigate("#/" + namespace.currYear + "/wms/house/" + ($this.val()), {
            trigger: true
          });
        }
        me.resetSelects("district");
      });
      return $houseSenateSelect;
    };

    WmsAreaSelectView.prototype._createWugSelect = function() {
      var $wugSelect, me;
      $wugSelect = $("<select></select>");
      $wugSelect.append($("<option value='-1'>Search for a Water User Group</option>"));
      this.$("#wugSelectContainer").append($wugSelect);
      me = this;
      $wugSelect.on("change", function() {
        var $this;
        $this = $(this);
        if ($this.val() === "-1") {
          return;
        }
        Backbone.history.navigate("#/" + namespace.currYear + "/wms/entity/" + ($this.val()), {
          trigger: true
        });
        me.resetSelects("wug");
      });
      return $wugSelect;
    };

    WmsAreaSelectView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    return WmsAreaSelectView;

  })(Backbone.View);
});

define('scripts/text!templates/mapTopButtons.html',[],function () { return '<div class="pull-right">\r\n    <a class="btn map-stuff" data-bind="click: toggleMapViewLock" data-toggle="button" data-other-icon-class="icon-lock">\r\n        <i class="icon-unlock"> </i>Lock Map View\r\n    </a>\r\n    \r\n    <a class="btn map-stuff" data-bind="click: zoomToTexas">\r\n        Zoom to Texas\r\n    </a>\r\n    \r\n    <a class="btn" id="toggleMapBtn" data-bind="click: toggleMap">\r\n        Hide Map\r\n    </a>\r\n</div>';});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('views/MapTopButtonsView',['namespace', 'scripts/text!templates/mapTopButtons.html'], function(namespace, tpl) {
  var MapTopButtonsView;
  return MapTopButtonsView = (function(_super) {

    __extends(MapTopButtonsView, _super);

    function MapTopButtonsView() {
      return MapTopButtonsView.__super__.constructor.apply(this, arguments);
    }

    MapTopButtonsView.prototype.template = _.template(tpl);

    MapTopButtonsView.prototype.initialize = function(options) {
      _.bindAll(this, 'render', 'unrender', 'toggleMapViewLock', 'zoomToTexas', 'toggleMap');
      if (!(namespace.mapView != null)) {
        throw "namespace.mapView not defined";
      }
      this.mapView = namespace.mapView;
      return null;
    };

    MapTopButtonsView.prototype.render = function() {
      this.$el.empty();
      this.$el.html(this.template());
      ko.applyBindings(this, this.el);
      return this;
    };

    MapTopButtonsView.prototype.unrender = function() {
      this.$el.remove();
      return null;
    };

    MapTopButtonsView.prototype.toggleMapViewLock = function(data, event) {
      var $icon, $target, swap;
      $target = $(event.delegateTarget);
      $icon = $('i', $target);
      swap = $icon.attr('class');
      $icon.attr('class', $target.attr('data-other-icon-class'));
      $target.attr('data-other-icon-class', swap);
      if ($target.hasClass("locked")) {
        $target.removeClass("locked");
        this.mapView.isMapLocked = false;
      } else {
        $target.addClass("locked");
        this.mapView.isMapLocked = true;
      }
    };

    MapTopButtonsView.prototype.zoomToTexas = function() {
      this.mapView.resetExtent();
    };

    MapTopButtonsView.prototype.toggleMap = function(data, event) {
      var $target;
      $target = $(event.delegateTarget);
      if ($target.hasClass('off')) {
        $target.html('Hide Map');
        $('#mapContainer').slideDown();
        $('.map-stuff').show();
        $target.removeClass('off');
      } else {
        $target.addClass('off');
        $('#mapContainer').slideUp();
        $('.map-stuff').hide();
        $target.html('Show Map');
      }
    };

    return MapTopButtonsView;

  })(Backbone.View);
});

// Generated by CoffeeScript 1.3.3
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define('WMSRouter',['namespace', 'views/MapView', 'views/ThemeNavToolbarView', 'views/YearNavView', 'views/MapBottomToolbarView', 'views/CountyNetSupplyCollectionView', 'views/RegionStrategyCollectionView', 'views/CountyStrategyCollectionView', 'views/LegeDistrictCollectionView', 'views/StrategyTypeCollectionView', 'views/EntityStrategyCollectionView', 'views/StrategyDetailCollectionView', 'views/SourceStrategyCollectionView', 'views/WmsAreaSelectView', 'views/MapTopButtonsView'], function(namespace, MapView, ThemeNavToolbarView, YearNavView, MapBottomToolbarView, CountyNetSupplyCollectionView, RegionStrategyCollectionView, CountyStrategyCollectionView, LegeDistrictCollectionView, StrategyTypeCollectionView, EntityStrategyCollectionView, StrategyDetailCollectionView, SourceStrategyCollectionView, WmsAreaSelectView, MapTopButtonsView) {
  var WMSRouter;
  return WMSRouter = (function(_super) {

    __extends(WMSRouter, _super);

    function WMSRouter() {
      return WMSRouter.__super__.constructor.apply(this, arguments);
    }

    WMSRouter.prototype.initialize = function(options) {
      _.bindAll(this, 'updateViewsToNewYear', 'updateSelectedWug', 'onTableStartLoad', 'onTableEndLoad', 'onTableNothingFound', 'onTableFetchError', 'highlightWugsByStrategyType');
      this.currStrategyView = null;
      this.tableContainer = $('#tableContainer')[0];
      this.mapView = new MapView({
        mapContainerId: 'mapContainer',
        bingApiKey: $('#bing_maps_key').val()
      });
      namespace.mapView = this.mapView;
      this.mapView.render();
      this.mapBottomToolbarView = new MapBottomToolbarView({
        el: $('#mapBottomToolsContainer')[0]
      });
      this.mapBottomToolbarView.render();
      this.themeNavToolbarView = new ThemeNavToolbarView({
        el: $('#themeNavContainer')[0]
      });
      this.mapTopButtonsView = new MapTopButtonsView({
        el: $('#mapTopButtonsContainer')[0]
      });
      this.mapTopButtonsView.render();
      this.yearNavView = new YearNavView({
        el: $('#yearNavContainer')[0]
      });
      this.yearNavView.on("changeyear", this.updateViewsToNewYear);
      this.areaSelectView = new WmsAreaSelectView({
        el: $('#areaSelectContainer')[0]
      });
      this.areaSelectView.render();
    };

    WMSRouter.prototype.routes = {
      "": "default",
      ":year/wms": "wmsNetCountySupplies",
      ":year/wms/region/:regionLetter": "wmsRegion",
      ":year/wms/county/:countyId": "wmsCounty",
      ":year/wms/house/:districtId": "wmsHouseDistrict",
      ":year/wms/senate/:districtId": "wmsSenateDistrict",
      ":year/wms/type/:typeId": "wmsType",
      ":year/wms/entity/:entityId": "wmsEntity",
      ":year/wms/project/:projectId": "wmsProjectDetail",
      ":year/wms/source/:sourceId": "wmsSource"
    };

    WMSRouter.prototype.onTableStartLoad = function() {
      this.areaSelectView.disableSelects();
      this.yearNavView.disableYearButtons();
      this.themeNavToolbarView.disableStrategyTypeList();
      this.mapView.showMapLoading();
      this.currStrategyView.showLoading();
    };

    WMSRouter.prototype.onTableEndLoad = function() {
      this.areaSelectView.enableSelects();
      this.yearNavView.enableYearButtons();
      this.themeNavToolbarView.enableStrategyTypeList();
      this.mapView.hideMapLoading();
      this.currStrategyView.hideLoading();
    };

    WMSRouter.prototype.onTableFetchError = function() {
      $('#errorMessage').show();
    };

    WMSRouter.prototype.onTableNothingFound = function() {
      this.onTableEndLoad();
      this.currStrategyView.showNothingFound();
    };

    WMSRouter.prototype.updateSelectedWug = function(wugId) {
      if (!(wugId != null)) {
        this.currStrategyView.unselectWugFeatures();
      } else {
        this.currStrategyView.selectWugFeature(wugId);
      }
    };

    WMSRouter.prototype.highlightWugsByStrategyType = function(stratTypeId) {
      if (!(stratTypeId != null)) {
        this.currStrategyView.unhighlightStratTypeWugs();
      } else {
        this.currStrategyView.highlightStratTypeWugs(stratTypeId);
      }
    };

    WMSRouter.prototype.updateViewsToNewYear = function(newYear) {
      var currRoute, newRoute, oldYear, y, _i, _len, _ref;
      currRoute = Backbone.history.fragment;
      oldYear = "";
      _ref = namespace.VALID_YEARS;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        y = _ref[_i];
        if (currRoute.indexOf(y + "/") !== -1) {
          oldYear = y;
          break;
        }
      }
      if (oldYear === "") {
        Backbone.history.navigate("");
      }
      newRoute = currRoute.replace(oldYear, newYear);
      Backbone.history.navigate("#/" + newRoute, {
        trigger: true
      });
    };

    WMSRouter.prototype.before = {
      '': function() {
        $('#errorMessage').hide();
      },
      '^[0-9]{4}/wms': function(year) {
        if (this.currStrategyView != null) {
          this.currStrategyView = this.currStrategyView.unrender();
        }
        if (year != null) {
          if (_.contains(namespace.VALID_YEARS, year)) {
            namespace.currYear = year;
          } else {
            alert("Invalid decade specified.");
            Backbone.history.navigate("", {
              trigger: true
            });
            return false;
          }
        }
      }
    };

    WMSRouter.prototype.after = {
      '^[0-9]{4}/wms': function(year) {
        if ((year != null) && (this.currStrategyView != null)) {
          this.themeNavToolbarView.render();
          this.yearNavView.render();
          this.currStrategyView.off();
          this.currStrategyView.on("table:startload", this.onTableStartLoad);
          this.currStrategyView.on("table:endload", this.onTableEndLoad);
          this.currStrategyView.on("table:nothingfound", this.onTableNothingFound);
          this.currStrategyView.on("table:fetcherror", this.onTableFetchError);
          this.currStrategyView.on("table:hoverwug", this.updateSelectedWug);
          this.currStrategyView.on("table:hovertype", this.highlightWugsByStrategyType);
          this.currStrategyView.render();
        }
      }
    };

    WMSRouter.prototype["default"] = function() {
      Backbone.history.navigate("#/" + namespace.currYear + "/wms", {
        trigger: true
      });
    };

    WMSRouter.prototype.wmsNetCountySupplies = function(year) {
      if (this.currStrategyView != null) {
        this.currStrategyView = this.currStrategyView.unrender();
      }
      this.currStrategyView = new CountyNetSupplyCollectionView({
        el: this.tableContainer
      });
      this.mapView.resetExtent();
      this.mapView.showWmsOverlayByViewType("Regions");
      this.areaSelectView.resetSelects();
    };

    WMSRouter.prototype.wmsRegion = function(year, regionLetter) {
      var region;
      region = namespace.regionNames.get(regionLetter);
      if (!(region != null)) {
        alert("Invalid region specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
        return;
      }
      this.currStrategyView = new RegionStrategyCollectionView({
        el: this.tableContainer,
        id: regionLetter
      });
      this.mapView.showWmsOverlayByViewType("Regions");
    };

    WMSRouter.prototype.wmsCounty = function(year, countyId) {
      var county, countyName;
      county = namespace.countyNames.get(countyId);
      if (!(county != null)) {
        alert("Invalid countyId specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
        return;
      }
      countyName = county.get('name');
      this.currStrategyView = new CountyStrategyCollectionView({
        el: this.tableContainer,
        id: countyId,
        name: countyName
      });
      this.mapView.showWmsOverlayByViewType("Counties");
    };

    WMSRouter.prototype.wmsHouseDistrict = function(year, districtId) {
      var district;
      district = namespace.houseNames.get(districtId);
      if (!(district != null)) {
        alert("Invalid districtId specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
        return;
      }
      this.currStrategyView = new LegeDistrictCollectionView({
        el: this.tableContainer,
        id: districtId,
        type: "house",
        name: district.get("name")
      });
      this.mapView.showWmsOverlayByViewType("HouseDistricts");
    };

    WMSRouter.prototype.wmsSenateDistrict = function(year, districtId) {
      var district;
      district = namespace.senateNames.get(districtId);
      if (!(district != null)) {
        alert("Invalid districtId specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
        return;
      }
      this.currStrategyView = new LegeDistrictCollectionView({
        el: this.tableContainer,
        id: districtId,
        type: "senate",
        name: district.get("name")
      });
      this.mapView.showWmsOverlayByViewType("SenateDistricts");
    };

    WMSRouter.prototype.wmsType = function(year, typeId) {
      var typeName, wmsType;
      wmsType = namespace.strategyTypes.get(typeId);
      if (!(wmsType != null)) {
        alert("Invalid typeId specified.");
        Backbone.history.navigate("", {
          trigger: true
        });
        return;
      }
      typeName = wmsType.get('name');
      this.currStrategyView = new StrategyTypeCollectionView({
        el: this.tableContainer,
        id: typeId,
        name: typeName
      });
      this.areaSelectView.resetSelects();
    };

    WMSRouter.prototype.wmsEntity = function(year, entityId) {
      this.currStrategyView = new EntityStrategyCollectionView({
        el: this.tableContainer,
        id: entityId
      });
      this.areaSelectView.resetSelects();
      this.mapView.showWmsOverlayByViewType("CountyNames");
    };

    WMSRouter.prototype.wmsProjectDetail = function(year, projectId) {
      this.currStrategyView = new StrategyDetailCollectionView({
        el: this.tableContainer,
        id: projectId
      });
      this.areaSelectView.resetSelects();
    };

    WMSRouter.prototype.wmsSource = function(year, sourceId) {
      this.currStrategyView = new SourceStrategyCollectionView({
        el: this.tableContainer,
        id: sourceId
      });
      this.areaSelectView.resetSelects();
      this.mapView.showWmsOverlayByViewType("CountyNames");
    };

    return WMSRouter;

  })(Backbone.Router);
});

// Generated by CoffeeScript 1.3.3
var BASE_CONTENT_PATH, BASE_PATH, console;

console = console || {};

console.log = console.log || function() {
  return null;
};

_.extend(_.templateSettings, {
  interpolate: /\{\{(.+?)\}\}/g
});

BASE_PATH = "/";

BASE_CONTENT_PATH = "/";

$(function() {
  var _this = this;
  BASE_PATH = $("#base_path").val();
  BASE_CONTENT_PATH = $("#base_content_path").val();
  require.config({
    baseUrl: "" + BASE_PATH + "Scripts/Compiled/backbone_app",
    paths: {
      "scripts": "../..",
      "templates": "../../templates"
    }
  });
  require(['namespace', 'WMSRouter'], function(namespace, WMSRouter) {
    var MyHistory;
    MyHistory = Backbone.History.extend({
      loadUrl: function() {
        var match;
        match = Backbone.History.prototype.loadUrl.apply(this, arguments);
        if (!match) {
          this.trigger('route-not-found');
        }
        return match;
      }
    });
    Backbone.history = new MyHistory();
    Backbone.history.on("route-not-found", function() {
      Backbone.history.navigate("", {
        trigger: true
      });
    });
    $('.tableLoading').show();
    namespace.bootstrapData().done(function() {
      var r;
      r = new WMSRouter();
      Backbone.history.start();
    }).fail(function() {
      alert("An error has occured.  Please reload this page or go back.");
      $('#errorMessage').show();
    }).always(function() {
      $('.tableLoading').hide();
    });
  });
});

define("main.js", function(){});
