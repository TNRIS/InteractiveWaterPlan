/*
  knockback-formatting.js 0.16.7
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/knockback/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
*/(function(){return function(e){return typeof define=="function"&&define.amd?define("knockback-formatting",["underscore","backbone","knockout","knockback"],e):e.call(this)}(function(){var e,t,n,r,i,s;return n=!this.kb&&typeof require!="undefined"?require("knockback"):this.kb,i=n._,e=n.Backbone,r=n.ko,this.Knockback=this.kb=n,typeof exports!="undefined"&&(module.exports=n),s=r.utils.unwrapObservable,t=Array.prototype.slice,n.toFormattedString=function(e){var n,r,i,o,u,a;u=e.slice(),r=t.call(arguments,1);for(i in r){n=r[i],a=s(n),a||(a=""),o=e.indexOf("{"+i+"}");while(o>=0)u=u.replace("{"+i+"}",a),o=e.indexOf("{"+i+"}",o+1)}return u},n.parseFormattedString=function(e,t){var n,r,s,o,u,a,f,l,c,h,p,d,v;h=t.slice(),s=0,a=0,l={};while(h.search("\\{"+s+"\\}")>=0){f=t.indexOf("{"+s+"}");while(f>=0)h=h.replace("{"+s+"}","(.*)"),l[f]=s,a++,f=t.indexOf("{"+s+"}",f+1);s++}n=s,c=new RegExp(h),u=c.exec(e),u&&u.shift();if(!u||u.length!==a){p=[];while(n-->0)p.push("");return p}v=i.sortBy(i.keys(l),function(e,t){return parseInt(e,10)}),r={};for(o in v){f=v[o],s=l[f];if(r.hasOwnProperty(s))continue;r[s]=o}d=[],s=0;while(s<n)d.push(u[r[s]]),s++;return d},n.FormattedObservable=function(){function e(e,o){var u,a;return i.isArray(o)?(e=e,a=o):a=t.call(arguments,1),u=n.utils.wrappedObservable(this,r.dependentObservable({read:function(){var t,r,i;o=[s(e)];for(r=0,i=a.length;r<i;r++)t=a[r],o.push(s(t));return n.toFormattedString.apply(null,o)},write:function(t){var r,i,o;i=n.parseFormattedString(t,s(e)),o=Math.min(a.length,i.length),r=0;while(r<o)a[r](i[r]),r++}})),u}return e.prototype.destroy=function(){return n.utils.wrappedDestroy(this)},e}(),n.formattedObservable=function(e,r){return new n.FormattedObservable(e,t.call(arguments,1))},n})}).call(this);