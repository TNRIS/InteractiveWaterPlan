/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/WugFeatureCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(Backbone.Collection)}),define("namespace",["collections/WugFeatureCollection"],function(e){var t;return t={},t.wugFeatureCollection=new e,t.VALID_YEARS=["2010","2020","2030","2040","2050","2060"],t.currYear="2010",t}),define("config/WmsThemeConfig",[],function(){var e;return e={Layers:[{name:"Regional Water Planning Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"Regions",service_params:{layers:"4,7",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!0,opacity:.6}},{name:"Texas Counties",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"Counties",service_params:{layers:"1,13",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas Senate Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"SenateDistricts",service_params:{layers:"3,9",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas House Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"HouseDistricts",service_params:{layers:"2,11",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Water System Service Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/SWP_Boundaries/MapServer/WMSServer",service_params:{layers:"0",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}}]},e});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapView",["namespace","config/WmsThemeConfig"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.origCenter=(new OpenLayers.LonLat(-99.294317,31.348335)).transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:3857")),r.prototype.origZoom=5,r.prototype.map=null,r.prototype.bingApiKey="",r.prototype.baseLayers=["esri_gray","mapquest_open","mapquest_aerial","bing_road","bing_hybrid","bing_aerial"],r.prototype.MAX_WUG_RADIUS=18,r.prototype.MIN_WUG_RADIUS=6,r.prototype.initialize=function(t){return this.$el=$("#"+t.mapContainerId),this.el=this.$el[0],this.bingApiKey=t.bingApiKey,_.bindAll(this,"render","unrender","resetExtent","showPlaceFeature","transformToWebMerc","resetWugFeatures","clearWugFeatures","selectWugFeature","unselectWugFeatures","_setupWugHighlightControl","_setupOverlayLayers","showWmsOverlayByViewType","hideWmsOverlays","showMapLoading","hideMapLoading","_setupWugClickControl","highlightStratTypeWugs","unhighlightStratTypeWugs"),e.wugFeatureCollection.on("reset",this.resetWugFeatures),null},r.prototype.render=function(){return this.$el.empty(),this.map=new OpenLayers.Map({div:this.$el[0],projection:new OpenLayers.Projection("EPSG:3857"),displayProjection:new OpenLayers.Projection("EPSG:4326"),layers:this._setupBaseLayers(this.baseLayers),center:this.origCenter,zoom:this.origZoom,eventListeners:{}}),this._setupOverlayLayers(),this.map.addControl(new OpenLayers.Control.LayerSwitcher),this},r.prototype.unrender=function(){return this.$el.remove(),null},r.prototype.resetWugFeatures=function(e){var t,n,r,i,s,o,u,a,f,l;this.clearWugFeatures();if(e.models.length<1)return;this.wugLayer=new OpenLayers.Layer.Vector("Water User Groups",{styleMap:this._wugStyleMap,displayInLayerSwitcher:!1}),o=new OpenLayers.Format.WKT,r=e.max(function(e){return e.get("totalSupply")}).get("totalSupply"),i=e.min(function(e){return e.get("totalSupply")}).get("totalSupply"),t=null,u=[],l=e.models;for(a=0,f=l.length;a<f;a++)n=l[a],s=o.read(n.get("wktGeog")),s.attributes=n.attributes,s.size=this._calculateScaledValue(r,i,this.MAX_WUG_RADIUS,this.MIN_WUG_RADIUS,n.get("totalSupply")),delete s.attributes.wktGeog,s.geometry=s.geometry.transform(this.map.displayProjection,this.map.projection),t==null?t=s.geometry.getBounds().clone():t.extend(s.geometry.getBounds()),u.push(s);this.wugLayer.addFeatures(u),this.map.addLayer(this.wugLayer),this.wugHighlightControl=this._setupWugHighlightControl(),this.map.addControl(this.wugHighlightControl),this.wugClickControl=this._setupWugClickControl(),this.map.addControl(this.wugClickControl),this.map.zoomToExtent(t)},r.prototype.clearWugFeatures=function(){this.unselectWugFeatures(),this.wugHighlightControl!=null&&(this.wugHighlightControl.destroy(),this.wugHighlightControl=null),this.wugClickControl!=null&&(this.wugClickControl.destroy(),this.wugClickControl=null),this.wugLayer!=null&&this.wugLayer.destroy()},r.prototype.selectWugFeature=function(e,t){var n,r,i,s;if(this.wugHighlightControl==null)return;s=this.wugLayer.features;for(r=0,i=s.length;r<i;r++){n=s[r];if(n.attributes.entityId===e){this.wugHighlightControl.select(n);return}}},r.prototype.unselectWugFeatures=function(){if(this.wugHighlightControl==null||this.wugHighlightControl.layer.selectedFeatures==null)return;this.wugHighlightControl.unselectAll()},r.prototype.hideWmsOverlays=function(){var e,t,n,r;r=this.map.layers;for(t=0,n=r.length;t<n;t++)e=r[t],e.isBaseLayer||e.setVisibility(!1)},r.prototype.showWmsOverlayByViewType=function(e){var t,n,r,i;i=this.map.getLayersBy("viewType",e);for(n=0,r=i.length;n<r;n++)t=i[n],t.setVisibility(!0)},r.prototype.highlightStratTypeWugs=function(e){var t,n,r,i;if(!this.wugLayer)return;i=this.wugLayer.features;for(n=0,r=i.length;n<r;n++)t=i[n],t.attributes.strategyTypes!=null&&_.contains(t.attributes.strategyTypes,e)?t.renderIntent="typehighlight":t.renderIntent="transparent";this.wugLayer.redraw()},r.prototype.unhighlightStratTypeWugs=function(){var e,t,n,r;if(!this.wugLayer)return;r=this.wugLayer.features;for(t=0,n=r.length;t<n;t++)e=r[t],e.renderIntent="default";this.wugLayer.redraw()},r.prototype._setupOverlayLayers=function(){var e,n,r,i,s;s=t.Layers;for(r=0,i=s.length;r<i;r++){e=s[r];switch(e.type){case"WMS":n=new OpenLayers.Layer.WMS(e.name,e.url,e.service_params,e.layer_params),n.viewType=e.viewType,this.map.addLayer(n);break;default:throw"Unsupported Layer Type"}}},r.prototype._setupWugClickControl=function(){var t,n=this;return t=new OpenLayers.Control.SelectFeature(this.wugLayer,{autoActivate:!0,clickFeature:function(t){var n;if(t.attributes.type!=null&&t.attributes.type==="WWP")return;n=t.attributes.entityId,Backbone.history.navigate("#/"+e.currYear+"/wms/entity/"+n,{trigger:!0})}}),t},r.prototype._setupWugHighlightControl=function(){var t,n,r=this;return n=null,t=new OpenLayers.Control.SelectFeature(this.wugLayer,{multiple:!1,hover:!0,autoActivate:!0,overFeature:function(e){var t,r=this;t=e.layer,this.hover&&(this.highlightOnly?this.highlight(e):OpenLayers.Util.indexOf(t.selectedFeatures,e)===-1&&(n=_.delay(function(){return r.select(e)},400)))},onSelect:function(t){var n;n=new OpenLayers.Popup.FramedCloud("wugpopup",t.geometry.getBounds().getCenterLonLat(),null,"                                <b>"+t.attributes.name+"</b><br/>                                Total "+e.currYear+" Supply: "+$.number(t.attributes.totalSupply)+" ac-ft/yr                            ",null,!1),n.autoSize=!0,t.popup=n,r.map.addPopup(n)},onUnselect:function(e){clearTimeout(n),e.popup!=null&&(r.map.removePopup(e.popup),e.popup.destroy(),e.popup=null)}}),t},r.prototype._calculateScaledValue=function(e,t,n,r,i){var s;return e===t?r:(s=(n-r)*(i-t)/(e-t)+r,s)},r.prototype.resetExtent=function(){var e;e=this.origZoom,this.map.baseLayer instanceof OpenLayers.Layer.Bing&&(e=this.origZoom-1),this.map.setCenter(this.origCenter,e)},r.prototype.showPlaceFeature=function(e){var t,n,r;r=new OpenLayers.Format.WKT,n=r.read(e.get("wktGeog")),this.transformToWebMerc(n.geometry),t=n.geometry.getBounds(),this.map.zoomToExtent(t)},r.prototype.transformToWebMerc=function(e){return e.transform(this.map.displayProjection,this.map.projection)},r.prototype.showMapLoading=function(){this.$loadingOverlay==null&&(this.$loadingOverlay=$("<div></div>"),this.$loadingOverlay.height(this.$el.height()).width(this.$el.width()),this.$loadingOverlay.addClass("mapLoadingOverlay"),this.$el.prepend(this.$loadingOverlay))},r.prototype.hideMapLoading=function(){this.$loadingOverlay!=null&&(this.$loadingOverlay.remove(),this.$loadingOverlay=null)},r.prototype._setupBaseLayers=function(e){var t,n,r,i;n=[];if(e==null||e.length===0)throw new Error("Must specify baseLayers.");for(r=0,i=e.length;r<i;r++){t=e[r];switch(t){case"mapquest_open":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Street",["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png"],{attribution:"Tiles courtesy <a href='http://www.mapquest.com/' target='_blank'>MapQuest</a>",transitionEffect:"resize",isBaseLayer:!0}));break;case"mapquest_aerial":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Aerial",["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png"],{attribution:"Tiles courtesy <a href='http://www.mapquest.com/' target='_blank'>MapQuest</a>",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_road":n.push(new OpenLayers.Layer.Bing({name:"Bing Road",key:this.bingApiKey,type:"Road",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_hybrid":n.push(new OpenLayers.Layer.Bing({name:"Bing Hybrid",key:this.bingApiKey,type:"AerialWithLabels",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_aerial":n.push(new OpenLayers.Layer.Bing({name:"Bing Aerial",key:this.bingApiKey,type:"Aerial",transitionEffect:"resize",isBaseLayer:!0}));break;case"esri_gray":n.push(new OpenLayers.Layer.XYZ("ESRI Gray",["http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/${z}/${y}/${x}"],{attribution:"Tiles courtesy <a href='http://www.esri.com' target='_blank'>esri</a>",isBaseLayer:!0}));break;case"stamen_toner":n.push(new OpenLayers.Layer.Stamen("toner-lite","Stamen Toner"));break;case"stamen_watercolor":n.push(new OpenLayers.Layer.Stamen("watercolor","Stamen Watercolor"))}}return n},r.prototype._wugStyleMap=new OpenLayers.StyleMap({"default":new OpenLayers.Style({pointRadius:"${getPointRadius}",strokeColor:"yellow",strokeWidth:1,fillColor:"${getFillColor}",fillOpacity:.8},{context:{getPointRadius:function(e){return e.size!=null?e.size:6},getFillColor:function(e){return e.attributes.type!=null&&e.attributes.type==="WWP"?"gray":"green"}},rules:[new OpenLayers.Rule({maxScaleDenominator:866688,symbolizer:{fontSize:"11px",labelAlign:"cb",labelOutlineColor:"yellow",labelOutlineWidth:2,labelYOffset:8,label:"${name}"}}),new OpenLayers.Rule({minScaleDenominator:866688,symbolizer:{}})]}),select:new OpenLayers.Style({fillColor:"yellow",strokeColor:"green",fillOpacity:1}),typehighlight:new OpenLayers.Style({fillColor:"blue",fillOpacity:.8,strokeColor:"yellow"}),transparent:new OpenLayers.Style({fillOpacity:0,strokeOpacity:0})}),r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/StrategyTypeCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/strategy/types",t}(Backbone.Collection)}),define("scripts/text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("scripts/text!templates/strategyTypeListItem.html",[],function(){return'<li>\r\n    <a href="#/{{currYear}}/wms/type/{{m.id}}">\r\n        {{m.name}}\r\n    </a>\r\n</li>'}),define("scripts/text!templates/themeNav.html",[],function(){return'<ul class="nav nav-pills" id="themeNav">\r\n    <li class="nav-label">THEME:</li>\r\n    <li class="dropdown">\r\n        <a class="dropdown-toggle" data-toggle="dropdown" href="#">\r\n            <span>Water Management Strategies</span>\r\n            <b class="caret"></b>\r\n        </a>\r\n        <ul class="dropdown-menu" id="strategyTypeList">\r\n            <li>\r\n                <a href="#/{{currYear}}/wms">\r\n                    NET COUNTY SUPPLIES\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li class="disabled"><a href="#">Water Use</a></li>\r\n    <li class="disabled"><a href="#">Sources</a></li>\r\n</ul>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/ThemeNavToolbarView",["namespace","collections/StrategyTypeCollection","scripts/text!templates/strategyTypeListItem.html","scripts/text!templates/themeNav.html"],function(e,t,n,r){var i;return i=function(i){function s(){return s.__super__.constructor.apply(this,arguments)}return __extends(s,i),s.prototype.template=_.template(r),s.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","renderStrategyTypeList","enableStrategyTypeList","disableStrategyTypeList"),null},s.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template({currYear:e.currYear})),ko.applyBindings(this,this.el),this.renderStrategyTypeList(),this},s.prototype.renderStrategyTypeList=function(){var r,i,s=this;r=_.template(n),i=new t,i.fetch({success:function(t){var n,i,o,u,a;a=t.models;for(o=0,u=a.length;o<u;o++)i=a[o],n=s.$("#strategyTypeList").append(r({m:i.toJSON(),currYear:e.currYear}))}})},s.prototype.disableStrategyTypeList=function(){this.$(".dropdown-toggle").attr("data-toggle",null).parent("li").addClass("disabled").on("click.me",function(e){e.preventDefault()})},s.prototype.enableStrategyTypeList=function(){this.$(".dropdown-toggle").attr("data-toggle","dropdown").parent("li").removeClass("disabled").off("click.me")},s.prototype.unrender=function(){return this.$el.remove(),null},s}(Backbone.View)}),define("scripts/text!templates/yearNav.html",[],function(){return'<ul class="nav nav-pills" id="yearNav">\r\n    <li class="nav-label">DECADE:</li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2010">2010</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2020">2020</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2030">2030</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2040">2040</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2050">2050</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2060">2060</a></li>\r\n</ul>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/YearNavView",["namespace","scripts/text!templates/yearNav.html"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.template=_.template(t),r.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","changeYear","disableYearButtons","enableYearButtons"),null},r.prototype.render=function(){return this.$el.empty(),this.currentYear=ko.observable(e.currYear),this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("a[data-value='"+e.currYear+"']").parent().addClass("active"),this},r.prototype.disableYearButtons=function(){this.$("a").parents("li").addClass("disabled")},r.prototype.enableYearButtons=function(){this.$("a").parents("li").removeClass("disabled")},r.prototype.unrender=function(){return kb.release(this),this.$el.remove(),null},r.prototype.changeYear=function(e,t){var n,r;return n=$(t.target),r=n.attr("data-value"),this.trigger("changeyear",r),n.parent().siblings().removeClass("active"),n.parent().addClass("active"),null},r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("models/PlaceFeatureModel",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/place/feature/hull",t}(Backbone.Model)}),define("scripts/text!templates/mapBottomRightTools.html",[],function(){return'<div class="pull-right">\r\n\r\n    <div class="input-append map-stuff">\r\n        <input id="goToPlaceInput" type="text" placeholder="Go to Location" />\r\n        <button class="btn btn-primary" type="button" data-loading-text="...">Go</button>\r\n    </div>\r\n\r\n</div>\r\n\r\n<div class="pull-right">\r\n    <button class="btn" type="button" data-bind="click: toggleAreaSelects" data-toggle="#areaSelectContainer" data-title-orig="Select Strategies by Area">\r\n        <span class="title">Hide Area Selection</span> <i class="icon-caret-up"></i>\r\n    </button>\r\n    &nbsp;\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapBottomToolbarView",["models/PlaceFeatureModel","scripts/text!templates/mapBottomRightTools.html"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.template=_.template(t),r.prototype.mapView=null,r.prototype.initialize=function(e){_.bindAll(this,"render","unrender","showPlaceFeature"),this.mapView=e.mapView},r.prototype.render=function(){return this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("#goToPlaceInput").place_typeahead({minLength:2,source:function(e,t){return this.$element.data("selected-place-id",null),$.get(""+BASE_API_PATH+"api/place",{name:e},function(e){return t(e)})},buttonClick:this.showPlaceFeature}),this},r.prototype.unrender=function(){return this.$el.remove(),null},r.prototype.toggleAreaSelects=function(e,t){var n,r;n=$(t.delegateTarget),r=n.data("toggle"),$(r).slideToggle(300,function(){var e,t;return e=$("i",n),e.hasClass("icon-caret-up")?(e.removeClass("icon-caret-up"),e.addClass("icon-caret-down")):(e.addClass("icon-caret-up"),e.removeClass("icon-caret-down")),t=$(".title",n).html(),$(".title",n).html(n.attr("data-title-orig")),n.attr("data-title-orig",t)})},r.prototype.showPlaceFeature=function(){var t,n,r=this;n=this.$("#goToPlaceInput").data("selected-place-id"),t=new e,t.fetch({data:{placeId:n},success:function(e){return r.mapView.showPlaceFeature(e)}})},r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseTableCollectionView",["namespace"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.initialize=function(t,n,r,i){return _.bindAll(this,"render","unrender","fetchCollection","appendModel","hideLoading","showLoading","fetchCallback","_setupDataTable","_connectTableRowsToWugFeatures","showNothingFound","hideNothingFound"),i=i||{},this.fetchParams=i.fetchParams||{},this.currYear=ko.observable(e.currYear),this.template=_.template(r),this.collection=new n,this.ModelView=t,null},n.prototype.render=function(){return this.$el.html(this.template()),this.fetchCollection(),ko.applyBindings(this,this.el),this.$(".has-popover").popover({trigger:"hover",placement:"top"}),this},n.prototype.unrender=function(){return this.$el.html(),null},n.prototype.fetchCollection=function(){var t,n=this;this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),this.collection.fetch({data:t,success:function(e){var t,r,i,s;if(e.models.length===0)n.trigger("table:nothingfound");else{s=e.models;for(r=0,i=s.length;r<i;r++)t=s[r],n.appendModel(t);n.$(".has-popover").popover({trigger:"hover"}),n._setupDataTable(),n._connectTableRowsToWugFeatures(),n.fetchCallback!=null&&_.isFunction(n.fetchCallback)&&n.fetchCallback(e.models),n.trigger("table:endload")}},error:function(){n.trigger("table:fetcherror")}})},n.prototype.fetchCallback=function(t){var n,r;n=_.groupBy(t,function(e){return e.get("recipientEntityId")}),r=_.map(n,function(t){var n;return n=_.reduce(t,function(t,n){return t.entityId=n.get("recipientEntityId"),t.name=n.get("recipientEntityName"),t.wktGeog=n.get("recipientEntityWktGeog"),t.type=n.get("recipientEntityType"),t.strategyTypes.push(n.get("typeId")),t.totalSupply+=n.get("supply"+e.currYear),t},{totalSupply:0,strategyTypes:[]}),n.strategyTypes=_.uniq(n.strategyTypes),n}),r.sort(function(e,t){return e.type==="WWP"?-1:t.type==="WWP"?1:t.totalSupply-e.totalSupply}),e.wugFeatureCollection.reset(r)},n.prototype._mapStrategyModelToWugFeature=function(t){return{entityId:t.get("recipientEntityId"),name:t.get("recipientEntityName"),wktGeog:t.get("recipientEntityWktGeog"),totalSupply:t.get("supply"+e.currYear),type:t.get("recipientEntityType"),stratTypeId:t.get("typeId")}},n.prototype._setupDataTable=function(){var e,t;e=this.$("table"),t=[],$("th",e).each(function(e,n){var r;return r=$(n),r.attr("data-sort")!=null?t.push({sType:$(n).attr("data-sort")}):t.push(null)}),e.dataTable({bDestroy:!0,sPaginationType:"bootstrap",aLengthMenu:[[10,25,50,100,99999],[10,25,50,100,"All"]],aoColumns:t})},n.prototype._connectTableRowsToWugFeatures=function(){var e;e=this,this.$("table tbody").delegate("td.strategyType","hover",function(t){var n;t.type==="mouseenter"?(n=parseInt($(this).attr("data-type-id")),e.trigger("table:hovertype",n)):e.trigger("table:hovertype",null)}),this.$("table tbody").delegate("tr","hover",function(t){var n,r;t.type==="mouseenter"?(n=$(this),r=parseInt(n.attr("data-entity-id")),e.trigger("table:hoverwug",r)):e.trigger("table:hoverwug",null)})},n.prototype.appendModel=function(t){var n;n=new this.ModelView({model:t,currYear:e.currYear}),this.$("tbody").append(n.render().el)},n.prototype.showNothingFound=function(){$("#nothingFoundMessage").fadeIn(),this.$el.hide()},n.prototype.hideNothingFound=function(){$("#nothingFoundMessage").hide()},n.prototype.showLoading=function(){this.$el.hide(),this.hideNothingFound(),$(".tableLoading").show()},n.prototype.hideLoading=function(){$(".tableLoading").hide(),this.$el.fadeIn()},n}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseSelectableRegionTableView",["namespace","views/BaseTableCollectionView"],function(e,t){var n;return n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.initialize=function(e,t,r,i,s){var o;n.__super__.initialize.call(this,e,t,r,s),_.bindAll(this,"onRegionCollectionSuccess"),this.mapView=i,o=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/boundary/regions/all"}),this.regionCollection=new o},n.prototype.unrender=function(){return this.regionHighlightControl!=null&&this.regionHighlightControl.destroy(),this.regionClickControl!=null&&this.regionClickControl.destroy(),this.regionLayer!=null&&this.regionLayer.destroy(),n.__super__.unrender.apply(this,arguments)},n.prototype.fetchCollection=function(){var t,n=this;this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),this.collection.fetch({data:t,success:function(e){var t,r,i,s;if(e.models.length===0)n.trigger("table:nothingfound");else{s=e.models;for(r=0,i=s.length;r<i;r++)t=s[r],n.appendModel(t);n.$(".has-popover").popover({trigger:"hover"}),n._setupDataTable(),n.trigger("table:endload")}},error:function(){n.trigger("table:fetcherror")}}),this.regionCollection.fetch({success:this.onRegionCollectionSuccess})},n.prototype.onRegionCollectionSuccess=function(t){var n,r,i,s,o,u,a;s=new OpenLayers.Format.WKT,i=[],a=t.models;for(o=0,u=a.length;o<u;o++)r=a[o],n=s.read(r.get("wktGeog")),n.attributes=r.attributes,delete n.attributes.wktGeog,n.geometry=this.mapView.transformToWebMerc(n.geometry),i.push(n);this.regionLayer=new OpenLayers.Layer.Vector("Region Feature Layer",{displayInLayerSwitcher:!1,styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"gray",strokeWidth:0,fillColor:"white",fillOpacity:0}),select:new OpenLayers.Style({fillColor:"yellow",strokeColor:"orange",strokeWidth:2,fillOpacity:.2})})}),this.regionLayer.addFeatures(i),this.mapView.map.addLayer(this.regionLayer),this.regionHighlightControl=new OpenLayers.Control.SelectFeature(this.regionLayer,{autoActivate:!0,hover:!0}),this.mapView.map.addControl(this.regionHighlightControl),this.regionHighlightControl.handlers.feature.stopDown=!1,this.regionClickControl=new OpenLayers.Control.SelectFeature(this.regionLayer,{autoActivate:!0,clickFeature:function(t){var n;n=t.attributes.letter,Backbone.history.navigate("#/"+e.currYear+"/wms/region/"+n,{trigger:!0})}}),this.mapView.map.addControl(this.regionClickControl),this.regionClickControl.handlers.feature.stopDown=!1},n}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseStrategyView",["namespace"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.tagName="tr",n.prototype.initialize=function(e){if(this.template==null&&e.template==null)throw"Must specify template";return e.template!=null&&(this.template=e.template),n.__super__.initialize.call(this,e),_.bindAll(this,"render","unrender"),this.template=_.template(this.template),null},n.prototype.render=function(){return this.$el.html(this.template({m:this.model.toJSON(),currYear:e.currYear})),this.$el.attr("data-entity-id",this.model.get("recipientEntityId")),this},n.prototype.unrender=function(){return this.$el.remove(),null},n}(Backbone.View)}),define("scripts/text!templates/countyNetSupplyRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/county/{{m.countyId}}">\r\n        {{m.countyName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m.netMunicipal) }}</td>\r\n<td>{{ $.number(m.netIrrigation) }}</td>\r\n<td>{{ $.number(m.netManufacturing) }}</td>\r\n<td>{{ $.number(m.netLivestock) }}</td>\r\n<td>{{ $.number(m.netSteamElectric) }}</td>\r\n<td>{{ $.number(m.netMining) }}</td>\r\n<td><b>{{ $.number(m.netSupplyTotal) }}</b></td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyView",["namespace","views/BaseStrategyView","scripts/text!templates/countyNetSupplyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyNetSupplyCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/supply/county-net",t}(Backbone.Collection)}),define("scripts/text!templates/countyNetSupplyTable.html",[],function(){return'<h2>Net Supplies to Counties from Recommended Water Management Strategies - <span data-bind="text: currYear"></span></h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                County\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Municipal supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Municipal\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Irrigation supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Irrigation\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Manufacturing supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Manufacturing\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Livestock supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Livestock\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Steam-Electric Power supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Steam-Electric Power\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Mining supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Mining\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    TOTAL\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyCollectionView",["namespace","views/BaseSelectableRegionTableView","views/CountyNetSupplyView","collections/CountyNetSupplyCollection","scripts/text!templates/countyNetSupplyTable.html"],function(e,t,n,r,i){var s;return s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){t.__super__.initialize.call(this,n,r,i,e.mapView)},t}(t)}),define("scripts/text!templates/regionStrategyRow.html",[],function(){return'\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/RegionStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/regionStrategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/regionStrategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies in <span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/RegionStrategyCollectionView",["namespace","views/BaseSelectableRegionTableView","views/RegionStrategyView","scripts/text!templates/regionStrategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.regionLetter=e.id,this.viewName=ko.observable("Region "+this.regionLetter),s={regionLetter:this.regionLetter},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/region"}),t.__super__.initialize.call(this,n,i,r,e.mapView,{fetchParams:s}),null},t.prototype.onRegionCollectionSuccess=function(e){var n,r,i=this;t.__super__.onRegionCollectionSuccess.call(this,e),r=_.find(this.regionLayer.features,function(e){return e.attributes.letter===i.regionLetter}),this.regionHighlightControl.select(r),n=r.geometry.getBounds(),this.mapView.map.zoomToExtent(n)},t}(t)}),define("scripts/text!templates/countyStrategyRow.html",[],function(){return'\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/countyStrategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/countyStrategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies in <span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyStrategyCollectionView",["namespace","views/BaseTableCollectionView","views/CountyStrategyView","scripts/text!templates/countyStrategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.countyId=e.id,this.countyName=e.name,this.viewName=ko.observable(""+this.countyName+" County"),s={countyId:this.countyId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/county"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/strategyRow.html",[],function(){return'\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies in <span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/LegeDistrictCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyView","scripts/text!templates/strategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;if(e.type==null||!e.type==="house"||!e.type==="senate")throw"Options.type myst be 'house' or 'senate'.";return this.districtType=e.type,this.districtId=e.id,this.districtName=e.name,this.viewName=ko.observable(""+this.districtName),s={districtId:this.districtId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/district/"+this.districtType}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/strategyTypeRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyTypeRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyTypeTable.html",[],function(){return'<h2>\r\n   <span data-bind="text: viewName"></span> STRATEGIES - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyTypeView","scripts/text!templates/strategyTypeTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.typeId=e.id,this.typeName=e.name,this.viewName=ko.observable(""+this.typeName),s={typeId:this.typeId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/type"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/entityStrategyRow.html",[],function(){return'\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n\r\n<td>{{m.sourceName}}</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/entityStrategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/entityStrategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies for \r\n    <span data-bind="text: viewName"></span> <i class="wugIcon icon-circle icon-large"></i> - \r\n    <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyCollectionView",["namespace","views/BaseTableCollectionView","views/EntityStrategyView","scripts/text!templates/entityStrategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return _.bindAll(this,"fetchCallback"),this.entityId=e.id,this.viewName=ko.observable(),s={entityId:this.entityId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/entity"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t.prototype.fetchCallback=function(e){this.viewName(e[0].get("recipientEntityName")),t.__super__.fetchCallback.call(this,e)},t}(t)}),define("scripts/text!templates/strategyDetailRow.html",[],function(){return'<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="strategyType" data-type-id="{{m.typeId}}">   \r\n    {{m.typeName}}\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyDetailView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyDetailRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyDetailTable.html",[],function(){return'<h2>\r\n    <span data-bind="text: viewName"></span> - \r\n    <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Type of the recommended Water Management Strategy. Hover over a type name to view only Water User Groups with Water Management Strategies of that type.">\r\n                    Type\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n             <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyDetailCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyDetailView","scripts/text!templates/strategyDetailTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return _.bindAll(this,"fetchCallback"),this.projectId=e.id,this.viewName=ko.observable(),s={projectId:this.projectId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/project"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t.prototype.fetchCallback=function(e){e.length<!0&&(alert("Invalid projectId specified."),Backbone.history.navigate("",{trigger:!0})),this.viewName(e[0].get("description")),t.__super__.fetchCallback.call(this,e)},t}(t)}),define("scripts/text!templates/wmsAreaSelect.html",[],function(){return'<div class="span12">\r\n    <div class="row">\r\n        <div class="span12">\r\n            <p>Select an area from the following dropdowns to view all recommended strategies in that area.</p>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="span3" id="regionSelectContainer"></div>\r\n        <div class="span3" id="countySelectContainer"></div>\r\n        <div class="span3" id="houseSelectContainer"></div>\r\n        <div class="span3" id="senateSelectContainer"></div>\r\n    </div>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/WmsAreaSelectView",["namespace","scripts/text!templates/wmsAreaSelect.html"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.template=_.template(t),r.prototype.initialize=function(t){_.bindAll(this,"render","unrender","_createRegionSelect","_createCountySelect","_createHouseSelect","_createSenateSelect","enableSelects","disableSelects","resetSelects");if(e.countyNames==null||e.regionNames==null||e.houseNames==null||e.senateNames==null)throw"Must specify namespace.counties, namespace.regions, namespace.house,and namespace.senate"},r.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template()),this.selects={},this.selects.region=this._createRegionSelect().chosen(),this.selects.county=this._createCountySelect().chosen(),this.selects.house=this._createHouseSelect().chosen(),this.selects.senate=this._createSenateSelect().chosen(),this},r.prototype.resetSelects=function(e){var t;for(t in this.selects)t!==e&&this.selects[t].val("-1").trigger("liszt:updated")},r.prototype.disableSelects=function(){var e;for(e in this.selects)this.selects[e].attr("disabled",!0).trigger("liszt:updated")},r.prototype.enableSelects=function(){var e;for(e in this.selects)this.selects[e].attr("disabled",null).trigger("liszt:updated")},r.prototype._createRegionSelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a Region</option>")),u=e.regionNames.models;for(s=0,o=u.length;s<o;s++)i=u[s],r=$("<option value='"+i.get("letter")+"'>Region "+i.get("letter")+"</option>"),t.append(r);return this.$("#regionSelectContainer").append(t),n=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/region/"+t.val(),{trigger:!0}),n.resetSelects("region")}),t},r.prototype._createCountySelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a County</option>")),u=e.countyNames.models;for(s=0,o=u.length;s<o;s++)n=u[s],i=$("<option value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);return this.$("#countySelectContainer").append(t),r=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/county/"+t.val(),{trigger:!0}),r.resetSelects("county")}),t},r.prototype._createHouseSelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a State House District</option>")),u=e.houseNames.models;for(s=0,o=u.length;s<o;s++)n=u[s],i=$("<option value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);return this.$("#houseSelectContainer").append(t),r=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/house/"+t.val(),{trigger:!0}),r.resetSelects("house")}),t},r.prototype._createSenateSelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a State Senate District</option>")),u=e.senateNames.models;for(s=0,o=u.length;s<o;s++)n=u[s],i=$("<option value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);return this.$("#senateSelectContainer").append(t),r=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/senate/"+t.val(),{trigger:!0}),r.resetSelects("senate")}),t},r.prototype.unrender=function(){return this.$el.remove(),null},r}(Backbone.View)}),define("scripts/text!templates/mapTopButtons.html",[],function(){return'<div class="pull-right">\r\n    <a class="btn map-stuff" data-bind="click: zoomToTexas">\r\n        Zoom to Texas\r\n    </a>\r\n    \r\n    <a class="btn" id="toggleMapBtn" data-bind="click: toggleMap">\r\n        Hide Map\r\n    </a>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapTopButtonsView",["scripts/text!templates/mapTopButtons.html"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.template=_.template(e),n.prototype.initialize=function(e){_.bindAll(this,"render","unrender","zoomToTexas","toggleMap");if(e.mapView==null)throw"options.mapView not defined";return this.mapView=e.mapView,null},n.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template()),ko.applyBindings(this,this.el),this},n.prototype.unrender=function(){return this.$el.remove(),null},n.prototype.zoomToTexas=function(){this.mapView.resetExtent()},n.prototype.toggleMap=function(e,t){var n;n=$(t.target),n.hasClass("off")?(n.html("Hide Map"),$("#mapContainer").slideDown(),$(".map-stuff").show(),n.removeClass("off")):(n.addClass("off"),$("#mapContainer").slideUp(),$(".map-stuff").hide(),n.html("Show Map"))},n}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/counties/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/RegionCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/regions/names",t.prototype.model=Backbone.Model.extend({idAttribute:"letter"}),t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/HouseCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/districts/house/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/SenateCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/districts/senate/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("WMSRouter",["namespace","views/MapView","views/ThemeNavToolbarView","views/YearNavView","views/MapBottomToolbarView","views/CountyNetSupplyCollectionView","views/RegionStrategyCollectionView","views/CountyStrategyCollectionView","views/LegeDistrictCollectionView","views/StrategyTypeCollectionView","views/EntityStrategyCollectionView","views/StrategyDetailCollectionView","views/WmsAreaSelectView","views/MapTopButtonsView","collections/StrategyTypeCollection","collections/CountyCollection","collections/RegionCollection","collections/HouseCollection","collections/SenateCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b;return b=function(b){function w(){return w.__super__.constructor.apply(this,arguments)}return __extends(w,b),w.prototype.initialize=function(s){_.bindAll(this,"updateViewsToNewYear","updateSelectedWug","onTableStartLoad","onTableEndLoad","onTableNothingFound","onTableFetchError","highlightWugsByStrategyType"),this.currTableView=null,this.tableContainer=$("#tableContainer")[0],this.mapView=new t({mapContainerId:"mapContainer",bingApiKey:$("#bing_maps_key").val()}),this.mapView.render(),this.mapBottomToolbarView=new i({el:$("#mapBottomToolsContainer")[0],mapView:this.mapView}),this.mapBottomToolbarView.render(),this.themeNavToolbarView=new n({el:$("#themeNavContainer")[0]}),this.mapTopButtonsView=new p({el:$("#mapTopButtonsContainer")[0],mapView:this.mapView}),this.mapTopButtonsView.render(),this.yearNavView=new r({el:$("#yearNavContainer")[0]}),this.yearNavView.on("changeyear",this.updateViewsToNewYear),e.strategyTypes=new d,e.strategyTypes.reset(initStrategyTypes),e.countyNames=new v,e.countyNames.reset(initCountyNames),e.regionNames=new m,e.regionNames.reset(initRegionNames),e.houseNames=new g,e.houseNames.reset(initHouseNames),e.senateNames=new y,e.senateNames.reset(initSenateNames),this.areaSelectView=new h({el:$("#areaSelectContainer")[0]}),this.areaSelectView.render()},w.prototype.routes={"":"default",":year/wms":"wmsNetCountySupplies",":year/wms/region/:regionLetter":"wmsRegion",":year/wms/county/:countyId":"wmsCounty",":year/wms/house/:districtId":"wmsHouseDistrict",":year/wms/senate/:districtId":"wmsSenateDistrict",":year/wms/type/:typeId":"wmsType",":year/wms/entity/:entityId":"wmsEntity",":year/wms/project/:projectId":"wmsProjectDetail"},w.prototype.onTableStartLoad=function(){this.areaSelectView.disableSelects(),this.yearNavView.disableYearButtons(),this.themeNavToolbarView.disableStrategyTypeList(),this.mapView.showMapLoading(),this.currTableView.showLoading()},w.prototype.onTableEndLoad=function(){this.areaSelectView.enableSelects(),this.yearNavView.enableYearButtons(),this.themeNavToolbarView.enableStrategyTypeList(),this.mapView.hideMapLoading(),this.currTableView.hideLoading()},w.prototype.onTableFetchError=function(){alert("An error has occured."),Backbone.history.navigate("",{trigger:!0})},w.prototype.onTableNothingFound=function(){this.onTableEndLoad(),this.currTableView.showNothingFound()},w.prototype.updateSelectedWug=function(e){e==null?this.mapView.unselectWugFeatures():this.mapView.selectWugFeature(e)},w.prototype.highlightWugsByStrategyType=function(e){e==null?this.mapView.unhighlightStratTypeWugs():this.mapView.highlightStratTypeWugs(e)},w.prototype.updateViewsToNewYear=function(t){var n,r,i,s,o,u,a;n=Backbone.history.fragment,i="",a=e.VALID_YEARS;for(o=0,u=a.length;o<u;o++){s=a[o];if(n.indexOf(s+"/")!==-1){i=s;break}}i===""&&Backbone.history.navigate(""),r=n.replace(i,t),Backbone.history.navigate("#/"+r,{trigger:!0})},w.prototype.before={"^[0-9]{4}/wms":function(t){this.currTableView!=null&&(this.currTableView=this.currTableView.unrender());if(t!=null){if(!_.contains(e.VALID_YEARS,t))return alert("Invalid decade specified."),Backbone.history.navigate("",{trigger:!0}),!1;e.currYear=t}}},w.prototype.after={"^[0-9]{4}/wms":function(e){e!=null&&this.currTableView!=null&&(this.themeNavToolbarView.render(),this.yearNavView.render(),this.currTableView.off(),this.currTableView.on("table:startload",this.onTableStartLoad),this.currTableView.on("table:endload",this.onTableEndLoad),this.currTableView.on("table:nothingfound",this.onTableNothingFound),this.currTableView.on("table:fetcherror",this.onTableFetchError),this.currTableView.on("table:hoverwug",this.updateSelectedWug),this.currTableView.on("table:hovertype",this.highlightWugsByStrategyType),this.currTableView.render())}},w.prototype["default"]=function(){Backbone.history.navigate("#/"+e.currYear+"/wms",{trigger:!0})},w.prototype.wmsNetCountySupplies=function(e){this.currTableView!=null&&(this.currTableView=this.currTableView.unrender()),this.currTableView=new s({el:this.tableContainer,mapView:this.mapView}),this.mapView.resetExtent(),this.mapView.clearWugFeatures(),this.mapView.hideWmsOverlays(),this.mapView.showWmsOverlayByViewType("Regions"),this.areaSelectView.resetSelects()},w.prototype.wmsRegion=function(t,n){var r;r=e.regionNames.get(n);if(r==null){alert("Invalid region specified."),Backbone.history.navigate("",{trigger:!0});return}this.currTableView=new o({el:this.tableContainer,id:n,mapView:this.mapView}),this.mapView.hideWmsOverlays(),this.mapView.showWmsOverlayByViewType("Regions")},w.prototype.wmsCounty=function(t,n){var r,i;r=e.countyNames.get(n);if(r==null){alert("Invalid countyId specified."),Backbone.history.navigate("",{trigger:!0});return}i=r.get("name"),this.currTableView=new u({el:this.tableContainer,id:n,name:i}),this.mapView.hideWmsOverlays(),this.mapView.showWmsOverlayByViewType("Counties")},w.prototype.wmsHouseDistrict=function(t,n){var r;r=e.houseNames.get(n);if(r==null){alert("Invalid districtId specified."),Backbone.history.navigate("",{trigger:!0});return}this.currTableView=new a({el:this.tableContainer,id:n,type:"house",name:r.get("name")}),this.mapView.hideWmsOverlays(),this.mapView.showWmsOverlayByViewType("HouseDistricts")},w.prototype.wmsSenateDistrict=function(t,n){var r;r=e.senateNames.get(n);if(r==null){alert("Invalid districtId specified."),Backbone.history.navigate("",{trigger:!0});return}this.currTableView=new a({el:this.tableContainer,id:n,type:"senate",name:r.get("name")}),this.mapView.hideWmsOverlays(),this.mapView.showWmsOverlayByViewType("SenateDistricts")},w.prototype.wmsType=function(t,n){var r,i;i=e.strategyTypes.get(n);if(i==null){alert("Invalid typeId specified."),Backbone.history.navigate("",{trigger:!0});return}r=i.get("name"),this.currTableView=new f({el:this.tableContainer,id:n,name:r}),this.areaSelectView.resetSelects()},w.prototype.wmsEntity=function(e,t){this.currTableView=new l({el:this.tableContainer,id:t}),this.areaSelectView.resetSelects()},w.prototype.wmsProjectDetail=function(e,t){this.currTableView=new c({el:this.tableContainer,id:t}),this.areaSelectView.resetSelects()},w}(Backbone.Router)});var BASE_API_PATH,console;console=console||{},console.log=console.log||function(){return null},_.extend(_.templateSettings,{interpolate:/\{\{(.+?)\}\}/g}),BASE_API_PATH="/",$(function(){var e=this;BASE_API_PATH=$("#base_path").val(),require.config({baseUrl:""+BASE_API_PATH+"Scripts/Compiled/backbone_app",paths:{scripts:"../..",templates:"../../templates"}}),require(["WMSRouter"],function(e){var t,n;t=Backbone.History.extend({loadUrl:function(){var e;return e=Backbone.History.prototype.loadUrl.apply(this,arguments),e||this.trigger("route-not-found"),e}}),Backbone.history=new t,n=new e,Backbone.history.on("route-not-found",function(){Backbone.history.navigate("",{trigger:!0})}),Backbone.history.start()})}),define("main.js",function(){});