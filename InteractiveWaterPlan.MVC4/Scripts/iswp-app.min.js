/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/WugFeatureCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(Backbone.Collection)}),define("namespace",["collections/WugFeatureCollection"],function(e){var t;return t={},t.wugFeatureCollection=new e,t.VALID_YEARS=["2010","2020","2030","2040","2050","2060"],t.currYear="2010",t}),define("config/WmsThemeConfig",[],function(){var e;return e={Layers:[{name:"Regional Water Planning Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",service_params:{layers:"4,7",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!0,opacity:.6}},{name:"Water System Service Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/SWP_Boundaries/MapServer/WMSServer",service_params:{layers:"0",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas Counties",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",service_params:{layers:"1,13",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas Senate Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",service_params:{layers:"3,9",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas House Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",service_params:{layers:"2,11",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}}]},e});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapView",["namespace","config/WmsThemeConfig"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.origCenter=(new OpenLayers.LonLat(-99.294317,31.348335)).transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:3857")),r.prototype.origZoom=5,r.prototype.map=null,r.prototype.bingApiKey="",r.prototype.baseLayers=["esri_gray","mapquest_open","mapquest_aerial","bing_road","bing_hybrid","bing_aerial"],r.prototype.MAX_WUG_RADIUS=18,r.prototype.MIN_WUG_RADIUS=6,r.prototype.initialize=function(t){return this.$el=$("#"+t.mapContainerId),this.el=this.$el[0],this.bingApiKey=t.bingApiKey,_.bindAll(this,"render","unrender","resetExtent","showPlaceFeature","transformToWebMerc","resetWugFeatures","clearWugFeatures","selectWugFeature","unselectWugFeatures","_setupWugSelectControl"),e.wugFeatureCollection.on("reset",this.resetWugFeatures),null},r.prototype.render=function(){var e,n,r,i,s;this.$el.empty(),this.map=new OpenLayers.Map({div:this.$el[0],projection:new OpenLayers.Projection("EPSG:3857"),displayProjection:new OpenLayers.Projection("EPSG:4326"),layers:this._setupBaseLayers(this.baseLayers),center:this.origCenter,zoom:this.origZoom,eventListeners:{}}),s=t.Layers;for(r=0,i=s.length;r<i;r++){e=s[r];switch(e.type){case"WMS":n=new OpenLayers.Layer.WMS(e.name,e.url,e.service_params,e.layer_params),this.map.addLayer(n);break;default:throw"Unsupported Layer Type"}}return this.map.addControl(new OpenLayers.Control.LayerSwitcher),this},r.prototype.unrender=function(){return this.$el.remove(),null},r.prototype.resetWugFeatures=function(e){var t,n,r,i,s,o,u,a,f,l;this.clearWugFeatures();if(e.models.length<1)return;this.wugLayer=new OpenLayers.Layer.Vector("Water User Groups",{styleMap:this._wugStyleMap,displayInLayerSwitcher:!1}),o=new OpenLayers.Format.WKT,r=e.max(function(e){return e.get("sourceSupply")}).get("sourceSupply"),i=e.min(function(e){return e.get("sourceSupply")}).get("sourceSupply"),t=null,u=[],l=e.models;for(a=0,f=l.length;a<f;a++)n=l[a],s=o.read(n.get("wktGeog")),s.attributes=n.attributes,s.size=this._calculateScaledValue(r,i,this.MAX_WUG_RADIUS,this.MIN_WUG_RADIUS,n.get("sourceSupply")),delete s.attributes.wktGeog,s.geometry=s.geometry.transform(this.map.displayProjection,this.map.projection),t==null?t=s.geometry.getBounds().clone():t.extend(s.geometry.getBounds()),u.push(s);this.wugLayer.addFeatures(u),this.map.addLayer(this.wugLayer),this.wugSelectControl=this._setupWugSelectControl(),this.map.addControl(this.wugSelectControl),this.map.zoomToExtent(t)},r.prototype.clearWugFeatures=function(){this.unselectWugFeatures(),this.wugSelectControl!=null&&this.wugSelectControl.destroy(),this.wugLayer!=null&&this.wugLayer.destroy()},r.prototype.selectWugFeature=function(e){var t,n,r,i;if(this.wugSelectControl==null)return;i=this.wugLayer.features;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.attributes.id===e){this.wugSelectControl.select(t);return}}},r.prototype.unselectWugFeatures=function(){if(this.wugSelectControl==null||this.wugSelectControl.layer.selectedFeatures==null)return;this.wugSelectControl.unselectAll()},r.prototype._setupWugSelectControl=function(){var t,n,r=this;return n=null,t=new OpenLayers.Control.SelectFeature(this.wugLayer,{multiple:!1,hover:!0,autoActivate:!0,overFeature:function(e){var t,r=this;t=e.layer,this.hover&&(this.highlightOnly?this.highlight(e):OpenLayers.Util.indexOf(t.selectedFeatures,e)===-1&&(n=_.delay(function(){return r.select(e)},400)))},onSelect:function(t){var n;n=new OpenLayers.Popup.FramedCloud("wugpopup",t.geometry.getBounds().getCenterLonLat(),null,"                                <b>"+t.attributes.name+"</b><br/>                                "+e.currYear+" Supply: "+t.attributes.sourceSupply+" ac-ft/yr                            ",null,!1),n.autoSize=!0,t.popup=n,r.map.addPopup(n)},onUnselect:function(e){clearTimeout(n),e.popup!=null&&(r.map.removePopup(e.popup),e.popup.destroy(),e.popup=null)}}),t},r.prototype._calculateScaledValue=function(e,t,n,r,i){var s;return e===t?r:(s=(n-r)*(i-t)/(e-t)+r,s)},r.prototype.resetExtent=function(){var e;e=this.origZoom,this.map.baseLayer instanceof OpenLayers.Layer.Bing&&(e=this.origZoom-1),this.map.setCenter(this.origCenter,e)},r.prototype.showPlaceFeature=function(e){var t,n,r;r=new OpenLayers.Format.WKT,n=r.read(e.get("wktGeog")),this.transformToWebMerc(n.geometry),t=n.geometry.getBounds(),this.map.zoomToExtent(t)},r.prototype.transformToWebMerc=function(e){return e.transform(this.map.displayProjection,this.map.projection)},r.prototype._setupBaseLayers=function(e){var t,n,r,i;n=[];if(e==null||e.length===0)throw new Error("Must specify baseLayers.");for(r=0,i=e.length;r<i;r++){t=e[r];switch(t){case"mapquest_open":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Street",["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png"],{attribution:"Tiles courtesy <a href='http://www.mapquest.com/' target='_blank'>MapQuest</a>",transitionEffect:"resize",isBaseLayer:!0}));break;case"mapquest_aerial":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Aerial",["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png"],{attribution:"Tiles courtesy <a href='http://www.mapquest.com/' target='_blank'>MapQuest</a>",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_road":n.push(new OpenLayers.Layer.Bing({name:"Bing Road",key:this.bingApiKey,type:"Road",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_hybrid":n.push(new OpenLayers.Layer.Bing({name:"Bing Hybrid",key:this.bingApiKey,type:"AerialWithLabels",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_aerial":n.push(new OpenLayers.Layer.Bing({name:"Bing Aerial",key:this.bingApiKey,type:"Aerial",transitionEffect:"resize",isBaseLayer:!0}));break;case"esri_gray":n.push(new OpenLayers.Layer.XYZ("ESRI Gray",["http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/${z}/${y}/${x}"],{attribution:"Tiles courtesy <a href='http://www.esri.com' target='_blank'>esri</a>",isBaseLayer:!0}));break;case"stamen_toner":n.push(new OpenLayers.Layer.Stamen("toner-lite","Stamen Toner"));break;case"stamen_watercolor":n.push(new OpenLayers.Layer.Stamen("watercolor","Stamen Watercolor"))}}return n},r.prototype._wugStyleMap=new OpenLayers.StyleMap({"default":new OpenLayers.Style({pointRadius:"${getPointRadius}",strokeColor:"yellow",strokeWidth:1,fillColor:"green",fillOpacity:.8},{context:{getPointRadius:function(e){return e.size!=null?e.size:6}},rules:[new OpenLayers.Rule({maxScaleDenominator:866688,symbolizer:{fontSize:"11px",labelAlign:"cb",labelOutlineColor:"yellow",labelOutlineWidth:2,labelYOffset:8,label:"${name}"}}),new OpenLayers.Rule({minScaleDenominator:866688,symbolizer:{}})]}),select:new OpenLayers.Style({fillColor:"yellow",strokeColor:"green",fillOpacity:1})}),r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/StrategyTypeCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/strategy/types",t}(Backbone.Collection)}),define("scripts/text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("ï»¿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("scripts/text!templates/strategyTypeListItem.html",[],function(){return'<li>\r\n    <a href="#/{{currYear}}/wms/type/{{m.id}}">\r\n        {{m.name}}\r\n    </a>\r\n</li>'}),define("scripts/text!templates/themeNav.html",[],function(){return'<ul class="nav nav-pills" id="themeNav">\r\n    <li class="nav-label">THEME:</li>\r\n    <li class="dropdown">\r\n        <a class="dropdown-toggle" data-toggle="dropdown" href="#">\r\n            <span>Water Management Strategies</span>\r\n            <b class="caret"></b>\r\n        </a>\r\n        <ul class="dropdown-menu" id="strategyTypeList">\r\n            <li>\r\n                <a href="#/{{currYear}}/wms">\r\n                    NET COUNTY SUPPLIES\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li class="disabled"><a href="#">Water Use</a></li>\r\n    <li class="disabled"><a href="#">Sources</a></li>\r\n</ul>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/ThemeNavToolbarView",["namespace","collections/StrategyTypeCollection","scripts/text!templates/strategyTypeListItem.html","scripts/text!templates/themeNav.html"],function(e,t,n,r){var i;return i=function(i){function s(){return s.__super__.constructor.apply(this,arguments)}return __extends(s,i),s.prototype.template=_.template(r),s.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","renderStrategyTypeList"),null},s.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template({currYear:e.currYear})),ko.applyBindings(this,this.el),this.renderStrategyTypeList(),this},s.prototype.renderStrategyTypeList=function(){var r,i,s=this;r=_.template(n),i=new t,i.fetch({success:function(t){var n,i,o,u,a;a=t.models;for(o=0,u=a.length;o<u;o++)i=a[o],n=s.$("#strategyTypeList").append(r({m:i.toJSON(),currYear:e.currYear}))}})},s.prototype.unrender=function(){return this.$el.remove(),null},s}(Backbone.View)}),define("scripts/text!templates/yearNav.html",[],function(){return'<ul class="nav nav-pills" id="yearNav">\r\n    <li class="nav-label">DECADE:</li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2010">2010</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2020">2020</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2030">2030</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2040">2040</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2050">2050</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2060">2060</a></li>\r\n</ul>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/YearNavView",["namespace","scripts/text!templates/yearNav.html"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.template=_.template(t),r.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","changeYear"),null},r.prototype.render=function(){return this.$el.empty(),this.currentYear=ko.observable(e.currYear),this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("a[data-value='"+e.currYear+"']").parent().addClass("active"),this},r.prototype.unrender=function(){return kb.release(this),this.$el.remove(),null},r.prototype.changeYear=function(e,t){var n;return n=$(t.target),this.currentYear(n.data("value")),n.parent().siblings().removeClass("active"),n.parent().addClass("active"),null},r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("models/PlaceFeatureModel",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/place/feature/hull",t}(Backbone.Model)}),define("scripts/text!templates/mapBottomRightTools.html",[],function(){return'<div class="pull-right">\r\n\r\n    <div class="input-append map-stuff">\r\n        <input id="goToPlaceInput" type="text" placeholder="Go to Location" />\r\n        <button class="btn btn-primary" type="button" data-loading-text="...">Go</button>\r\n    </div>\r\n\r\n</div>\r\n\r\n<div class="pull-right">\r\n    <button class="btn" type="button" data-bind="click: toggleAreaSelects" data-toggle="#areaSelectContainer">\r\n        Select Strategies by Area <i class="icon-caret-up"></i>\r\n    </button>\r\n    &nbsp;\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapBottomToolbarView",["models/PlaceFeatureModel","scripts/text!templates/mapBottomRightTools.html"],function(e,t){var n;return n=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,n),r.prototype.template=_.template(t),r.prototype.mapView=null,r.prototype.initialize=function(e){_.bindAll(this,"render","unrender","toggleAreaSelects","showPlaceFeature"),this.mapView=e.mapView},r.prototype.render=function(){return this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("#goToPlaceInput").place_typeahead({minLength:2,source:function(e,t){return this.$element.data("selected-place-id",null),$.get(""+BASE_API_PATH+"api/place",{name:e},function(e){return t(e)})},buttonClick:this.showPlaceFeature}),this},r.prototype.unrender=function(){return this.$el.remove(),null},r.prototype.toggleAreaSelects=function(e,t){var n,r;n=$(t.target),r=n.data("toggle"),$(r).slideToggle(300,function(){var e;return e=$("i",n),e.hasClass("icon-caret-up")?(e.removeClass("icon-caret-up"),e.addClass("icon-caret-down")):(e.addClass("icon-caret-up"),e.removeClass("icon-caret-down"))})},r.prototype.showPlaceFeature=function(){var t,n,r=this;n=this.$("#goToPlaceInput").data("selected-place-id"),t=new e,t.fetch({data:{placeId:n},success:function(e){return r.mapView.showPlaceFeature(e)}})},r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseTableCollectionView",["namespace"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.initialize=function(t,n,r,i){return _.bindAll(this,"render","unrender","fetchCollection","appendModel","hideLoading","showLoading","fetchCallback","connectTableRowsToWugFeatures","_makeTableSortable"),i=i||{},this.fetchParams=i.fetchParams||{},this.currYear=ko.observable(e.currYear),this.template=_.template(r),this.collection=new n,this.ModelView=t,null},n.prototype.render=function(){return this.$el.html(this.template()),this.fetchCollection(),this.selectedWug=ko.observable(),this._makeTableSortable(),ko.applyBindings(this,this.el),this.$(".has-popover").popover({trigger:"hover",placement:"top"}),this},n.prototype.unrender=function(){return this.$el.html(),null},n.prototype.fetchCollection=function(){var t,n=this;this.hideNothingFound(),this.showLoading(),this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.collection.fetch({data:t,success:function(e){var t,r,i,s;if(e.models.length>0){s=e.models;for(r=0,i=s.length;r<i;r++)t=s[r],n.appendModel(t);n.$(".has-popover").popover({trigger:"hover"}),n.hideLoading()}else n.hideLoading(),n.showNothingFound();n.connectTableRowsToWugFeatures(),n.fetchCallback!=null&&_.isFunction(n.fetchCallback)&&n.fetchCallback(e.models)}})},n.prototype.fetchCallback=function(t){var n;n=_.map(t,function(t){return{id:t.get("recipientEntityId"),name:t.get("recipientEntityName"),wktGeog:t.get("recipientEntityWktGeog"),sourceSupply:t.get("supply"+e.currYear)}}),e.wugFeatureCollection.reset(n)},n.prototype.connectTableRowsToWugFeatures=function(){var e;e=this,this.$("table tbody").delegate("tr","hover",function(t){var n,r;t.type==="mouseenter"?(n=$(this),r=n.data("entity-id"),e.selectedWug(r)):e.selectedWug(null)})},n.prototype.appendModel=function(t){var n;n=new this.ModelView({model:t,currYear:e.currYear}),this.$("tbody").append(n.render().el)},n.prototype.showNothingFound=function(){$("#nothingFoundMessage").fadeIn(),$(".scrollTableContainer").hide()},n.prototype.hideNothingFound=function(){$("#nothingFoundMessage").hide()},n.prototype.showLoading=function(){this.$(".scrollTableContainer").hide(),$(".tableLoading").show()},n.prototype.hideLoading=function(){$(".tableLoading").hide(),this.$(".scrollTableContainer").fadeIn()},n.prototype._makeTableSortable=function(){var e;e=this.$("table").stupidtable({"formatted-int":function(e,t){return e=parseInt(e.replace(/,/g,"")),t=parseInt(t.replace(/,/g,"")),e<t?-1:e>t?1:0},"formatted-currency":function(e,t){var n,r;return e=e.replace(/,/g,"").replace("$",""),t=t.replace(/,/g,"").replace("$",""),_.isNaN(parseFloat(e))&&_.isNaN(parseFloat(t))?0:_.isNaN(parseFloat(e))?-1:_.isNaN(parseFloat(t))?1:(n=parseFloat(e),r=parseFloat(t),n<r?-1:n>r?1:0)}}),e.on("aftertablesort",function(e,t){var n,r;return n=$("th",this),$("i.icon-caret-up",n).remove(),$("i.icon-caret-down",n).remove(),r=t.direction==="asc"?"icon-caret-up":"icon-caret-down",n.eq(t.column).prepend("<i class='"+r+"'></i> "),null})},n}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseStrategyView",["namespace"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.tagName="tr",n.prototype.initialize=function(e){if(this.template==null&&e.template==null)throw"Must specify template";return e.template!=null&&(this.template=e.template),n.__super__.initialize.call(this,e),_.bindAll(this,"render","unrender"),this.template=_.template(this.template),null},n.prototype.render=function(){return this.$el.html(this.template({m:this.model.toJSON(),currYear:e.currYear})),this.$el.attr("data-entity-id",this.model.get("recipientEntityId")),this},n.prototype.unrender=function(){return this.$el.remove(),null},n}(Backbone.View)}),define("scripts/text!templates/countyNetSupplyRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/county/{{m.countyId}}">\r\n        {{m.countyName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m.netMunicipal) }}</td>\r\n<td>{{ $.number(m.netIrrigation) }}</td>\r\n<td>{{ $.number(m.netManufacturing) }}</td>\r\n<td>{{ $.number(m.netLivestock) }}</td>\r\n<td>{{ $.number(m.netSteamElectric) }}</td>\r\n<td>{{ $.number(m.netMining) }}</td>\r\n<td><b>{{ $.number(m.netSupplyTotal) }}</b></td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyView",["namespace","views/BaseStrategyView","scripts/text!templates/countyNetSupplyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyNetSupplyCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/supply/county-net",t}(Backbone.Collection)}),define("scripts/text!templates/countyNetSupplyTable.html",[],function(){return'<h2>Net Supplies to Counties from Recommended Water Management Strategies - <span data-bind="text: currYear"></span></h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n<div class="scrollTableContainer">\r\n    <table class="table table-hover table-striped table-bordered table-condensed modelTable">\r\n        <thead>\r\n            <tr>\r\n                <th data-sort="string">\r\n                    County\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                        Region\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Municipal supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Municipal\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Irrigation supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Irrigation\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Manufacturing supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Manufacturing\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Livestock supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Livestock\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Steam-Electric Power supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Steam-Electric Power\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total Mining supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        Mining\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int">\r\n                    <span class="has-popover" data-content="Total supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                        TOTAL\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyCollectionView",["views/BaseTableCollectionView","views/CountyNetSupplyView","collections/CountyNetSupplyCollection","scripts/text!templates/countyNetSupplyTable.html"],function(e,t,n,r){var i;return i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return __extends(i,e),i.prototype.initialize=function(e){return _.bindAll(this),i.__super__.initialize.call(this,t,n,r)},i.prototype.fetchCallback=function(){return null},i}(e)}),define("scripts/text!templates/strategyRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/type/{{m.typeId}}">\r\n        {{m.typeName}}\r\n    </a>\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n        {{m.recipientEntityName}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies in <span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n<div class="scrollTableContainer">\r\n    <table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n        <thead>\r\n            <tr>\r\n                <th data-sort="string">Type</th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                        Description\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                        Source\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                        Entity\r\n                    </span>\r\n                    <i class="wugIcon icon-circle"></i> \r\n                </th>\r\n                <th data-sort="formatted-int" width="15%">\r\n                    <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                        Supply Volume <span data-bind="text: currYear"></span>\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-currency" width="15%">\r\n                    <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                        Capital Cost\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                        Sponsor Entity\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/RegionStrategyCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyView","scripts/text!templates/strategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.regionLetter=e.id,this.viewName=ko.observable("Region "+this.regionLetter),s={regionLetter:this.regionLetter},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/region"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyStrategyCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyView","scripts/text!templates/strategyTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.countyId=e.id,this.countyName=e.name,this.viewName=ko.observable(""+this.countyName+" County"),s={countyId:this.countyId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/county"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/strategyTypeRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n        {{m.recipientEntityName}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyTypeRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyTypeTable.html",[],function(){return'<h2>\r\n   <span data-bind="text: viewName"></span> STRATEGIES - <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n<div class="scrollTableContainer">\r\n    <table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n        <thead>\r\n            <tr>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                        Region\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                        Description\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                        Source\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Water User Group supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                        Entity\r\n                    </span>\r\n                    <i class="wugIcon icon-circle"></i>\r\n                </th>\r\n                <th data-sort="formatted-int" width="15%">\r\n                    <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                        Supply Volume <span data-bind="text: currYear"></span>\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                        Sponsor Entity\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyTypeView","scripts/text!templates/strategyTypeTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.typeId=e.id,this.typeName=e.name,this.viewName=ko.observable(""+this.typeName),s={typeId:this.typeId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/type"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/entityStrategyRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/type/{{m.typeId}}">\r\n        {{m.typeName}}\r\n    </a>\r\n</td>\r\n\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}">\r\n        {{m.description}}\r\n    </a>\r\n</td>\r\n\r\n<td>{{m.sourceName}}</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/entityStrategyRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/entityStrategyTable.html",[],function(){return'<h2>\r\n    Recommended Water Management Strategies for \r\n    <span data-bind="text: viewName"></span> <i class="wugIcon icon-circle icon-large"></i> - \r\n    <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n<div class="scrollTableContainer">\r\n    <table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n        <thead>\r\n            <tr>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Water Management Strategy Type">\r\n                        Type\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                        Description\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                        Source\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-int" width="15%">\r\n                    <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                        Supply Volume <span data-bind="text: currYear"></span>\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-currency" width="15%">\r\n                    <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                        Capital Cost\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                        Sponsor Entity\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyCollectionView",["namespace","views/BaseTableCollectionView","views/EntityStrategyView","scripts/text!templates/entityStrategyTable.html"],function(e,t,n,r){var i;return i=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return __extends(i,t),i.prototype.initialize=function(e){var t,s;return _.bindAll(this,"fetchCallback"),this.entityId=e.id,this.viewName=ko.observable(),s={entityId:this.entityId},t=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/entity"}),i.__super__.initialize.call(this,n,t,r,{fetchParams:s}),null},i.prototype.fetchCallback=function(t){var n,r;n=[],r=t[0],r==null&&(alert("Invalid entityId specified."),Backbone.history.navigate("",{trigger:!0})),this.viewName(r.get("recipientEntityName")),n.push({id:r.get("recipientEntityId"),name:r.get("recipientEntityName"),wktGeog:r.get("recipientEntityWktGeog"),sourceSupply:r.get("supply"+e.currYear)}),e.wugFeatureCollection.reset(n)},i}(t)}),define("scripts/text!templates/strategyDetailRow.html",[],function(){return'<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/type/{{m.typeId}}">\r\n        {{m.typeName}}\r\n    </a>\r\n</td>\r\n<td>{{m.sourceName}}</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}">    \r\n        {{m.recipientEntityName}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>\r\n    <%  if (m.sponsorId == m.recipientEntityId) {\r\n            print(\'$\' + $.number(m.capitalCost));\r\n        } else {\r\n            print(\'---\');\r\n        }\r\n    %>\r\n</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyDetailView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyDetailRow.html"],function(e,t,n){var r;return r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyDetailTable.html",[],function(){return'<h2>\r\n    <span data-bind="text: viewName"></span> - \r\n    <span data-bind="text: currYear"></span>\r\n</h2>\r\n<p>All supply amounts are in units of acre-feet/year.</p>\r\n<div class="scrollTableContainer">\r\n    <table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n        <thead>\r\n            <tr>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                        Region\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Water Management Strategy Type">\r\n                        Type\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                        Source\r\n                    </span>\r\n                </th>\r\n                 <th data-sort="string">\r\n                    <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                        Entity\r\n                    </span>\r\n                    <i class="wugIcon icon-circle"></i> \r\n                </th>\r\n                <th data-sort="formatted-int" width="15%">\r\n                    <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                        Supply Volume <span data-bind="text: currYear"></span>\r\n                    </span>\r\n                </th>\r\n                <th data-sort="formatted-currency" width="15%">\r\n                    <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                        Capital Cost\r\n                    </span>\r\n                </th>\r\n                <th data-sort="string">\r\n                    <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                        Sponsor Entity\r\n                    </span>\r\n                </th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n        </tbody>\r\n    </table>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyDetailCollectionView",["namespace","views/BaseTableCollectionView","views/StrategyDetailView","scripts/text!templates/strategyDetailTable.html"],function(e,t,n,r){var i;return i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return _.bindAll(this,"fetchCallback"),this.projectId=e.id,this.viewName=ko.observable(),s={projectId:this.projectId},i=Backbone.Collection.extend({url:""+BASE_API_PATH+"api/strategies/project"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t.prototype.fetchCallback=function(e){e.length<!0&&(alert("Invalid projectId specified."),Backbone.history.navigate("",{trigger:!0})),this.viewName(e[0].get("description")),t.__super__.fetchCallback.call(this,e)},t}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/WmsAreaSelectView",["namespace"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.initialize=function(t){_.bindAll(this,"render","unrender","_createRegionSelect","_createCountySelect","_createHouseSelect","_createSenateSelect");if(e.countyNames==null||e.regionNames==null||e.houseNames==null||e.senateNames==null)throw"Must specify namespace.counties, namespace.regions, namespace.house,and namespace.senate";this.countyNamesCollection=e.countyNames,this.regionNamesCollection=e.regionNames,this.houseNamesCollection=e.houseNames,this.senateNamesCollection=e.senateNames},n.prototype.render=function(){return this._createRegionSelect().chosen(),this._createCountySelect().chosen(),this},n.prototype._createRegionSelect=function(){var t,n,r,i,s;this.$regionSelect=$("<select></select>"),this.$regionSelect.append($("<option value='-1'>Select a Region</option>")),s=this.regionNamesCollection.models;for(r=0,i=s.length;r<i;r++)n=s[r],t=$("<option value='"+n.get("letter")+"'>Region "+n.get("letter")+"</option>"),this.$regionSelect.append(t);return this.$("#regionSelectContainer").append(this.$regionSelect),this.$regionSelect.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/region/"+t.val(),{trigger:!0})}),this.$regionSelect},n.prototype._createCountySelect=function(){var t,n,r,i,s;this.$countySelect=$("<select></select>"),this.$countySelect.append($("<option value='-1'>Select a County</option>")),s=this.countyNamesCollection.models;for(r=0,i=s.length;r<i;r++)t=s[r],n=$("<option value='"+t.get("id")+"'>"+t.get("name")+"</option>"),this.$countySelect.append(n);return this.$("#countySelectContainer").append(this.$countySelect),this.$countySelect.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/county/"+t.val(),{trigger:!0})}),this.$countySelect},n.prototype._createHouseSelect=function(){var e,t,n,r,i;this.$houseSelect=$("<select></select>"),this.$houseSelect.append($("<option value='-1'>Select a State House District</option>")),i=this.houseNamesCollection.models;for(n=0,r=i.length;n<r;n++)e=i[n],t=$("<option value='"+e.get("id")+"'>"+e.get("name")+"</option>"),this.$houseSelect.append(t);return this.$("#houseSelectContainer").append(this.$houseSelect),this.$houseSelect.on("change",function(){var e;e=$(this);if(e.val()==="-1")return}),this.$houseSelect},n.prototype._createSenateSelect=function(){var e,t,n,r,i;this.$senateSelect=$("<select></select>"),this.$senateSelect.append($("<option value='-1'>Select a State Senate District</option>")),i=this.senateNamesCollection.models;for(n=0,r=i.length;n<r;n++)e=i[n],t=$("<option value='"+e.get("id")+"'>"+e.get("name")+"</option>"),this.$senateSelect.append(t);return this.$("#senateSelectContainer").append(this.$senateSelect),this.$senateSelect.on("change",function(){var e;e=$(this);if(e.val()==="-1")return}),this.$senateSelect},n.prototype.unrender=function(){return this.$el.remove(),null},n}(Backbone.View)}),define("scripts/text!templates/mapTopButtons.html",[],function(){return'<div class="pull-right">\r\n    <a class="btn map-stuff" data-bind="click: zoomToTexas">\r\n        Zoom to Texas\r\n    </a>\r\n    \r\n    <a class="btn" id="toggleMapBtn" data-bind="click: toggleMap">\r\n        Hide Map\r\n    </a>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapTopButtonsView",["scripts/text!templates/mapTopButtons.html"],function(e){var t;return t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.template=_.template(e),n.prototype.initialize=function(e){_.bindAll(this,"render","unrender","zoomToTexas","toggleMap");if(e.mapView==null)throw"options.mapView not defined";return this.mapView=e.mapView,null},n.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template()),ko.applyBindings(this,this.el),this},n.prototype.unrender=function(){return this.$el.remove(),null},n.prototype.zoomToTexas=function(){this.mapView.resetExtent()},n.prototype.toggleMap=function(e,t){var n;n=$(t.target),n.hasClass("off")?(n.html("Hide Map"),$("#mapContainer").slideDown(),$(".map-stuff").show(),n.removeClass("off")):(n.addClass("off"),$("#mapContainer").slideUp(),$(".map-stuff").hide(),n.html("Show Map"))},n}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/counties/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/RegionCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/regions/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/HouseCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/districts/house/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/SenateCollection",[],function(){var e;return e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.url=""+BASE_API_PATH+"api/boundary/districts/senate/names",t}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("WMSRouter",["namespace","views/MapView","views/ThemeNavToolbarView","views/YearNavView","views/MapBottomToolbarView","views/CountyNetSupplyCollectionView","views/RegionStrategyCollectionView","views/CountyStrategyCollectionView","views/StrategyTypeCollectionView","views/EntityStrategyCollectionView","views/StrategyDetailCollectionView","views/WmsAreaSelectView","views/MapTopButtonsView","collections/StrategyTypeCollection","collections/CountyCollection","collections/RegionCollection","collections/HouseCollection","collections/SenateCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y;return y=function(y){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,y),b.prototype.initialize=function(s){_.bindAll(this,"updateViewsToNewYear","updateSelectedWug"),this.currTableView=null,this.tableContainer=$("#tableContainer")[0],this.mapView=new t({mapContainerId:"mapContainer",bingApiKey:$("#bing_maps_key").val()}),this.mapView.render(),this.mapBottomToolbarView=new i({el:$("#mapBottomToolsContainer")[0],mapView:this.mapView}),this.mapBottomToolbarView.render(),this.themeNavToolbarView=new n({el:$("#themeNavContainer")[0]}),this.mapTopButtonsView=new h({el:$("#mapTopButtonsContainer")[0],mapView:this.mapView}),this.mapTopButtonsView.render(),this.yearNavView=new r({el:$("#yearNavContainer")[0]}),e.strategyTypes=new p,e.strategyTypes.reset(initStrategyTypes),e.countyNames=new d,e.countyNames.reset(initCountyNames),e.regionNames=new v,e.regionNames.reset(initRegionNames),e.houseNames=new m,e.houseNames.reset(initHouseNames),e.senateNames=new g,e.senateNames.reset(initSenateNames),this.countyRegionSelect=new c({el:$("#areaSelectContainer")[0]}),this.countyRegionSelect.render()},b.prototype.updateViewsToNewYear=function(t){var n,r,i,s,o,u,a;n=Backbone.history.fragment,i="",a=e.VALID_YEARS;for(o=0,u=a.length;o<u;o++){s=a[o];if(n.indexOf(s+"/")!==-1){i=s;break}}i===""&&Backbone.history.navigate(""),r=n.replace(i,t),Backbone.history.navigate("#/"+r,{trigger:!0})},b.prototype.updateSelectedWug=function(e){e?this.mapView.selectWugFeature(e):this.mapView.unselectWugFeatures()},b.prototype.routes={"":"default",":year/wms":"wmsNetCountySupplies",":year/wms/region/:regionLetter":"wmsRegion",":year/wms/county/:countyId":"wmsCounty",":year/wms/type/:typeId":"wmsType",":year/wms/entity/:entityId":"wmsEntity",":year/wms/project/:projectId":"wmsProjectDetail"},b.prototype.before={"":function(t){this.currTableView!=null&&(this.currTableView=this.currTableView.unrender());if(t!=null){if(!_.contains(e.VALID_YEARS,t))return alert("Invalid decade specified."),Backbone.history.navigate("",{trigger:!0}),!1;e.currYear=t}}},b.prototype.after={"":function(e){if(e!=null&&this.currTableView!=null)return this.currTableView.render(),this.currTableView.selectedWug.subscribe(this.updateSelectedWug),this.yearNavView.render(),this.yearNavView.currentYear.subscribe(this.updateViewsToNewYear),this.themeNavToolbarView.render()}},b.prototype["default"]=function(){Backbone.history.navigate("#/"+e.currYear+"/wms",{trigger:!0})},b.prototype.wmsNetCountySupplies=function(e){this.currTableView!=null&&(this.currTableView=this.currTableView.unrender()),this.currTableView=new s({el:this.tableContainer}),this.mapView.resetExtent(),this.mapView.clearWugFeatures()},b.prototype.wmsRegion=function(e,t){this.currTableView=new o({el:this.tableContainer,id:t,name:t})},b.prototype.wmsCounty=function(t,n){var r,i;r=e.countyNames.get(n);if(r==null){alert("Invalid countyId specified."),Backbone.history.navigate("",{trigger:!0});return}i=r.get("name"),this.currTableView=new u({el:this.tableContainer,id:n,name:i})},b.prototype.wmsType=function(t,n){var r,i;i=e.strategyTypes.get(n);if(i==null){alert("Invalid typeId specified."),Backbone.history.navigate("",{trigger:!0});return}r=i.get("name"),this.currTableView=new a({el:this.tableContainer,id:n,name:r})},b.prototype.wmsEntity=function(e,t){this.currTableView=new f({el:this.tableContainer,id:t})},b.prototype.wmsProjectDetail=function(e,t){this.currTableView=new l({el:this.tableContainer,id:t})},b}(Backbone.Router)});var BASE_API_PATH,console;console=console||{},console.log=console.log||function(){return null},_.extend(_.templateSettings,{interpolate:/\{\{(.+?)\}\}/g}),BASE_API_PATH="/",$(function(){var e=this;BASE_API_PATH=$("#base_path").val(),require.config({baseUrl:""+BASE_API_PATH+"Scripts/Compiled/backbone_app",paths:{scripts:"../..",templates:"../../templates"}}),require(["WMSRouter"],function(e){var t;t=new e,Backbone.history.start()})}),define("main.js",function(){});