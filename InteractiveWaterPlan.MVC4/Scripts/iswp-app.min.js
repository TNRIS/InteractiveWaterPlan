/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/StrategyTypeCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/strategy/types",n}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyNamesCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/boundary/counties/names",n}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/RegionNamesCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/boundary/regions/names",n.prototype.model=Backbone.Model.extend({idAttribute:"letter"}),n}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/HouseNamesCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/boundary/districts/house/names",n}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/SenateNamesCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/boundary/districts/senate/names",n}(Backbone.Collection)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/RegionFeatureCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/boundary/regions/all",n}(Backbone.Collection)}),define("namespace",["collections/StrategyTypeCollection","collections/CountyNamesCollection","collections/RegionNamesCollection","collections/HouseNamesCollection","collections/SenateNamesCollection","collections/RegionFeatureCollection"],function(e,t,n,r,i,s){var o;return o={},o.VALID_YEARS=["2010","2020","2030","2040","2050","2060"],o.currYear="2010",o.bootstrapData=function(){return this.strategyTypes=new e,this.countyNames=new t,this.regionNames=new n,this.houseNames=new r,this.senateNames=new i,this.regionFeatures=new s,$.when(this.strategyTypes.fetch(),this.countyNames.fetch(),this.regionNames.fetch(),this.houseNames.fetch(),this.senateNames.fetch(),this.regionFeatures.fetch())},o}),define("config/WmsThemeConfig",[],function(){var e;return e={SourceStyles:[{id:"default",name:"DEFAULT",strokeColor:"blue",fillColor:"blue",strokeWidth:1},{id:0,name:"SURFACE WATER",strokeColor:"white",fillColor:"#1E90FF",strokeWidth:1},{id:1,name:"GROUNDWATER",strokeColor:"white",fillColor:"#4682B4",strokeWidth:1}],Layers:[{name:"Regional Water Planning Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"Regions",service_params:{layers:"4,7",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!0,opacity:.6}},{name:"Texas Counties",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"Counties",service_params:{layers:"1,13",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas County Names",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"CountyNames",service_params:{layers:"13",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas Senate Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"SenateDistricts",service_params:{layers:"3,9",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Texas House Districts (2011)",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/swp/MapServer/WMSServer",viewType:"HouseDistricts",service_params:{layers:"2,11",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}},{name:"Water System Service Areas",type:"WMS",url:"http://services.tnris.org/arcgis/services/swp/SWP_Boundaries/MapServer/WMSServer",service_params:{layers:"0",transparent:!0},layer_params:{isBaseLayer:!1,visibility:!1,opacity:.6}}]},e});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapView",["namespace","config/WmsThemeConfig"],function(e,t){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return __extends(n,e),n.prototype.origCenter=(new OpenLayers.LonLat(-99.294317,31.348335)).transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:3857")),n.prototype.origZoom=5,n.prototype.map=null,n.prototype.bingApiKey="",n.prototype.baseLayers=["esri_gray","mapquest_open","mapquest_aerial","bing_road","bing_hybrid","bing_aerial"],n.prototype.isMapLocked=!1,n.prototype.MAX_ZOOM=13,n.prototype.initialize=function(e){return this.$el=$("#"+e.mapContainerId),this.el=this.$el[0],this.bingApiKey=e.bingApiKey,_.bindAll(this,"render","unrender","resetExtent","showPlaceFeature","transformToWebMerc","_setupOverlayLayers","showWmsOverlayByViewType","hideWmsOverlays","showMapLoading","hideMapLoading","zoomToExtent","getMouseLonLat"),null},n.prototype.render=function(){var e=this;return this.$el.empty(),this.map=new OpenLayers.Map({div:this.$el[0],projection:new OpenLayers.Projection("EPSG:3857"),displayProjection:new OpenLayers.Projection("EPSG:4326"),layers:this._setupBaseLayers(this.baseLayers),center:this.origCenter,zoom:this.origZoom,eventListeners:{zoomend:function(t,n){var r;r=e.map.getZoom(),e.map.baseLayer instanceof OpenLayers.Layer.Bing&&(r+=1),r>e.MAX_ZOOM&&e.map.zoomTo(e.MAX_ZOOM)}}}),this._setupOverlayLayers(),this.map.addControl(new OpenLayers.Control.LayerSwitcher),this.map.addControl(new OpenLayers.Control.MousePosition({emptyString:""})),this},n.prototype.unrender=function(){return this.$el.remove(),null},n.prototype.hideWmsOverlays=function(){var e,t,n,r;r=this.map.layers;for(t=0,n=r.length;t<n;t++)e=r[t],e.isBaseLayer||e.setVisibility(!1)},n.prototype.showWmsOverlayByViewType=function(e){var t,n,r,i;i=this.map.layers;for(n=0,r=i.length;n<r;n++)t=i[n],t.viewType===e?t.setVisibility(!0):t.isBaseLayer||t.setVisibility(!1)},n.prototype._setupOverlayLayers=function(){var e,n,r,i,s;s=t.Layers;for(r=0,i=s.length;r<i;r++){e=s[r];switch(e.type){case"WMS":n=new OpenLayers.Layer.WMS(e.name,e.url,e.service_params,e.layer_params),n.viewType=e.viewType,this.map.addLayer(n);break;default:throw"Unsupported Layer Type"}}},n.prototype.resetExtent=function(){var e;e=this.origZoom,this.map.baseLayer instanceof OpenLayers.Layer.Bing&&(e=this.origZoom-1),this.map.setCenter(this.origCenter,e)},n.prototype.zoomToExtent=function(e){this.isMapLocked||this.map.zoomToExtent(e)},n.prototype.showPlaceFeature=function(e){var t,n,r;r=new OpenLayers.Format.WKT,n=r.read(e.get("wktGeog")),this.transformToWebMerc(n.geometry),t=n.geometry.getBounds(),this.zoomToExtent(t)},n.prototype.getMouseLonLat=function(){return this.map.getLonLatFromPixel(this.map.getControlsByClass("OpenLayers.Control.MousePosition")[0].lastXy)},n.prototype.transformToWebMerc=function(e){return e.transform(this.map.displayProjection,this.map.projection)},n.prototype.showMapLoading=function(){this.$loadingOverlay==null&&(this.$loadingOverlay=$("<div></div>"),this.$loadingOverlay.height(this.$el.height()).width(this.$el.width()),this.$loadingOverlay.addClass("mapLoadingOverlay"),this.$el.prepend(this.$loadingOverlay))},n.prototype.hideMapLoading=function(){this.$loadingOverlay!=null&&(this.$loadingOverlay.remove(),this.$loadingOverlay=null)},n.prototype._setupBaseLayers=function(e){var t,n,r,i;n=[];if(e==null||e.length===0)throw new Error("Must specify baseLayers.");for(r=0,i=e.length;r<i;r++){t=e[r];switch(t){case"mapquest_open":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Street",["http://otile1.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile2.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile3.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png","http://otile4.mqcdn.com/tiles/1.0.0/osm/${z}/${x}/${y}.png"],{attribution:"Data, imagery, and map information provided by \n<a href='http://www.mapquest.com' target='_blank'>MapQuest</a>, \n<a href='http://www.openstreetmap.org' target='_blank'>Open Street Map</a> \nand contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/' \ntarget='_blank'>CC-BY-SA</a>",transitionEffect:"resize",isBaseLayer:!0}));break;case"mapquest_aerial":n.push(new OpenLayers.Layer.XYZ("MapQuest Open Aerial",["http://oatile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png","http://oatile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png"],{attribution:"Tiles Courtesy of <a href='http://www.mapquest.com/'' target='_blank'>MapQuest</a>.\nPortions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_road":n.push(new OpenLayers.Layer.Bing({name:"Bing Road",key:this.bingApiKey,type:"Road",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_hybrid":n.push(new OpenLayers.Layer.Bing({name:"Bing Hybrid",key:this.bingApiKey,type:"AerialWithLabels",transitionEffect:"resize",isBaseLayer:!0}));break;case"bing_aerial":n.push(new OpenLayers.Layer.Bing({name:"Bing Aerial",key:this.bingApiKey,type:"Aerial",transitionEffect:"resize",isBaseLayer:!0}));break;case"esri_gray":n.push(new OpenLayers.Layer.XYZ("ESRI Gray",["http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/${z}/${y}/${x}"],{attribution:"Tiles Courtesy of <a href='http://www.esri.com' target='_blank'>esri</a>",isBaseLayer:!0}));break;case"stamen_toner":n.push(new OpenLayers.Layer.Stamen("toner-lite","Stamen Toner"));break;case"stamen_watercolor":n.push(new OpenLayers.Layer.Stamen("watercolor","Stamen Watercolor"))}}return n},n}(Backbone.View)}),define("scripts/text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("scripts/text!templates/strategyTypeListItem.html",[],function(){return'<li>\r\n    <a href="#/{{currYear}}/wms/type/{{m.id}}">\r\n        {{m.name}}\r\n    </a>\r\n</li>'}),define("scripts/text!templates/themeNav.html",[],function(){return'<ul class="nav nav-pills" id="themeNav">\r\n    <li class="nav-label">THEME:</li>\r\n    <li class="dropdown">\r\n        <a class="dropdown-toggle" data-toggle="dropdown" href="#">\r\n            <span>Water Management Strategies</span>\r\n            <b class="caret"></b>\r\n        </a>\r\n        <ul class="dropdown-menu" id="strategyTypeList">\r\n            <li>\r\n                <a href="#/{{currYear}}/wms">\r\n                    NET COUNTY SUPPLIES\r\n                </a>\r\n            </li>\r\n            <li class="nav-category">\r\n                Strategies by Type:\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <!-- <li class="disabled"><a href="#">Water Use</a></li>\r\n    <li class="disabled"><a href="#">Sources</a></li> -->\r\n</ul>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/ThemeNavToolbarView",["namespace","collections/StrategyTypeCollection","scripts/text!templates/strategyTypeListItem.html","scripts/text!templates/themeNav.html"],function(e,t,n,r){var i,s;return i=function(i){function o(){return s=o.__super__.constructor.apply(this,arguments),s}return __extends(o,i),o.prototype.template=_.template(r),o.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","renderStrategyTypeList","enableStrategyTypeList","disableStrategyTypeList"),null},o.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template({currYear:e.currYear})),ko.applyBindings(this,this.el),this.renderStrategyTypeList(),this},o.prototype.renderStrategyTypeList=function(){var r,i,s=this;r=_.template(n),i=new t,i.fetch({success:function(t){var n,i,o,u,a;a=t.models;for(o=0,u=a.length;o<u;o++)i=a[o],n=s.$("#strategyTypeList").append(r({m:i.toJSON(),currYear:e.currYear}))}})},o.prototype.disableStrategyTypeList=function(){this.$(".dropdown-toggle").attr("data-toggle",null).parent("li").addClass("disabled").on("click.me",function(e){e.preventDefault()})},o.prototype.enableStrategyTypeList=function(){this.$(".dropdown-toggle").attr("data-toggle","dropdown").parent("li").removeClass("disabled").off("click.me")},o.prototype.unrender=function(){return this.$el.remove(),null},o}(Backbone.View)}),define("scripts/text!templates/yearNav.html",[],function(){return'<ul class="nav nav-pills" id="yearNav">\r\n    <li class="nav-label">DECADE:</li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2010">2010</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2020">2020</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2030">2030</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2040">2040</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2050">2050</a></li>\r\n    <li><a href="#" data-bind="click: changeYear" data-value="2060">2060</a></li>\r\n</ul>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/YearNavView",["namespace","scripts/text!templates/yearNav.html"],function(e,t){var n,r;return n=function(n){function i(){return r=i.__super__.constructor.apply(this,arguments),r}return __extends(i,n),i.prototype.template=_.template(t),i.prototype.initialize=function(e){return _.bindAll(this,"render","unrender","changeYear","disableYearButtons","enableYearButtons"),null},i.prototype.render=function(){return this.$el.empty(),this.currentYear=ko.observable(e.currYear),this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("a[data-value='"+e.currYear+"']").parent().addClass("active"),this},i.prototype.disableYearButtons=function(){this.$("a").parents("li").addClass("disabled")},i.prototype.enableYearButtons=function(){this.$("a").parents("li").removeClass("disabled")},i.prototype.unrender=function(){return kb.release(this),this.$el.remove(),null},i.prototype.changeYear=function(e,t){var n,r;return n=$(t.target),r=n.attr("data-value"),this.trigger("changeyear",r),n.parent().siblings().removeClass("active"),n.parent().addClass("active"),null},i}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("models/PlaceFeatureModel",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/place/feature/hull",n}(Backbone.Model)}),define("scripts/text!templates/mapBottomRightTools.html",[],function(){return'<div class="pull-right">\r\n\r\n    <div class="input-append map-stuff">\r\n        <input id="goToPlaceInput" type="text" placeholder="Go to Location" />\r\n        <button class="btn btn-primary" type="button" data-loading-text="...">Go</button>\r\n    </div>\r\n\r\n</div>\r\n\r\n<div class="pull-right">\r\n    <button class="btn" type="button" data-bind="click: toggleAreaSelects" data-toggle="#areaSelectContainer" data-title-orig="Select Strategies by Area">\r\n        <span class="title">Hide Area Selection</span> <i class="icon-caret-up"></i>\r\n    </button>\r\n    &nbsp;\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapBottomToolbarView",["namespace","models/PlaceFeatureModel","scripts/text!templates/mapBottomRightTools.html"],function(e,t,n){var r,i;return r=function(r){function s(){return i=s.__super__.constructor.apply(this,arguments),i}return __extends(s,r),s.prototype.template=_.template(n),s.prototype.initialize=function(t){_.bindAll(this,"render","unrender","showPlaceFeature"),this.mapView=e.mapView},s.prototype.render=function(){return this.$el.html(this.template()),ko.applyBindings(this,this.el),this.$("#goToPlaceInput").place_typeahead({minLength:2,source:function(e,t){return this.$element.data("selected-place-id",null),$.get(""+BASE_PATH+"api/place",{name:e},function(e){return t(e)})},buttonClick:this.showPlaceFeature}),this},s.prototype.unrender=function(){return this.$el.remove(),null},s.prototype.toggleAreaSelects=function(e,t){var n,r;n=$(t.delegateTarget),r=n.data("toggle"),$(r).slideToggle(300,function(){var e,t;return e=$("i",n),e.hasClass("icon-caret-up")?(e.removeClass("icon-caret-up"),e.addClass("icon-caret-down")):(e.addClass("icon-caret-up"),e.removeClass("icon-caret-down")),t=$(".title",n).html(),$(".title",n).html(n.attr("data-title-orig")),n.attr("data-title-orig",t)})},s.prototype.showPlaceFeature=function(){var e,n,r=this;n=this.$("#goToPlaceInput").data("selected-place-id"),e=new t,e.fetch({data:{placeId:n},success:function(e){return r.mapView.showPlaceFeature(e)}})},s}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseStrategyCollectionView",["namespace"],function(e){var t,n;return t=function(t){function r(){return n=r.__super__.constructor.apply(this,arguments),n}return __extends(r,t),r.prototype.MAX_WUG_RADIUS=18,r.prototype.MIN_WUG_RADIUS=6,r.prototype.initialize=function(t,n,r,i){return _.bindAll(this,"render","unrender","fetchData","appendModel","hideLoading","showLoading","onFetchDataSuccess","fetchCallback","_setupDataTable","_connectTableRowsToWugFeatures","showNothingFound","hideNothingFound","_setupClickFeatureControl","showWugFeatures","_clearWugFeaturesAndControls","_setupWugClickControl","selectWugFeature","unselectWugFeatures","_setupWugHighlightContol","highlightStratTypeWugs","unhighlightStratTypeWugs","_setupHighlightFeatureControl","_clickFeature","_createBezierConnector"),i=i||{},this.fetchParams=i.fetchParams||{},this.mapView=e.mapView,this.currYear=ko.observable(e.currYear),this.template=_.template(r),this.strategyCollection=new n,this.wugCollection=new Backbone.Collection,this.ModelView=t,null},r.prototype.render=function(){return this.$el.html(this.template()),this.fetchData(),ko.applyBindings(this,this.el),this.$(".has-popover").popover({trigger:"hover",placement:"top"}),this},r.prototype.unrender=function(){return this._clearWugFeaturesAndControls(),this.$el.html(),null},r.prototype._clearWugFeaturesAndControls=function(){this.unselectWugFeatures(),this.highlightFeatureControl!=null&&(this.highlightFeatureControl.destroy(),this.highlightFeatureControl=null),this.clickFeatureControl!=null&&(this.clickFeatureControl.destroy(),this.clickFeatureControl=null),this.wugLayer!=null&&this.wugLayer.destroy()},r.prototype.fetchData=function(){var t,n=this;this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),this.strategyCollection.fetch({data:t,success:this.onFetchDataSuccess,error:function(){n.trigger("table:fetcherror")}})},r.prototype.onFetchDataSuccess=function(e){var t,n,r,i;if(e.models.length===0)return this.trigger("table:nothingfound"),!1;i=e.models;for(n=0,r=i.length;n<r;n++)t=i[n],this.appendModel(t),t.attributes.isRedundantSupply==="Y"&&this.$(".note-marker-container").show();return this.$(".has-popover").popover({trigger:"hover"}),this._setupDataTable(),this._connectTableRowsToWugFeatures(),this.fetchCallback!=null&&_.isFunction(this.fetchCallback)&&this.fetchCallback(e.models),this.trigger("table:endload"),!0},r.prototype.fetchCallback=function(t){var n,r;t=_.reject(t,function(e){return e.get("recipientEntityType")==="WWP"}),n=_.groupBy(t,function(e){return e.get("recipientEntityId")}),r=_.map(n,function(t){var n;return n=_.reduce(t,function(t,n){return t.entityId=n.get("recipientEntityId"),t.name=n.get("recipientEntityName"),t.wktGeog=n.get("recipientEntityWktGeog"),t.type=n.get("recipientEntityType"),t.strategyTypes.push(n.get("typeId")),t.totalSupply+=n.get("supply"+e.currYear),t},{totalSupply:0,strategyTypes:[]}),n.strategyTypes=_.uniq(n.strategyTypes),n}),r.sort(function(e,t){return e.type==="WWP"?-1:t.type==="WWP"?1:t.totalSupply-e.totalSupply}),this.wugCollection.reset(r),this.showWugFeatures()},r.prototype._setupDataTable=function(){var t,n,r=this;t=this.$("table"),n=[],$("th",t).each(function(e,t){var r;return r=$(t),r.attr("data-sort")!=null?n.push({sType:$(t).attr("data-sort")}):n.push(null)}),t.dataTable({bDestroy:!0,sPaginationType:"bootstrap",aLengthMenu:[[10,25,50,100,99999],[10,25,50,100,"All"]],aoColumns:n,aaSorting:[],iDisplayLength:e.selectedDisplayLength||10,fnDrawCallback:function(t){e.selectedDisplayLength=t._iDisplayLength}})},r.prototype._connectTableRowsToWugFeatures=function(){var e;e=this,this.$("table tbody").delegate("td.strategyType","hover",function(t){var n;t.type==="mouseenter"?(n=parseInt($(this).attr("data-type-id")),e.trigger("table:hovertype",n)):e.trigger("table:hovertype",null)}),this.$("table tbody").delegate("tr","hover",function(t){var n,r;t.type==="mouseenter"?(n=$(this),r=parseInt(n.attr("data-entity-id")),e.trigger("table:hoverwug",r)):e.trigger("table:hoverwug",null)})},r.prototype.appendModel=function(t){var n;n=new this.ModelView({model:t,currYear:e.currYear}),this.$("tbody").append(n.render().el)},r.prototype.showNothingFound=function(){$("#nothingFoundMessage").fadeIn(),this.$el.hide()},r.prototype.hideNothingFound=function(){$("#nothingFoundMessage").hide()},r.prototype.showLoading=function(){this.$el.hide(),this.hideNothingFound(),$(".tableLoading").show()},r.prototype.hideLoading=function(){$(".tableLoading").hide(),this.$el.fadeIn()},r.prototype.showWugFeatures=function(){var e,t,n,r,i,s,o,u,a,f;this.wugLayer!=null&&this.wugLayer.destroy();if(this.wugCollection.models.length<1)return;this.wugLayer=new OpenLayers.Layer.Vector("Water User Groups",{styleMap:this._wugStyleMap,displayInLayerSwitcher:!1}),i=new OpenLayers.Format.WKT,t=this.wugCollection.max(function(e){return e.get("totalSupply")}).get("totalSupply"),n=this.wugCollection.min(function(e){return e.get("totalSupply")}).get("totalSupply"),e=null,o=[],f=this.wugCollection.models;for(u=0,a=f.length;u<a;u++)s=f[u],r=i.read(s.get("wktGeog")),r.attributes=_.clone(s.attributes),r.size=this._calculateScaledValue(t,n,this.MAX_WUG_RADIUS,this.MIN_WUG_RADIUS,s.get("totalSupply")),delete r.attributes.wktGeog,this.mapView.transformToWebMerc(r.geometry),e==null?e=r.geometry.getBounds().clone():e.extend(r.geometry.getBounds()),o.push(r);this.wugLayer.addFeatures(o),this.mapView.map.addLayer(this.wugLayer),this._setupWugHighlightContol(),this._setupWugClickControl(),this.mapView.zoomToExtent(e)},r.prototype.selectWugFeature=function(e,t){var n,r,i,s;if(this.highlightFeatureControl==null)return;s=this.wugLayer.features;for(r=0,i=s.length;r<i;r++){n=s[r];if(n.attributes.entityId===e){this.highlightFeatureControl.select(n);return}}},r.prototype.unselectWugFeatures=function(){if(this.highlightFeatureControl==null||this.highlightFeatureControl.layer==null||this.highlightFeatureControl.layer.selectedFeatures==null)return;this.highlightFeatureControl.unselectAll()},r.prototype.highlightStratTypeWugs=function(e){var t,n,r,i;if(!this.wugLayer)return;i=this.wugLayer.features;for(n=0,r=i.length;n<r;n++)t=i[n],t.attributes.strategyTypes!=null&&_.contains(t.attributes.strategyTypes,e)?t.renderIntent="typehighlight":t.renderIntent="transparent";this.wugLayer.redraw()},r.prototype.unhighlightStratTypeWugs=function(){var e,t,n,r;if(!this.wugLayer)return;r=this.wugLayer.features;for(t=0,n=r.length;t<n;t++)e=r[t],e.renderIntent="default";this.wugLayer.redraw()},r.prototype._setupWugClickControl=function(){this.clickFeatureControl==null?this._setupClickFeatureControl(this.wugLayer):this._addLayerToControl(this.clickFeatureControl,this.wugLayer)},r.prototype._setupWugHighlightContol=function(){var t=this;this.highlightFeatureControl==null?this._setupHighlightFeatureControl(this.wugLayer):this._addLayerToControl(this.highlightFeatureControl,this.wugLayer),this.highlightFeatureControl.events.register("featurehighlighted",null,function(n){var r,i;if(n.feature.layer==null||n.feature.layer.id!==t.wugLayer.id)return;i=n.feature,r=new OpenLayers.Popup.FramedCloud("wugpopup",i.geometry.getBounds().getCenterLonLat(),null,"                        <b>"+i.attributes.name+"</b><br/>                        Total "+e.currYear+" Supply: "+$.number(i.attributes.totalSupply)+" ac-ft/yr                    ",null,!0),r.autoSize=!0,i.popup=r,t.mapView.map.addPopup(r)}),this.highlightFeatureControl.events.register("featureunhighlighted",null,function(e){var n;if(e.feature.layer==null||e.feature.layer.id!==t.wugLayer.id)return;n=e.feature,n.popup!=null&&(t.mapView.map.removePopup(n.popup),n.popup.destroy(),n.popup=null)})},r.prototype._addLayerToControl=function(e,t){if(e==null||t==null)return;e.setLayer((e.layers||[e.layer]).concat(t))},r.prototype._setupClickFeatureControl=function(e){this.clickFeatureControl=new OpenLayers.Control.SelectFeature(e,{autoActivate:!0,clickFeature:this._clickFeature}),this.clickFeatureControl.events.register("featurehighlighted",null,function(e){return this.events.triggerEvent("clickfeature",{feature:e.feature}),!0}),this.mapView.map.addControl(this.clickFeatureControl)},r.prototype._clickFeature=function(t){var n;if(t.layer.id!==this.wugLayer.id)return;if(t.attributes.type!=null&&t.attributes.type==="WWP")return;n=t.attributes.entityId,Backbone.history.navigate("#/"+e.currYear+"/wms/entity/"+n,{trigger:!0})},r.prototype._setupHighlightFeatureControl=function(e){this.highlightFeatureControl=new OpenLayers.Control.SelectFeature(e,{multiple:!1,hover:!0,autoActivate:!0,select:function(e){if(e==null||e.layer==null)return;OpenLayers.Control.SelectFeature.prototype.select.apply(this,arguments)},overFeature:function(t){var n=this;e=t.layer,this.hover&&(this.highlightOnly?this.highlight(t):OpenLayers.Util.indexOf(e.selectedFeatures,t)===-1&&(this.highlightTimer=_.delay(function(){return n.select(t)},400)))},outFeature:function(e){var t;if(this.hover){if(!this.highlightOnly)return clearTimeout(this.highlightTimer),this.unselect(e);if(e._lastHighlighter===this.id){if(!e._prevHighlighter||e._prevHighlighter===this.id)return this.unhighlight(e);delete e._lastHighlighter,t=this.map.getControl(e._prevHighlighter);if(t)return t.highlight(e)}}}}),this.mapView.map.addControl(this.highlightFeatureControl)},r.prototype._calculateScaledValue=function(e,t,n,r,i){var s;return e===t?r:(s=(n-r)*(i-t)/(e-t)+r,s)},r.prototype._createBezierConnector=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g;e.y>t.y&&(g=[t,e],e=g[0],t=g[1]),r=e.distanceTo(t),n=r/4,l=r/4,e.y<t.y&&(l=-l),u=50,o=(t.y-e.y)/2,s=(t.x-e.x)/2,Math.abs(e.y-t.y)<1e-4?(s-=n,o+=l):(o+=n,s+=l),h=1/u,a=[],a.push(new OpenLayers.Geometry.Point(e.x,e.y));for(c=m=0;h>0?m<=1:m>=1;c=m+=h)i=(1-c*c)*e.y,f=2*(1-c)*c*o,p=c*c*t.y,v=i+f+p,i=(1-c*c)*e.x,f=2*(1-c)*c*s,p=c*c*t.x,d=i+f+p,a.push(new OpenLayers.Geometry.Point(d,v));return a.push(new OpenLayers.Geometry.Point(t.x,t.y)),new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(a),{featureType:"connector"})},r.prototype._wugStyleMap=new OpenLayers.StyleMap({"default":new OpenLayers.Style({pointRadius:"${getPointRadius}",strokeColor:"yellow",strokeWidth:1,fillColor:"${getFillColor}",fillOpacity:.8},{context:{getPointRadius:function(e){return e.size!=null?e.size:6},getFillColor:function(e){return e.attributes.type!=null&&e.attributes.type==="WWP"?"gray":"green"}},rules:[new OpenLayers.Rule({maxScaleDenominator:866688,symbolizer:{fontSize:"11px",labelAlign:"cb",labelOutlineColor:"yellow",labelOutlineWidth:2,labelYOffset:8,label:"${name}"}}),new OpenLayers.Rule({minScaleDenominator:866688,symbolizer:{}})]}),select:new OpenLayers.Style({fillColor:"yellow",strokeColor:"green",fillOpacity:1}),typehighlight:new OpenLayers.Style({fillColor:"blue",fillOpacity:.8,strokeColor:"yellow"}),transparent:new OpenLayers.Style({fillOpacity:0,strokeOpacity:0})}),r}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseSelectableRegionStrategyView",["namespace","collections/RegionFeatureCollection","views/BaseStrategyCollectionView"],function(e,t,n){var r,i;return r=function(t){function n(){return i=n.__super__.constructor.apply(this,arguments),i}return __extends(n,t),n.prototype.initialize=function(e,t,r,i,s){n.__super__.initialize.call(this,e,t,r,s),_.bindAll(this,"showRegionFeatures","onStrategyCollectionSuccess"),this.mapView=i,this.regionCollection=null},n.prototype.unrender=function(){return n.__super__.unrender.apply(this,arguments),this.regionHighlightControl!=null&&this.regionHighlightControl.destroy(),this.regionClickControl!=null&&this.regionClickControl.destroy(),this.regionLayer!=null&&this.regionLayer.destroy(),null},n.prototype.fetchData=function(){var t,n,r=this;this.$("tbody").empty(),n=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),t=this.strategyCollection.fetch({data:n,success:this.onStrategyCollectionSuccess}),t.then(function(){r.trigger("table:endload")}).fail(function(){r.trigger("table:fetcherror")})},n.prototype.onStrategyCollectionSuccess=function(t){var n,r,i,s;if(t.models.length===0)this.trigger("table:nothingfound");else{s=t.models;for(r=0,i=s.length;r<i;r++)n=s[r],this.appendModel(n),n.attributes.isRedundantSupply==="Y"&&this.$(".note-marker-container").show();this.$(".has-popover").popover({trigger:"hover"}),this._setupDataTable(),this.regionCollection=e.regionFeatures,this.showRegionFeatures()}},n.prototype.showRegionFeatures=function(){var t,n,r,i,s,o,u;i=new OpenLayers.Format.WKT,r=[],u=this.regionCollection.models;for(s=0,o=u.length;s<o;s++)n=u[s],t=i.read(n.get("wktGeog")),t.attributes=_.clone(n.attributes),delete t.attributes.wktGeog,this.mapView.transformToWebMerc(t.geometry),r.push(t);this.regionLayer=new OpenLayers.Layer.Vector("Region Feature Layer",{displayInLayerSwitcher:!1,styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"gray",strokeWidth:0,fillColor:"white",fillOpacity:0}),select:new OpenLayers.Style({fillColor:"yellow",strokeColor:"orange",strokeWidth:2,fillOpacity:.2})})}),this.regionLayer.addFeatures(r),this.mapView.map.addLayer(this.regionLayer),this.regionHighlightControl=new OpenLayers.Control.SelectFeature(this.regionLayer,{autoActivate:!0,hover:!0}),this.mapView.map.addControl(this.regionHighlightControl),this.regionHighlightControl.handlers.feature.stopDown=!1,this.regionClickControl=new OpenLayers.Control.SelectFeature(this.regionLayer,{autoActivate:!0,clickFeature:function(t){var n;n=t.attributes.letter,Backbone.history.navigate("#/"+e.currYear+"/wms/region/"+n,{trigger:!0})}}),this.mapView.map.addControl(this.regionClickControl),this.regionClickControl.handlers.feature.stopDown=!1},n}(n)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/BaseStrategyView",["namespace"],function(e){var t,n;return t=function(t){function r(){return n=r.__super__.constructor.apply(this,arguments),n}return __extends(r,t),r.prototype.tagName="tr",r.prototype.initialize=function(e){if(this.template==null&&e.template==null)throw"Must specify template";return e.template!=null&&(this.template=e.template),r.__super__.initialize.call(this,e),_.bindAll(this,"render","unrender"),this.template=_.template(this.template),null},r.prototype.render=function(){return this.$el.html(this.template({m:this.model.toJSON(),currYear:e.currYear})),this.$el.attr("data-entity-id",this.model.get("recipientEntityId")),this},r.prototype.unrender=function(){return this.$el.remove(),null},r}(Backbone.View)}),define("scripts/text!templates/countyNetSupplyRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/county/{{m.countyId}}" title="Click for Strategies in {{m.countyName}} County">\r\n        {{m.countyName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m.netMunicipal) }}</td>\r\n<td>{{ $.number(m.netIrrigation) }}</td>\r\n<td>{{ $.number(m.netManufacturing) }}</td>\r\n<td>{{ $.number(m.netLivestock) }}</td>\r\n<td>{{ $.number(m.netSteamElectric) }}</td>\r\n<td>{{ $.number(m.netMining) }}</td>\r\n<td><strong>{{ $.number(m.netSupplyTotal) }}</strong></td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyView",["namespace","views/BaseStrategyView","scripts/text!templates/countyNetSupplyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("collections/CountyNetSupplyCollection",[],function(){var e,t;return e=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments),t}return __extends(n,e),n.prototype.url=""+BASE_PATH+"api/supply/county-net",n}(Backbone.Collection)}),define("scripts/text!templates/countyNetSupplyTable.html",[],function(){return'\r\n<p>Map shows Regional Water Planning Areas that may be selected using cursor.</p>\r\n\r\n<p>Table lists net water supplies to water user groups, by county and use type, from all recommended water management strategies in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                County\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Municipal supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Municipal\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Irrigation supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Irrigation\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Manufacturing supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Manufacturing\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Livestock supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Livestock\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Steam-Electric Power supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Steam-Electric Power\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total Mining supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    Mining\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Total supply (in acre-feet/year) provided by all Water Management Strategies) in each county">\r\n                    TOTAL\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyNetSupplyCollectionView",["namespace","views/BaseSelectableRegionStrategyView","views/CountyNetSupplyView","collections/CountyNetSupplyCollection","scripts/text!templates/countyNetSupplyTable.html"],function(e,t,n,r,i){var s,o;return s=function(t){function s(){return o=s.__super__.constructor.apply(this,arguments),o}return __extends(s,t),s.prototype.initialize=function(t){s.__super__.initialize.call(this,n,r,i,e.mapView)},s}(t)}),define("scripts/text!templates/regionStrategyRow.html",[],function(){return'<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{ \'$\' + $.number(m.capitalCost) }}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/RegionStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/regionStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/regionStrategyTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map shows Regional Water Planning Area boundaries.</p>\r\n\r\n<p>\r\n    Table lists recommended water management strategies in <strong><span data-bind="text: viewName"></span></strong> - <span data-bind="text: currYear"></span> based on Appendix A.2 of the 2012 State Water Plan.\r\n</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/RegionStrategyCollectionView",["namespace","views/BaseSelectableRegionStrategyView","views/RegionStrategyView","scripts/text!templates/regionStrategyTable.html"],function(e,t,n,r){var i,s;return i=function(t){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return __extends(i,t),i.prototype.initialize=function(t){var s,o;return this.regionLetter=t.id,this.viewName=ko.observable("Region "+this.regionLetter),o={regionLetter:this.regionLetter},s=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/region"}),i.__super__.initialize.call(this,n,s,r,e.mapView,{fetchParams:o}),null},i.prototype.showRegionFeatures=function(){var e,t,n=this;i.__super__.showRegionFeatures.apply(this,arguments),t=_.find(this.regionLayer.features,function(e){return e.attributes.letter===n.regionLetter}),this.regionHighlightControl.select(t),e=t.geometry.getBounds(),this.mapView.zoomToExtent(e)},i}(t)}),define("scripts/text!templates/countyStrategyRow.html",[],function(){return'\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/countyStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/countyStrategyTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map shows geographic center of entities using recommended water management strategies within <strong><span data-bind="text: viewName"></span></strong> (water system service area boundaries may extend outside of county).</p>\r\n\r\n<p>Table lists recommended water management strategies and the entities that would use them in <span data-bind="text: viewName"></span> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/CountyStrategyCollectionView",["namespace","views/BaseStrategyCollectionView","views/CountyStrategyView","scripts/text!templates/countyStrategyTable.html"],function(e,t,n,r){var i,s;return i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.countyId=e.id,this.countyName=e.name,this.viewName=ko.observable(""+this.countyName+" County"),s={countyId:this.countyId},i=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/county"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/districtStrategyRow.html",[],function(){return'<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/DistrictStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/districtStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/districtStrategyTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map shows geographic center of all entities using recommended water management strategies within <strong><span data-bind="text: viewName"></span></strong> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists all recommended water management strategies that serve an entity within <strong><span data-bind="text: viewName"></span></strong> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/LegeDistrictCollectionView",["namespace","views/BaseStrategyCollectionView","views/DistrictStrategyView","scripts/text!templates/districtStrategyTable.html"],function(e,t,n,r){var i,s;return i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return __extends(t,e),t.prototype.initialize=function(e){var i,s;if(e.type==null||!e.type==="house"||!e.type==="senate")throw"Options.type myst be 'house' or 'senate'.";return this.districtType=e.type,this.districtId=e.id,this.districtName=e.name,this.viewName=ko.observable(""+this.districtName),s={districtId:this.districtId},i=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/district/"+this.districtType}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/strategyTypeRow.html",[],function(){return'\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeView",["namespace","views/BaseStrategyView","scripts/text!templates/strategyTypeRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/strategyTypeTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map shows geographic center of entities <i class="wugIcon icon-circle"></i> using recommended <strong><span data-bind="text: viewName"></span></strong> strategies in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists recommended <span data-bind="text: viewName"></span> strategies and entities that would use them in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/StrategyTypeCollectionView",["namespace","views/BaseStrategyCollectionView","views/StrategyTypeView","scripts/text!templates/strategyTypeTable.html"],function(e,t,n,r){var i,s;return i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return this.typeId=e.id,this.typeName=e.name,this.viewName=ko.observable(""+this.typeName),s={typeId:this.typeId},i=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/type"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t}(t)}),define("scripts/text!templates/entityStrategyRow.html",[],function(){return'<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>${{$.number(m.capitalCost)}}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/entityStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/entityStrategyTable.html",[],function(){return'\r\n<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map includes a schematic representation of water sources for water management strategies supplying <strong><span data-bind="text: viewName"></span></strong> <i class="wugIcon icon-circle"></i> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Conservation and other local strategy water sources are not mapped.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th data-sort="currency">\r\n                <span class="has-popover" data-content="Estimated capital cost of the Water Management Strategy">\r\n                    Capital Cost\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/EntityStrategyCollectionView",["namespace","config/WmsThemeConfig","views/BaseStrategyCollectionView","views/EntityStrategyView","scripts/text!templates/entityStrategyTable.html"],function(e,t,n,r,i){var s,o;return s=function(n){function s(){return o=s.__super__.constructor.apply(this,arguments),o}return __extends(s,n),s.prototype.initialize=function(t){var n,o,u;return _.bindAll(this,"fetchCallback","onFetchBothCollectionSuccess","showSourceFeatures","_registerHighlightEvents"),this.entityId=t.id,this.viewName=ko.observable(),this.mapView=e.mapView,u={entityId:this.entityId},o=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/entity"}),n=Backbone.Collection.extend({url:""+BASE_PATH+"api/entity/"+this.entityId+"/sources"}),this.sourceCollection=new n,s.__super__.initialize.call(this,r,o,i,{fetchParams:u}),null},s.prototype.fetchData=function(){var t,n=this;this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),$.when(this.strategyCollection.fetch({data:t}),this.sourceCollection.fetch({data:{year:e.currYear}})).then(this.onFetchBothCollectionSuccess).fail(function(){n.trigger("table:fetcherror")})},s.prototype.unrender=function(){s.__super__.unrender.apply(this,arguments),this.sourceLayer!=null&&this.sourceLayer.destroy()},s.prototype.onFetchBothCollectionSuccess=function(){if(this.onFetchDataSuccess(this.strategyCollection)===!1)return;this.showSourceFeatures(),this.trigger("table:endload")},s.prototype.fetchCallback=function(e){this.viewName(e[0].get("recipientEntityName")),s.__super__.fetchCallback.call(this,e)},s.prototype.showSourceFeatures=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;u=new OpenLayers.Format.WKT,e=null,s=[],n=[],f=this.wugLayer.features[0],h=this.sourceCollection.models;for(l=0,c=h.length;l<c;l++){i=h[l];if(i.get("wktGeog")==null)continue;r=u.read(i.get("wktGeog"));if(r==null)continue;r.attributes=_.clone(i.attributes),i.attributes.wktMappingPoint!=null&&(o=u.read(i.attributes.wktMappingPoint),this.mapView.transformToWebMerc(o.geometry),t=this._createBezierConnector(f.geometry,o.geometry),n.push(t)),delete r.attributes.wktGeog,delete r.attributes.wktMappingPoint,this.mapView.transformToWebMerc(r.geometry),e==null?e=r.geometry.getBounds().clone():e.extend(r.geometry.getBounds()),s.push(r)}s.sort(function(e,t){return e.attributes.sourceType==="SURFACE WATER"?1:t.attributes.sourceType==="SURFACE WATER"?-1:e.attributes.sourceTypeId-t.attributes.sourceTypeId}),this.sourceLayer=new OpenLayers.Layer.Vector("Source Feature Layer",{displayInLayerSwitcher:!1,styleMap:this._sourceStyleMap}),this.sourceLayer.addFeatures(s),this.sourceLayer.addFeatures(n),this.mapView.map.addLayer(this.sourceLayer),this.mapView.map.setLayerIndex(this.wugLayer,+this.mapView.map.getLayerIndex(this.sourceLayer)+1),this._registerHighlightEvents(),this._addLayerToControl(this.clickFeatureControl,this.sourceLayer),e!=null&&(a=this.wugLayer.features[0],e.extend(a.geometry.getBounds()),this.mapView.zoomToExtent(e))},s.prototype._clickFeature=function(t){var n;s.__super__._clickFeature.call(this,t);if(t.layer==null||t.layer.id!==this.sourceLayer.id)return;if(t.attributes.featureType!=null&&t.attributes.featureType==="connector")return;n=t.attributes.sourceId,Backbone.history.navigate("#/"+e.currYear+"/wms/source/"+n,{trigger:!0})},s.prototype._registerHighlightEvents=function(){var e=this;this._addLayerToControl(this.highlightFeatureControl,this.sourceLayer),this.highlightFeatureControl.events.register("beforefeaturehighlighted",null,function(t){var n;return t.feature.layer==null||t.feature.layer.id!==e.sourceLayer.id?!0:(n=t.feature,n.attributes.featureType!=null&&n.attributes.featureType==="connector"?!1:!0)}),this.highlightFeatureControl.events.register("featurehighlighted",null,function(t){var n,r;if(t.feature.layer==null||t.feature.layer.id!==e.sourceLayer.id)return;r=t.feature,n=new OpenLayers.Popup.FramedCloud("sourcepopup",e.mapView.getMouseLonLat(),null,"<strong>"+r.attributes.name+"</strong>",null,!0),n.autoSize=!0,r.popup=n,e.mapView.map.addPopup(n)}),this.highlightFeatureControl.events.register("featureunhighlighted",null,function(t){var n;if(t.feature.layer==null||t.feature.layer.id!==e.sourceLayer.id)return;n=t.feature,n.popup!=null&&(e.mapView.map.removePopup(n.popup),n.popup.destroy(),n.popup=null)})},s.prototype._sourceStyleMap=new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"${getStrokeColor}",strokeWidth:"${getStrokeWidth}",fillColor:"${getFillColor}",pointRadius:6,fillOpacity:.8},{context:{getStrokeColor:function(e){var n;return e.attributes.featureType!=null&&e.attributes.featureType==="connector"?"#ee9900":(n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.strokeColor:t.SourceStyles[0].strokeColor)},getStrokeWidth:function(e){var n;return n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.strokeWidth:t.SourceStyles[0].strokeWidth},getFillColor:function(e){var n;return n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.fillColor:t.SourceStyles[0].fillColor}}}),select:new OpenLayers.Style({fillColor:"cyan",strokeColor:"blue"})}),s}(n)}),define("scripts/text!templates/projectStrategyRow.html",[],function(){return'<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/source/{{m.sourceId}}" title="Click for Strategies related to {{m.sourceName}}">\r\n        {{m.sourceName}}\r\n    </a>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">    \r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n<td>{{m.sponsorName}}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/ProjectStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/projectStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/projectStrategyTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map shows geographic center of entities <i class="wugIcon icon-circle"></i> directly associated with the <strong><span data-bind="text: viewName"></span></strong> strategy in <span data-bind="text: currYear"></span>.<sup>&dagger;</sup>\r\n\r\n<p>County-based water use categories (e.g., manufacturing) are shown in the center of counties.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Source supply of water for the Water Management Strategy">\r\n                    Source\r\n                </span>\r\n            </th>\r\n             <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Sponsor of the Water Management Strategy">\r\n                    Sponsor Entity\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n\r\n\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p>\r\n    <sup>&dagger;</sup>\r\n    <small>\r\n        This strategy may rely on or provide water for a separate water management strategy.\r\n    </small>\r\n</p>\r\n\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/ProjectStrategyCollectionView",["namespace","views/BaseStrategyCollectionView","views/ProjectStrategyView","scripts/text!templates/projectStrategyTable.html"],function(e,t,n,r){var i,s;return i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return __extends(t,e),t.prototype.initialize=function(e){var i,s;return _.bindAll(this,"fetchCallback"),this.projectId=e.id,this.viewName=ko.observable(),s={projectId:this.projectId},i=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/project"}),t.__super__.initialize.call(this,n,i,r,{fetchParams:s}),null},t.prototype.fetchCallback=function(e){e.length<!0&&(alert("Invalid projectId specified."),Backbone.history.navigate("",{trigger:!0})),this.viewName(e[0].get("description")),t.__super__.fetchCallback.call(this,e)},t}(t)}),define("scripts/text!templates/sourceStrategyRow.html",[],function(){return'\r\n<td>{{m.sourceBasin}}</td>\r\n<td>\r\n    <a href="#/{{currYear}}/wms/region/{{m.regionLetter}}" title="Click for Strategies in Region {{m.regionLetter}}">\r\n        {{m.regionLetter}}\r\n    </a>\r\n</td>\r\n<td class="aligned-left">\r\n    <a href="#/{{currYear}}/wms/project/{{m.projectId}}" title="Click for Strategy details">\r\n        {{m.description}}\r\n    </a>\r\n    <% if (m.isRedundantSupply === \'Y\') { \r\n        print("<span class=\'note-marker\'>*</span>"); \r\n    } %>\r\n</td>\r\n<td>\r\n    <% if (m.recipientEntityType != "WWP") { %>\r\n        <a href="#/{{currYear}}/wms/entity/{{m.recipientEntityId}}" title="Click for Strategies of {{m.recipientEntityName}}">\r\n            {{m.recipientEntityName}}\r\n        </a>\r\n    <% } else { %>\r\n        {{m.recipientEntityName}}\r\n    <% } %>\r\n</td>\r\n<td>{{ $.number(m["supply"+currYear]) }}</td>\r\n'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/SourceStrategyView",["namespace","views/BaseStrategyView","scripts/text!templates/sourceStrategyRow.html"],function(e,t,n){var r,i;return r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return __extends(t,e),t.prototype.template=n,t}(t)}),define("scripts/text!templates/sourceStrategyTable.html",[],function(){return'<h2><span data-bind="text: viewName"></span> <span data-bind="text: qualifier"></span> - <span data-bind="text: currYear"></span></h2>\r\n\r\n<p>Map includes a schematic representation of all entities <i class="wugIcon icon-circle"></i> with recommended water management strategies that rely on <strong><span data-bind="text: viewName"></span></strong> <span data-bind="text: qualifier"></span> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<p>Table lists water management strategies along with entities using water from <span data-bind="text: viewName"></span> in <span data-bind="text: currYear"></span>.</p>\r\n\r\n<table class="table-hover table-striped table-bordered table-condensed modelTable">\r\n    <thead>\r\n        <tr>\r\n            <th>\r\n                <span class="has-popover" data-content="River basin of the selected source.  Only for Surface Water sources.">\r\n                    River Basin\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="State Water Plan Planning Region">\r\n                    Region\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Description of the recommended Water Management Strategy. Click to view project details.">\r\n                    Description\r\n                </span>\r\n            </th>\r\n            <th>\r\n                <span class="has-popover" data-content="Water User Group (WUG) supplied by the Water Management Strategy. In the map, the circles for WUGs are sized based on their relative supply volume.">\r\n                    Entity <i class="wugIcon icon-circle"></i>\r\n                </span>\r\n            </th>\r\n            <th data-sort="formatted-int">\r\n                <span class="has-popover" data-content="Volume of water (in acre-feet/year) supplied by the Water Management Strategy">\r\n                    Supply Volume <span data-bind="text: currYear"></span>\r\n                </span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n\r\n    </tbody>\r\n</table>\r\n<% //<a href="#" class="tableDownloadLink"><i class="icon icon-save"> </i>Download Strategy Results</a> %>\r\n\r\n<p class="note-marker-container">\r\n    <small>\r\n        <span class="note-marker">*</span>\r\n        Denotes a strategy with supply volume included in other strategies.\r\n    </small>\r\n</p>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/SourceStrategyCollectionView",["namespace","config/WmsThemeConfig","views/BaseStrategyCollectionView","views/SourceStrategyView","scripts/text!templates/sourceStrategyTable.html"],function(e,t,n,r,i){var s,o;return s=function(n){function s(){return o=s.__super__.constructor.apply(this,arguments),o}return __extends(s,n),s.prototype.initialize=function(t){var n,o,u;_.bindAll(this,"onFetchBothCollectionSuccess","showSourceFeature","_registerHighlightEvents"),this.sourceId=t.id,this.viewName=ko.observable(),this.qualifier=ko.observable(),this.mapView=e.mapView,u={sourceId:this.sourceId},o=Backbone.Collection.extend({url:""+BASE_PATH+"api/strategies/source"}),n=Backbone.Model.extend({url:""+BASE_PATH+"api/source/feature/"+this.sourceId}),this.sourceModel=new n,s.__super__.initialize.call(this,r,o,i,{fetchParams:u})},s.prototype.fetchData=function(){var t,n=this;this.$("tbody").empty(),t=_.extend({year:e.currYear},this.fetchParams),this.trigger("table:startload"),$.when(this.strategyCollection.fetch({data:t}),this.sourceModel.fetch()).then(this.onFetchBothCollectionSuccess).fail(function(){n.trigger("table:fetcherror")})},s.prototype.unrender=function(){s.__super__.unrender.apply(this,arguments),this.sourceLayer!=null&&this.sourceLayer.destroy()},s.prototype.onFetchBothCollectionSuccess=function(){if(this.onFetchDataSuccess(this.strategyCollection)===!1)return;this.viewName(this.sourceModel.attributes.name),this.sourceModel.attributes.sourceType==="GROUNDWATER"&&this.qualifier("in county shown"),this.showSourceFeature(),this.trigger("table:endload")},s.prototype.showSourceFeature=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;u=new OpenLayers.Format.WKT,e=null,n=[],l=this.wugLayer.features;if(this.sourceModel.get("wktGeog")==null)return;r=u.read(this.sourceModel.get("wktGeog"));if(r==null)return;r.attributes=_.clone(this.sourceModel.attributes),delete r.attributes.wktGeog,delete r.attributes.wktMappingPoint,this.mapView.transformToWebMerc(r.geometry),e=r.geometry.getBounds().clone(),g=this.wugLayer.features;for(p=0,v=g.length;p<v;p++)f=g[p],e.extend(f.geometry.getBounds());y=this.strategyCollection.models;for(d=0,m=y.length;d<m;d++){o=y[d];if(o.get("recipientEntityType")==="WWP")continue;s=o.get("sourceMappingPoint"),h=o.get("recipientEntityWktGeog"),s!=null&&h!=null&&(i=u.read(s),c=u.read(h),this.mapView.transformToWebMerc(i.geometry),this.mapView.transformToWebMerc(c.geometry),t=this._createBezierConnector(i.geometry,c.geometry),n.push(t))}this.sourceLayer=new OpenLayers.Layer.Vector("Source Feature Layer",{displayInLayerSwitcher:!1,styleMap:this._sourceStyleMap}),this.sourceLayer.addFeatures(r),this.sourceLayer.addFeatures(n),this.mapView.map.addLayer(this.sourceLayer),this.mapView.map.setLayerIndex(this.wugLayer,+this.mapView.map.getLayerIndex(this.sourceLayer)+1),this._registerHighlightEvents(),this._addLayerToControl(this.clickFeatureControl,this.sourceLayer),e!=null&&(a=this.wugLayer.features[0],e.extend(a.geometry.getBounds()),this.mapView.zoomToExtent(e))},s.prototype._registerHighlightEvents=function(){var e=this;this._addLayerToControl(this.highlightFeatureControl,this.sourceLayer),this.highlightFeatureControl.events.register("beforefeaturehighlighted",null,function(e){var t;return t=e.feature,t.attributes.featureType!=null&&t.attributes.featureType==="connector"?!1:!0}),this.highlightFeatureControl.events.register("featurehighlighted",null,function(t){var n,r;if(t.feature.layer==null||t.feature.layer.id!==e.sourceLayer.id)return!1;r=t.feature,n=new OpenLayers.Popup.FramedCloud("sourcepopup",e.mapView.getMouseLonLat(),null,"<strong>"+r.attributes.name+"</strong>",null,!0),n.autoSize=!0,r.popup=n,e.mapView.map.addPopup(n)}),this.highlightFeatureControl.events.register("featureunhighlighted",null,function(t){var n;if(t.feature.layer==null||t.feature.layer.id!==e.sourceLayer.id)return!1;n=t.feature,n.popup!=null&&(e.mapView.map.removePopup(n.popup),n.popup.destroy(),n.popup=null)})},s.prototype._sourceStyleMap=new OpenLayers.StyleMap({"default":new OpenLayers.Style({strokeColor:"${getStrokeColor}",strokeWidth:"${getStrokeWidth}",fillColor:"${getFillColor}",pointRadius:6,fillOpacity:.8},{context:{getStrokeColor:function(e){var n;return e.attributes.featureType!=null&&e.attributes.featureType==="connector"?"#ee9900":(n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.strokeColor:t.SourceStyles[0].strokeColor)},getStrokeWidth:function(e){var n;return n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.strokeWidth:t.SourceStyles[0].strokeWidth},getFillColor:function(e){var n;return n=_.find(t.SourceStyles,function(t){return t.id===e.attributes.sourceTypeId}),n!=null?n.fillColor:t.SourceStyles[0].fillColor}}}),select:new OpenLayers.Style({fillColor:"cyan",strokeColor:"blue"})}),s}(n)}),define("scripts/text!templates/wmsAreaSelect.html",[],function(){return'<div class="span12">\r\n    <div class="row">\r\n        <div class="span12">\r\n            <p>Select an area or water user group from the following dropdowns to view all recommended strategies associated with that selection.</p>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="span3" id="regionSelectContainer"></div>\r\n        <div class="span3" id="countySelectContainer"></div>\r\n        <div class="span3" id="wugSelectContainer"></div>\r\n    </div>\r\n    <hr class="space"/>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/WmsAreaSelectView",["namespace","scripts/text!templates/wmsAreaSelect.html"],function(e,t){var n,r;return n=function(n){function i(){return r=i.__super__.constructor.apply(this,arguments),r}return __extends(i,n),i.prototype.template=_.template(t),i.prototype.initialize=function(t){_.bindAll(this,"render","unrender","_createRegionSelect","_createCountySelect","_createHouseSenateSelect","_createWugSelect","enableSelects","disableSelects","resetSelects");if(e.countyNames==null||e.regionNames==null||e.houseNames==null||e.senateNames==null)throw"Must specify namespace.counties, namespace.regions, namespace.house,and namespace.senate"},i.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template()),this.selects={},this.selects.region=this._createRegionSelect().chosen(),this.selects.county=this._createCountySelect().chosen(),this.selects.wug=this._createWugSelect().ajaxChosen({type:"GET",url:""+BASE_PATH+"api/entities/auto",jsonTermKey:"namePart"},function(e){var t,n,r,i;n=[];for(r=0,i=e.length;r<i;r++)t=e[r],n.push({value:t.id,text:t.name});return n}),this},i.prototype.resetSelects=function(e){var t;for(t in this.selects)t!==e&&this.selects[t].val("-1").trigger("liszt:updated")},i.prototype.disableSelects=function(){var e;for(e in this.selects)this.selects[e].attr("disabled",!0).trigger("liszt:updated")},i.prototype.enableSelects=function(){var e;for(e in this.selects)this.selects[e].attr("disabled",null).trigger("liszt:updated")},i.prototype._createRegionSelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a Region</option>")),u=e.regionNames.models;for(s=0,o=u.length;s<o;s++)i=u[s],r=$("<option value='"+i.get("letter")+"'>Region "+i.get("letter")+"</option>"),t.append(r);return this.$("#regionSelectContainer").append(t),n=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/region/"+t.val(),{trigger:!0}),n.resetSelects("region")}),t},i.prototype._createCountySelect=function(){var t,n,r,i,s,o,u;t=$("<select></select>"),t.append($("<option value='-1'>Select a County</option>")),u=e.countyNames.models;for(s=0,o=u.length;s<o;s++)n=u[s],i=$("<option value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);return this.$("#countySelectContainer").append(t),r=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/county/"+t.val(),{trigger:!0}),r.resetSelects("county")}),t},i.prototype._createHouseSenateSelect=function(){var t,n,r,i,s,o,u,a,f,l;t=$("<select></select>"),t.append($("<option value='-1'>Select a Legislative District</option>")),f=e.senateNames.models;for(s=0,u=f.length;s<u;s++)n=f[s],i=$("<option data-type='senate' value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);l=e.houseNames.models;for(o=0,a=l.length;o<a;o++)n=l[o],i=$("<option data-type='house' value='"+n.get("id")+"'>"+n.get("name")+"</option>"),t.append(i);return this.$("#districtSelectContainer").append(t),r=this,t.on("change",function(){var t,n,i;n=$(this);if(n.val()==="-1")return;t=n.find(":selected"),i=t.attr("data-type"),i==="senate"?Backbone.history.navigate("#/"+e.currYear+"/wms/senate/"+n.val(),{trigger:!0}):Backbone.history.navigate("#/"+e.currYear+"/wms/house/"+n.val(),{trigger:!0}),r.resetSelects("district")}),t},i.prototype._createWugSelect=function(){var t,n;return t=$("<select></select>"),t.append($("<option value='-1'>Search for a Water User Group</option>")),this.$("#wugSelectContainer").append(t),n=this,t.on("change",function(){var t;t=$(this);if(t.val()==="-1")return;Backbone.history.navigate("#/"+e.currYear+"/wms/entity/"+t.val(),{trigger:!0}),n.resetSelects("wug")}),t},i.prototype.unrender=function(){return this.$el.remove(),null},i}(Backbone.View)}),define("scripts/text!templates/mapTopButtons.html",[],function(){return'<div class="pull-right">\r\n    <a class="btn map-stuff" data-bind="click: toggleMapViewLock" data-toggle="button" data-other-icon-class="icon-lock">\r\n        <i class="icon-unlock"> </i>Lock Map View\r\n    </a>\r\n    \r\n    <a class="btn map-stuff" data-bind="click: zoomToTexas">\r\n        Zoom to Texas\r\n    </a>\r\n    \r\n    <a class="btn" id="toggleMapBtn" data-bind="click: toggleMap">\r\n        Hide Map\r\n    </a>\r\n</div>'});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("views/MapTopButtonsView",["namespace","scripts/text!templates/mapTopButtons.html"],function(e,t){var n,r;return n=function(n){function i(){return r=i.__super__.constructor.apply(this,arguments),r}return __extends(i,n),i.prototype.template=_.template(t),i.prototype.initialize=function(t){_.bindAll(this,"render","unrender","toggleMapViewLock","zoomToTexas","toggleMap");if(e.mapView==null)throw"namespace.mapView not defined";return this.mapView=e.mapView,null},i.prototype.render=function(){return this.$el.empty(),this.$el.html(this.template()),ko.applyBindings(this,this.el),this},i.prototype.unrender=function(){return this.$el.remove(),null},i.prototype.toggleMapViewLock=function(e,t){var n,r,i;r=$(t.delegateTarget),n=$("i",r),i=n.attr("class"),n.attr("class",r.attr("data-other-icon-class")),r.attr("data-other-icon-class",i),r.hasClass("locked")?(r.removeClass("locked"),this.mapView.isMapLocked=!1):(r.addClass("locked"),this.mapView.isMapLocked=!0)},i.prototype.zoomToTexas=function(){this.mapView.resetExtent()},i.prototype.toggleMap=function(e,t){var n;n=$(t.delegateTarget),n.hasClass("off")?(n.html("Hide Map"),$("#mapContainer").slideDown(),$(".map-stuff").show(),n.removeClass("off")):(n.addClass("off"),$("#mapContainer").slideUp(),$(".map-stuff").hide(),n.html("Show Map"))},i}(Backbone.View)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("WMSRouter",["namespace","views/MapView","views/ThemeNavToolbarView","views/YearNavView","views/MapBottomToolbarView","views/CountyNetSupplyCollectionView","views/RegionStrategyCollectionView","views/CountyStrategyCollectionView","views/LegeDistrictCollectionView","views/StrategyTypeCollectionView","views/EntityStrategyCollectionView","views/ProjectStrategyCollectionView","views/SourceStrategyCollectionView","views/WmsAreaSelectView","views/MapTopButtonsView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v,m;return v=function(i){function v(){return m=v.__super__.constructor.apply(this,arguments),m}return __extends(v,i),v.prototype.initialize=function(i){_.bindAll(this,"updateViewsToNewYear","updateSelectedWug","onTableStartLoad","onTableEndLoad","onTableNothingFound","onTableFetchError","highlightWugsByStrategyType"),this.currStrategyView=null,this.tableContainer=$("#tableContainer")[0],this.mapView=new t({mapContainerId:"mapContainer",bingApiKey:BING_MAPS_KEY}),e.mapView=this.mapView,this.mapView.render(),this.themeNavToolbarView=new n({el:$("#themeNavContainer")[0]}),this.mapTopButtonsView=new d({el:$("#mapTopButtonsContainer")[0]}),this.mapTopButtonsView.render(),this.yearNavView=new r({el:$("#yearNavContainer")[0]}),this.yearNavView.on("changeyear",this.updateViewsToNewYear),this.areaSelectView=new p({el:$("#areaSelectContainer")[0]}),this.areaSelectView.render()},v.prototype.routes={"":"default",":year/wms":"wmsNetCountySupplies",":year/wms/region/:regionLetter":"wmsRegion",":year/wms/county/:countyId":"wmsCounty",":year/wms/house/:districtId":"wmsHouseDistrict",":year/wms/senate/:districtId":"wmsSenateDistrict",":year/wms/type/:typeId":"wmsType",":year/wms/entity/:entityId":"wmsEntity",":year/wms/project/:projectId":"wmsProjectDetail",":year/wms/source/:sourceId":"wmsSource"},v.prototype.onTableStartLoad=function(){this.areaSelectView.disableSelects(),this.yearNavView.disableYearButtons(),this.themeNavToolbarView.disableStrategyTypeList(),this.mapView.showMapLoading(),this.currStrategyView.showLoading()},v.prototype.onTableEndLoad=function(){this.areaSelectView.enableSelects(),this.yearNavView.enableYearButtons(),this.themeNavToolbarView.enableStrategyTypeList(),this.mapView.hideMapLoading(),this.currStrategyView.hideLoading()},v.prototype.onTableFetchError=function(){$("#errorMessage").show()},v.prototype.onTableNothingFound=function(){this.onTableEndLoad(),this.currStrategyView.showNothingFound()},v.prototype.updateSelectedWug=function(e){e==null?this.currStrategyView.unselectWugFeatures():this.currStrategyView.selectWugFeature(e)},v.prototype.highlightWugsByStrategyType=function(e){e==null?this.currStrategyView.unhighlightStratTypeWugs():this.currStrategyView.highlightStratTypeWugs(e)},v.prototype.updateViewsToNewYear=function(t){var n,r,i,s,o,u,a;n=Backbone.history.fragment,i="",a=e.VALID_YEARS;for(o=0,u=a.length;o<u;o++){s=a[o];if(n.indexOf(s+"/")!==-1){i=s;break}}i===""&&Backbone.history.navigate(""),r=n.replace(i,t),Backbone.history.navigate("#/"+r,{trigger:!0})},v.prototype.before={"":function(){$("#errorMessage").hide()},"^[0-9]{4}/wms":function(t){this.currStrategyView!=null&&(this.currStrategyView=this.currStrategyView.unrender());if(t!=null){if(!_.contains(e.VALID_YEARS,t))return alert("Invalid decade specified."),Backbone.history.navigate("",{trigger:!0}),!1;e.currYear=t}}},v.prototype.after={"^[0-9]{4}/wms":function(e){e!=null&&this.currStrategyView!=null&&(this.themeNavToolbarView.render(),this.yearNavView.render(),this.currStrategyView.off(),this.currStrategyView.on("table:startload",this.onTableStartLoad),this.currStrategyView.on("table:endload",this.onTableEndLoad),this.currStrategyView.on("table:nothingfound",this.onTableNothingFound),this.currStrategyView.on("table:fetcherror",this.onTableFetchError),this.currStrategyView.on("table:hoverwug",this.updateSelectedWug),this.currStrategyView.on("table:hovertype",this.highlightWugsByStrategyType),this.currStrategyView.render())}},v.prototype["default"]=function(){Backbone.history.navigate("#/"+e.currYear+"/wms",{trigger:!0})},v.prototype.wmsNetCountySupplies=function(e){this.currStrategyView!=null&&(this.currStrategyView=this.currStrategyView.unrender()),this.currStrategyView=new s({el:this.tableContainer}),this.mapView.resetExtent(),this.mapView.showWmsOverlayByViewType("Regions"),this.areaSelectView.resetSelects()},v.prototype.wmsRegion=function(t,n){var r;r=e.regionNames.get(n);if(r==null){alert("Invalid region specified."),Backbone.history.navigate("",{trigger:!0});return}this.currStrategyView=new o({el:this.tableContainer,id:n}),this.mapView.showWmsOverlayByViewType("Regions")},v.prototype.wmsCounty=function(t,n){var r,i;r=e.countyNames.get(n);if(r==null){alert("Invalid countyId specified."),Backbone.history.navigate("",{trigger:!0});return}i=r.get("name"),this.currStrategyView=new u({el:this.tableContainer,id:n,name:i}),this.mapView.showWmsOverlayByViewType("Counties")},v.prototype.wmsHouseDistrict=function(t,n){var r;r=e.houseNames.get(n);if(r==null){alert("Invalid districtId specified."),Backbone.history.navigate("",{trigger:!0});return}this.currStrategyView=new a({el:this.tableContainer,id:n,type:"house",name:r.get("name")}),this.mapView.showWmsOverlayByViewType("HouseDistricts")},v.prototype.wmsSenateDistrict=function(t,n){var r;r=e.senateNames.get(n);if(r==null){alert("Invalid districtId specified."),Backbone.history.navigate("",{trigger:!0});return}this.currStrategyView=new a({el:this.tableContainer,id:n,type:"senate",name:r.get("name")}),this.mapView.showWmsOverlayByViewType("SenateDistricts")},v.prototype.wmsType=function(t,n){var r,i;i=e.strategyTypes.get(n);if(i==null){alert("Invalid typeId specified."),Backbone.history.navigate("",{trigger:!0});return}r=i.get("name"),this.currStrategyView=new f({el:this.tableContainer,id:n,name:r}),this.areaSelectView.resetSelects()},v.prototype.wmsEntity=function(e,t){this.currStrategyView=new l({el:this.tableContainer,id:t}),this.areaSelectView.resetSelects(),this.mapView.showWmsOverlayByViewType("CountyNames")},v.prototype.wmsProjectDetail=function(e,t){this.currStrategyView=new c({el:this.tableContainer,id:t}),this.areaSelectView.resetSelects()},v.prototype.wmsSource=function(e,t){this.currStrategyView=new h({el:this.tableContainer,id:t}),this.areaSelectView.resetSelects(),this.mapView.showWmsOverlayByViewType("CountyNames")},v}(Backbone.Router)});var BASE_CONTENT_PATH,BASE_PATH,BING_MAPS_KEY,console;console=console||{},console.log=console.log||function(){return null},_.extend(_.templateSettings,{interpolate:/\{\{(.+?)\}\}/g}),BASE_PATH=base_path||"/",BASE_CONTENT_PATH=base_content_path||"/",BING_MAPS_KEY=bing_maps_key||"",$(function(){var e=this;require.config({baseUrl:""+BASE_PATH+"Scripts/Compiled/backbone_app",paths:{scripts:"../..",templates:"../../templates"}}),require(["namespace","WMSRouter"],function(e,t){var n;n=Backbone.History.extend({loadUrl:function(){var e;return e=Backbone.History.prototype.loadUrl.apply(this,arguments),e||this.trigger("route-not-found"),e}}),Backbone.history=new n,Backbone.history.on("route-not-found",function(){Backbone.history.navigate("",{trigger:!0})}),$(".tableLoading").show(),e.bootstrapData().done(function(){var e;e=new t,Backbone.history.start()}).fail(function(){$("#errorMessage").show()}).always(function(){$(".tableLoading").hide()})})}),define("main.js",function(){});