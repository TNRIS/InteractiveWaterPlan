/*
  knockback-localization.js 0.16.7
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/knockback/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
*/(function(){return function(e){return typeof define=="function"&&define.amd?define("knockback-localization",["underscore","backbone","knockout","knockback"],e):e.call(this)}(function(){var e,t,n,r,i;return t=!this.kb&&typeof require!="undefined"?require("knockback"):this.kb,r=t._,e=t.Backbone,n=t.ko,this.Knockback=this.kb=t,typeof exports!="undefined"&&(module.exports=t),i=n.utils.unwrapObservable,t.locale_manager=void 0,t.LocalizedObservable=function(){function s(e,s,o){var u,a=this;return this.value=e,this.vm=o,s||(s={}),this.vm||(this.vm={}),this.read||_throwMissing(this,"read"),t.locale_manager||_throwMissing(this,"kb.locale_manager"),this.__kb||(this.__kb={}),this.__kb._onLocaleChange=r.bind(this._onLocaleChange,this),this.__kb._onChange=s.onChange,this.value&&(e=i(this.value)),this.vo=n.observable(e?this.read(e,null):null),u=t.utils.wrappedObservable(this,n.dependentObservable({read:function(){return a.value&&i(a.value),a.vo(),a.read(i(a.value))},write:function(e){a.write||_throwUnexpected(a,"writing to read-only"),a.write(e,i(a.value)),a.vo(e);if(a.__kb._onChange)return a.__kb._onChange(e)},owner:this.vm})),u.destroy=r.bind(this.destroy,this),u.observedValue=r.bind(this.observedValue,this),u.resetToCurrent=r.bind(this.resetToCurrent,this),t.locale_manager.bind("change",this.__kb._onLocaleChange),s.hasOwnProperty("default")&&(u=t.DefaultObservable&&n.defaultObservable(u,s["default"])),u}return s.extend=e.Model.extend,s.prototype.destroy=function(){return t.locale_manager.unbind("change",this.__kb._onLocaleChange),this.vm=null,t.utils.wrappedDestroy(this)},s.prototype.resetToCurrent=function(){var e,n;n=t.utils.wrappedObservable(this),e=this.value?this.read(i(this.value)):null;if(n()===e)return;return n(e)},s.prototype.observedValue=function(e){if(arguments.length===0)return this.value;this.value=e,this._onLocaleChange()},s.prototype._onLocaleChange=function(){var e;e=this.read(i(this.value)),this.vo(e);if(this.__kb._onChange)return this.__kb._onChange(e)},s}(),t.localizedObservable=function(e,n,r){return new t.LocalizedObservable(e,n,r)},t})}).call(this);