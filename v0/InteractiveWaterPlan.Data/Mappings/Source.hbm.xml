<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="InteractiveWaterPlan.Core" namespace="InteractiveWaterPlan.Core">
  
  <class name="Source" mutable="false">
    <id name="Id">
      <column name="SQL_ID"/>
    </id>

    <property column="DBSOID" name="SourceId" />
    <property column="SourceName" name="Name" />
    <property column="SQL_GEOG" name="WktGeog" />
    <property column="GEOG_Mapping_Pt_Txt" name="WktMappingPoint" />

    <property column="SSYear" name="SupplyInYear" />
    <property column="SoTypeId" name="SourceTypeId" />
    <property column="SourceTypeDescription" name="SourceType" />
  </class>

  <class name="SourceDetail" mutable="false">
    <id name="Id">
      <column name="DBsoId"/>
    </id>

    <property column="SourceName" name="Name" />
    <property column="SQL_GEOG" name="WktGeog" />

    <property column="SoTypeId" name="SourceTypeId" />
    <property column="SourceTypeDescription" name="SourceType" />
  </class>
  
  <!-- Queries -->
  
  <sql-query name="GetSourcesForEntity">
    <query-param name="entityId" type="int" />
    <query-param name="year" type="string" />
    <return class="Source"/>
    exec dbo.usp_Select_Sources_By_Entity_Year__tbl_DB12_Sources :entityId, :year
  </sql-query>

  <sql-query name="GetSourcesForProject">
    <query-param name="projectId" type="int" />
    <query-param name="year" type="string" />
    <return class="SourceDetail"/>
    exec dbo.usp_Select_Sources_By_ProjectID_Year__tbl_DB12_Sources :projectId, :year
  </sql-query>

  <sql-query name="GetSource">
    <query-param name="sourceId" type="int" />
    <return class="SourceDetail"/>
    exec dbo.usp_Select_Source_Details__tbl_DB12_Sources :sourceId
  </sql-query>


</hibernate-mapping>